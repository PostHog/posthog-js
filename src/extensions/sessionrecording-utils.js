export var replacementImageURI =
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAA8CAYAAACJvWQEAAAMa2lDQ1BJQ0MgUHJvZmlsZQAASImVVwdYU8kWnluSkJDQAhGQEnoTpFcpIbQAAlIFGyEJJJQYE4KKDcuigmsXEazoqoiiawFkURF7WRR7XyyoKOtiQVFU3oQEdN1Xvjffd + 7898yZ / 5Q7c + 8dADR7uRJJLqoFQJ44XxofHswcm5rGJHUAEtAFAOgAFy5PJmHFxUXDOzDY / 729vwEQRX / VUcH1z / H / 2nT4AhkPAGQ8xBl8GS8P4mYA8PU8iTQfAKJCbzE1X6LARRDrSmGAEK9W4Cwl3qnAGUrcNGCTGM + G + DIAalQuV5oFgMY9qGcW8LIgj8ZniJ3FfJEYAM0REAfwhFw + xIrYR + TlTVbgcohtob0EYhgP8M74jjPrb / wZQ / xcbtYQVuY10NRCRDJJLnf6 / 1ma / 93ycuWDPqyhUIXSiHhF / rCGt3ImRykwFeIucUZMrKLWEPeK + Mq6A4BShPKIJKU9asSTsWH9AANiZz43JApiI4jDxLkx0Sp9RqYojAMxXC3oNFE + JxFifYgXCWShCSqbzdLJ8SpfaF2mlM1S6c9ypQN + Fb4eyHOSWCr + N0IBR8WPaRQKE1MgpkBsWSBKjoFYA2InWU5ClMpmVKGQHTNoI5XHK + K3hDheIA4PVvJjBZnSsHiVfUmebDBfbLNQxIlR4f35wsQIZX2wkzzuQPwwF + yyQMxKGuQRyMZGD + bCF4SEKnPHngvESQkqnl5JfnC8ci5OkeTGqexxc0FuuEJvDrG7rCBBNRdPzoeLU8mPZ0ry4xKVceKF2dzIOGU8 + HIQDdggBDCBHEoGmAyygai1q74L3ilHwgAXSEEWEABHlWZwRsrAiBheE0Ah + BMiAZANzQseGBWAAqj / MqRVXh1B5sBowcCMHPAU4jwQBXLhvXxglnjIWzJ4AjWif3jnQuHBeHOhKMb / vX5Q + 03DgppolUY + 6JGpOWhJDCWGECOIYUQ73BAPwP3waHgNguKKe + M + g3l8syc8JbQRHhGuE9oJtyeJ5kl / iHI0aIf8YapaZHxfC9wacnrgwbg / ZIfMOAM3BI64O / TDwgOhZw + oZaviVlSF + QP33zL47mmo7MjOZJQ8jBxEtv1xpoa9hscQi6LW39dHGWvGUL3ZQyM / +md / V30 + 7KN + tMQWYQewM9hx7BzWhNUDJnYMa8AuYkcUeGh1PRlYXYPe4gfiyYE8on / 446p8Kiopc65x7nT + rBzLF0zLV2w89mTJdKkoS5jPZMGvg4DJEfOcRjBdnV1dAFB8a5Svr7eMgW8Iwjj / TTcf7nF / cX9 / f9M3XdQnAA6awe3f / k1ncwW + JuB7 + uwKnlxaoNThigsBviU04U4zACbAAtjCfFyBJ / ADQSAURIJYkAhSwURYZSFc51IwFcwEc0ExKAXLwRpQATaBrWAn2AP2g3rQBI6D0 + ACuAyug7tw9XSAl6AbvAd9CIKQEBpCRwwQU8QKcUBcEW8kAAlFopF4JBVJR7IQMSJHZiLzkVJkJVKBbEGqkV + Rw8hx5BzShtxGHiKdyBvkE4qhVFQXNUat0ZGoN8pCo9BEdAKahU5BC9EF6FK0HK1Cd6N16HH0AnodbUdfoj0YwNQxBmaGOWLeGBuLxdKwTEyKzcZKsDKsCqvFGuFzvoq1Y13YR5yI03Em7ghXcASehPPwKfhsfAlege / E6 / CT + FX8Id6NfyXQCEYEB4IvgUMYS8giTCUUE8oI2wmHCKfgXuogvCcSiQyiDdEL7sVUYjZxBnEJcQNxL7GZ2EZ8TOwhkUgGJAeSPymWxCXlk4pJ60i7ScdIV0gdpF41dTVTNVe1MLU0NbHaPLUytV1qR9WuqD1T6yNrka3IvuRYMp88nbyMvI3cSL5E7iD3UbQpNhR / SiIlmzKXUk6ppZyi3KO8VVdXN1f3UR + jLlIvUi9X36d + Vv2h + keqDtWeyqaOp8qpS6k7qM3U29S3NBrNmhZES6Pl05bSqmknaA9ovRp0DScNjgZfY45GpUadxhWNV5pkTStNluZEzULNMs0Dmpc0u7TIWtZabC2u1mytSq3DWje1erTp2i7asdp52ku0d2mf036uQ9Kx1gnV4ess0Nmqc0LnMR2jW9DZdB59Pn0b / RS9Q5eoa6PL0c3WLdXdo9uq262no + eul6w3Ta9S74heOwNjWDM4jFzGMsZ + xg3Gp2HGw1jDBMMWD6sddmXYB / 3h + kH6Av0S / b361 / U / GTANQg1yDFYY1BvcN8QN7Q3HGE413Gh4yrBruO5wv + G84SXD9w + /Y4Qa2RvFG80w2mp00ajH2MQ43FhivM74hHGXCcMkyCTbZLXJUZNOU7ppgKnIdLXpMdMXTD0mi5nLLGeeZHabGZlFmMnNtpi1mvWZ25gnmc8z32t+34Ji4W2RabHaosWi29LUcrTlTMsayztWZCtvK6HVWqszVh+sbaxTrBda11s/t9G34dgU2tTY3LOl2QbaTrGtsr1mR7Tztsux22B32R6197AX2lfaX3JAHTwdRA4bHNpGEEb4jBCPqBpx05HqyHIscKxxfOjEcIp2mudU7 / RqpOXItJErRp4Z + dXZwznXeZvzXRcdl0iXeS6NLm9c7V15rpWu19xobmFuc9wa3F67O7gL3De63 / Kge4z2WOjR4vHF08tT6lnr2ell6ZXutd7rpreud5z3Eu + zPgSfYJ85Pk0 + H309ffN99 / v + 5efol + O3y + /5KJtRglHbRj32N/fn + m / xbw9gBqQHbA5oDzQL5AZWBT4KsgjiB20PesayY2WzdrNeBTsHS4MPBX9g + 7JnsZtDsJDwkJKQ1lCd0KTQitAHYeZhWWE1Yd3hHuEzwpsjCBFRESsibnKMOTxONac70ityVuTJKGpUQlRF1KNo + 2hpdONodHTk6FWj78VYxYhj6mNBLCd2Vez9OJu4KXG / jSGOiRtTOeZpvEv8zPgzCfSESQm7Et4nBicuS7ybZJskT2pJ1kwen1yd / CElJGVlSvvYkWNnjb2QapgqSm1II6Ulp21P6xkXOm7NuI7xHuOLx9 + YYDNh2oRzEw0n5k48MklzEnfSgXRCekr6rvTP3FhuFbcng5OxPqObx + at5b3kB / FX8zsF / oKVgmeZ / pkrM59n + WetyuoUBgrLhF0itqhC9Do7IntT9oec2JwdOf25Kbl789Ty0vMOi3XEOeKTk00mT5vcJnGQFEvap / hOWTOlWxol3S5DZBNkDfm68Kf + otxW / pP8YUFAQWVB79TkqQemaU8TT7s43X764unPCsMKf5mBz + DNaJlpNnPuzIezWLO2zEZmZ8xumWMxZ8GcjqLwop1zKXNz5v4 + z3neynnv5qfMb1xgvKBoweOfwn + qKdYolhbfXOi3cNMifJFoUetit8XrFn8t4ZecL3UuLSv9vIS35PzPLj + X / 9y / NHNp6zLPZRuXE5eLl99YEbhi50rtlYUrH68avapuNXN1yep3ayatOVfmXrZpLWWtfG17eXR5wzrLdcvXfa4QVlyvDK7cu95o / eL1HzbwN1zZGLSxdpPxptJNnzaLNt / aEr6lrsq6qmwrcWvB1qfbkred + cX7l + rthttLt3 / ZId7RvjN + 58lqr + rqXUa7ltWgNfKazt3jd1 / eE7Knodaxdstext7SfWCffN + LX9N / vbE / an / LAe8DtQetDq4 / RD9UUofUTa / rrhfWtzekNrQdjjzc0ujXeOg3p992NJk1VR7RO7LsKOXogqP9xwqP9TRLmruOZx1 / 3DKp5e6JsSeunRxzsvVU1Kmzp8NOnzjDOnPsrP / ZpnO + 5w6f9z5ff8HzQt1Fj4uHfvf4 / VCrZ2vdJa9LDZd9Lje2jWo7eiXwyvGrIVdPX + Ncu3A95nrbjaQbt26Ov9l + i3 / r + e3c26 / vFNzpu1t0j3Cv5L7W / bIHRg + q / rD7Y2 + 7Z / uRhyEPLz5KeHT3Me / xyyeyJ587FjylPS17Zvqs + rnr86bOsM7LL8a96HgpednXVfyn9p / rX9m + OvhX0F8Xu8d2d7yWvu5 / s + Stwdsd79zftfTE9Tx4n / e + 70NJr0Hvzo / eH898Svn0rG / qZ9Ln8i92Xxq / Rn2915 / X3y / hSrkDvwIYFDQzE4A3OwCgpQJAh + c2yjjlWXCgIcrz6wAC / wkrz4sDzROAWtgpfuPZzQDsg2JdBLmhKH7hE4MA6uY2JKomy3RzVXJR4UmI0Nvf / 9YYAFIjAF + k / f19G / r7v2yDwd4GoHmK8gyqaER4Ztjsr0DX9flF4IemPJ9 + l + OPPVBE4A5 + 7P8FftCPnyhPCsUAAABcZVhJZk1NACoAAAAIAAQBBgADAAAAAQACAAABEgADAAAAAQABAAABKAADAAAAAQACAACHaQAEAAAAAQAAAD4AAAAAAAKgAgAEAAAAAQAAAQCgAwAEAAAAAQAAADwAAAAAGgkzwgAAArVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24 + MTwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ + MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24 + MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6UGhvdG9tZXRyaWNJbnRlcnByZXRhdGlvbj4yPC90aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24 + CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4yNTY8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24 + NjA8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KHQLvsQAACDFJREFUeAHtnT1S5EgQhTUTa4LPATgAPhh44IPPBYjgCDt7CHwOAD54GOCDzwE4AH7vfr2kkDr0U1S9jk6qsyImJLU0Pan3sl5lZVbX / FosFn + aaIFAILCVCPzeyreOlw4EAoElAn8ZDo + Pj3 / beff4 + vra3N / fN09PT83Hx0f31rfOd3Z2mtPT0 + bw8LA5ODj41t9dffj9 / b25u7tb2lViE9 + LLRcXF8U2YQc23d7eFuGktInvCv5AYb5tG3 / Hx8f / gEorAKsQ4Tg3NzfNy8vL6q1vXdPxz87OmvPz84bzkla7TQjkyclJs7 + /XwLT8u/WjpVHn / qJ / PUEQK2CkHR0dFTkzNj08PCwHO3f3t6KvovRHnvoZCVihE1ERNhVKpB7e3tLexQCGfyluUfw94VTKwDX19fFITWdyjqYIsyng3kKqdUdTDn1wDamahxzW / CXjpx66rgp / loBoKPlNhzHY0imtAl8GPVLGjip8iCE + NhT2ul5n + AvjdUa + WsFIA2C / lOooM17 + ne + d4X6Mdrj0KUhNfNnswnCStrz8 / MyAim1yWMHA5fgL807auYvSwAI8xldS8N8Or63zLlnmxjtqYCUtuAvDUF1mO + NP1BIFgCPKmg2MeKTTCtphNQQRBSCCOQ2bFKF + SQ9LQFaYhPvYlgpko3qCkPwN + 9tav7 + KwMu / 9FZAbAwkfo9RuQ2HFgV5tPZceTSbD7vonZmTx2M9wv + QGG + qTuYooSO1evi7 + rqagnKqACow5 / I5k87oQkkUUhpudMcR1llCP7q5K8nAGoVVGbOFQtkVJlzcPJY7gz + pjup3Q3 + DIlODuDy8rI4pGYUYw5NqF + aOVcukKk5zLdOv7u7G / x9 + fXgmWHlaZpmNm2KvzYCIKuf2 + j4tWfzwYdRv6RZmK8odzJFsygEJyppwV8aejXy1wpAGgT9pxhZmbPyp6ThwB4z5zWXy + Ar + EvzWo8CqeIvSwBqXiBjIZnHMFFRLsNxgr + 0jq + eOnrjDxSSBcCjCppNRCClC2TWVW5Jc7Xhp5SrGg0rj9n84G + Y / +6nav7su2cFwMJETwtkYj8Ao2 / +GPzNY8QT6g6mKMFi17r5GxUAdfjjMaT2ZhMhoqLcaY6jWIzieUoU / MH0dJvjrycAahVUZs4JE0sXyKgy5 + DksdwZ / E13Brsb / BkSnRxA7AfwBcrYmbqDKcJEs4kjIskxtzFaWGkRsSxpTNNYD + Ix5 + DRpk3x10YAgJLb5sKM73yv16kH + DDqlzRwUpU7wQl7Sjs97xP8pbFaI3 + tAKRB0H / KMufMW0sa6qf6oZAyc15zuQy + gr80r / UokCr + sgSg5gUyiJHXVY2KchmOE / yldXwEUjlN88YfKCQLgEcVNJsUCyzWXW5Jc7n + U7EfQB + Pqavgbwqd / j2wiv0APjEBjFrLZbyihfmxn0O / E6xe2WDiqbS4Tv5iPwBn / 4mH5UEIE0vLneY4yvDVY + bcm03ksX4af70pgFoFlZlzxQIZRntF5hycPJbLgr / VcX34Ovj7wqUVgNgP4AuUsTN1B1NOPTb1e / IxrGI / hzFk + p + bT22Kv1YAYj + APjHdK + bRylWNRCGlG6Zgk0UhOFFJ81z5UIX5wd + wh7QCMHx7 + lPLvDLvKWk4sGqBjDJzXnO5DL6CvzSv9SiQKv6yBKDmBTIWknnKBptNinInjhP8pXV8dYXIG3 + gkCwAHlXQbFIssPBYLlOuajSsVCG1ssIQ / M0Lkpo / +xdnBcDCROatGJHblGF + 7AeQzkLwl4aVuoMpBBLL183fqACowx + PIbU3mwgRFeVOcxxllcEbViT1vNn0E / nrCYBaBZWZV8UCC1XmHJyIiLxtfx78pY / 2wd//WLUCEPsBzDuPuoMpwkSziSMiyTG3MU2z0iJiWdJiP4A09DbNXysAJIdym2WpvYVkyjBRuaqRdfmlHYwpGqNYaaeH8+AvzfOVeSwv/LUCkAZB/ynLnMd+AH1cVq88djBsDP5WmRq+rpm/LAGoeYGMhWS1lstw8eBvuKOvfopAKqdpinKnkj++K1kAPKqg2aRYYLHucsuqc6VcK1c1GlYep2nB37w3qPmL/QA+Ma+53MkrWpgf+wFMdzJ1B1OUYNfJX+wHEPsBTPeIz7uep0TepmmxH0DHpRhZlZlzxQIZVeaV0cJjuUw9igV/HYceOVWWOzfBX5sDiP0ARhjufKwmSBEmmk2b+j15B57eaewH0INj9GLT/LUCQM08t21DmKhc1Uj9PvYDmPY2tU8Ff8N4twIwfHv6U8ucU94oaaggmWDFAhll5rzmchl8BX9pXqsWI0VpUcVflgDE78nTHIcOpgzzFeUyLA/+gj9DIFkAPKqg2aRYYOGxXBb7AZibzh+Dv3mM7AmwsjYrABYmMm+lw+U2ZZgf+wGksxD8pWFlg4mn0iKWr5u/UQFQh68eV6B5s4kQX1HuNMdRTj+8YaX8oZcKp5/IX08A1CqozLwS5pf+hxmEPla/JyLJbeAUvydPQw+sVAtkgr80zHkKrFL6XysAsR/APLhqgVRkg80mjogkx9yGKJpAdueJOd+nXCCDLUqsPIX5m+avFQBAyW04jseQTGmTclWcotzJFC32A0jzWLAK/oaxagVg+Pb0pyizzXumn5y+iwoSJioWyCgz5zWXy2Ak+Jv2S7vrcYBT8ZclADUvkLGQzGOYqCh34jjBn3Xt6aN66uGNP94+WQA8qqDZpFggs+5yy7SrDd9Vrmo0rDxm84O/Yf67n6r5s/0Afi0Wiz/dfyjOA4FAYHsQ+L09rxpvGggEAqsI/AvmdVYjBwouMwAAAABJRU5ErkJggg=='

/*
 * Check whether a data payload is nearing the 20mb limit (Posthog's data upload limit). If it is, it checks the data for
 * data URIs (the likely culprit for large payloads). If it finds data URIs, it either replaces
 * it with a generic image (if it's an image) or removes it.
 * @data {object} the rr-web data object
 * @returns {object} the rr-web data object with data uris filtered out
 */
export function filterDataURLsFromLargeDataObjects(data) {
    if (data && typeof data === 'object') {
        var stringifiedData = JSON.stringify(data)
        // String length of 19000000 is an approximation of 20mb
        // Note: with compression, this limit may be able to be increased
        // but we're assuming most of the size is from a data uri which
        // is unlikely to be compressed further
        if (stringifiedData.length > 19000000) {
            var dataURIRegex = /data:([\w\/\-\.]+);(\w+),([^)"]*)/gim
            var matches = stringifiedData.matchAll(dataURIRegex)
            for (var match of matches) {
                if (match[1].toLocaleLowerCase().slice(0, 6) === 'image/') {
                    stringifiedData = stringifiedData.replace(match[0], replacementImageURI)
                } else {
                    stringifiedData = stringifiedData.replace(match[0], '')
                }
            }
        }
        return JSON.parse(stringifiedData)
    }
    return data
}
