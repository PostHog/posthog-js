{"version":3,"sources":["config.js","utils.js","autocapture-utils.js","autocapture.js","dom-capture.js","gdpr-utils.js","api-actions.js","posthog-group.js","posthog-people.js","posthog-persistence.js","posthog-core.js","loader-globals.js","../node_modules/parcel/src/builtins/hmr-runtime.js"],"names":["Config","DEBUG","LIB_VERSION","win","window","loc","hostname","navigator","userAgent","document","location","referrer","screen","width","height","ArrayProto","Array","prototype","FuncProto","Function","ObjProto","Object","slice","toString","hasOwnProperty","windowConsole","console","windowOpera","opera","nativeBind","bind","nativeForEach","forEach","nativeIndexOf","indexOf","nativeIsArray","isArray","breaker","DOMAIN_MATCH_REGEX","_","trim","str","replace","log","isUndefined","apply","arguments","err","each","arg","error","args","concat","toArray","critical","func","context","bound","call","isFunction","TypeError","ctor","self","result","bind_instance_methods","obj","iterator","undefined","length","i","l","key","escapeHTML","s","escaped","isString","extend","source","prop","f","test","x","isArguments","iterable","values","keys","results","value","identity","include","target","found","includes","needle","inherit","subclass","superclass","constructor","isObject","isEmptyObject","isDate","isNumber","isElement","nodeType","encodeDates","v","k","formatDate","timestamp","Date","now","d","pad","n","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","safewrap","e","safewrap_class","klass","functions","safewrap_instance_methods","strip_empty_properties","p","ret","truncate","val","push","JSONEncode","mixed_val","quote","string","escapable","meta","lastIndex","a","c","charCodeAt","holder","gap","indent","mind","partial","toJSON","isFinite","String","join","JSONDecode","at","ch","escapee","text","m","SyntaxError","next","charAt","number","hex","uffff","parseInt","fromCharCode","white","word","array","object","base64Encode","data","b64","o1","o2","o3","h1","h2","h3","h4","bits","ac","enc","tmp_arr","utf8Encode","utftext","start","end","stringl","c1","substring","UUID","T","R","Math","random","UA","ua","buffer","xor","byte_array","j","tmp","unshift","se","isBlockedUA","HTTPBuildQuery","formdata","arg_separator","use_val","use_key","tph_arr","encodeURIComponent","getQueryParam","url","param","regexS","regex","RegExp","exec","decodeURIComponent","getHashParam","hash","matches","match","cookie","get","name","nameEQ","ca","split","parse","set_seconds","seconds","cross_subdomain","is_secure","cdomain","expires","secure","domain","date","setTime","getTime","toGMTString","set","days","new_cookie_val","remove","_localStorage_supported","localStorage","is_supported","supported","msg","getItem","setItem","removeItem","register_event","element","type","handler","oldSchool","useCapture","addEventListener","ontype","old_handler","makeHandler","new_handler","old_handlers","event","fixEvent","old_result","new_result","preventDefault","stopPropagation","returnValue","cancelBubble","TOKEN_MATCH_REGEX","dom_query","getAllChildren","all","getElementsByTagName","bad_whitespace","hasClass","elem","selector","className","getElementsBySelector","tokens","token","tagName","foundCount","elements","currentContextIndex","currentContext","id","getElementById","nodeName","toLowerCase","token_match","attrName","attrOperator","attrValue","checkFunction","getAttribute","lastIndexOf","query","info","campaignParams","campaign_keywords","kw","params","kwkey","URL","searchEngine","search","searchInfo","keyword","browser","user_agent","vendor","browserVersion","versionRegexs","parseFloat","os","device","referringDomain","properties","href","people_properties","getClassName","el","baseVal","getSafeText","elText","shouldCaptureElement","childNodes","child","isTextNode","textContent","filter","shouldCaptureValue","isElementNode","isTag","tag","usefulElements","shouldCaptureDomEvent","parentIsUsefulElement","targetElementList","curEl","parentNode","classes","sensitiveNameRegex","ccRegex","ssnRegex","autocapture","_initializedTokens","_previousElementSibling","previousElementSibling","previousSibling","_loadScript","scriptUrlToLoad","callback","scriptTag","createElement","src","onload","scripts","insertBefore","body","appendChild","_getPropertiesFromElement","tag_name","props","attributes","attr","nthChild","nthOfType","currentElem","_getDefaultProperties","eventType","host","pathname","_extractCustomPropertyValue","customProperty","propValues","querySelectorAll","matchedElem","_getCustomProperties","_customProperties","eventSelector","eventElements","eventElement","_getEventTarget","srcElement","_captureEvent","instance","elementsJson","explicitNoCapture","shouldCaptureEl","elementText","safeElementText","capture","_navigate","_addDomEventHandlers","init","that","setTimeout","get_config","_maybeLoadEditor","parseDecideResponse","response","_send_request","method","_prepare_callback","_editorParamsFromHash","editorParams","state","JSON","expiresInSeconds","Number","sessionStorage","stringify","history","replaceState","title","parseFromUrl","parseFromStorage","_loadEditor","editorUrl","enabledForProject","numBuckets","numEnabledBuckets","charCodeSum","isBrowserSupported","DomCapture","create_properties","event_handler","after_capture_handler","posthog_instance","mp","event_name","user_callback","override_event","options","timeout","capture_callback","timeout_occured","callback_fired","LinkCapture","evt","new_tab","which","metaKey","ctrlKey","FormCapture","submit","GDPR_DEFAULT_PERSISTENCE_PREFIX","optIn","_optInOut","optOut","hasOptedIn","_getStorageValue","hasOptedOut","_hasDoNotCaptureFlagOn","addOptOutCheckPostHogLib","_addOptOutCheck","addOptOutCheckPostHogPeople","_get_config","addOptOutCheckPostHogGroup","clearOptInOut","_getStorage","_getStorageKey","crossSubdomainCookie","persistenceType","persistencePrefix","nav","hasDntOn","dntValue","optValue","cookieExpiration","secureCookie","captureEventName","captureProperties","getConfigValue","optedOut","SET_ACTION","SET_ONCE_ACTION","UNSET_ACTION","ADD_ACTION","APPEND_ACTION","UNION_ACTION","REMOVE_ACTION","DELETE_ACTION","apiActions","set_action","to","$set","_is_reserved_property","unset_action","$unset","set_once_action","$set_once","union_action","list_name","$union","append_action","$append","remove_action","$remove","delete_action","PostHogGroup","_init","group_key","group_id","_posthog","_group_key","_group_id","set_once","unset","union","date_encoded_data","truncated_data","json_data","encoded_data","conf","PostHogPeople","update_referrer_info","get_referrer_info","increment","by","$add","isNaN","append","capture_charge","amount","clear_charges","delete_user","_identify_called","get_distinct_id","device_id","get_property","user_id","had_persisted_distinct_id","_enqueue","status","conf_var","_flags","identify_called","_add_to_people_queue","_flush_one_queue","action","action_method","queue_to_params_fn","_this","queued_data","_get_queue","action_params","_pop_from_people_queue","_flush","_set_callback","_add_callback","_append_callback","_set_once_callback","_union_callback","_unset_callback","_remove_callback","$append_queue","$remove_queue","queue","$append_item","append_callback","pop","save","$remove_item","remove_callback","SET_QUEUE_KEY","SET_ONCE_QUEUE_KEY","UNSET_QUEUE_KEY","ADD_QUEUE_KEY","APPEND_QUEUE_KEY","REMOVE_QUEUE_KEY","UNION_QUEUE_KEY","PEOPLE_DISTINCT_ID_KEY","ALIAS_ID_KEY","CAMPAIGN_IDS_KEY","EVENT_TIMERS_KEY","RESERVED_PROPERTIES","PostHogPersistence","config","campaign_params_saved","storage_type","storage","load","update_config","upgrade","disabled","entry","upgrade_from_old_lib","old_cookie_name","old_cookie","register_once","_expire_notification_campaigns","expire_days","clear","default_value","default_expiry","register","unregister","campaigns_shown","EXPIRY_TIME","campaign_id","update_campaign_params","update_search_keyword","safe_merge","set_disabled","set_cross_subdomain","set_secure","get_cross_subdomain","q_key","_get_queue_key","q_data","set_q","_get_or_create_queue","set_once_q","unset_q","add_q","union_q","remove_q","append_q","enqueued_obj","append_obj","q","queued_action","default_val","set_event_timer","timers","remove_event_timer","init_type","posthog_master","INIT_MODULE","INIT_SNIPPET","__NOOP","__NOOPTIONS","PRIMARY_INSTANCE_NAME","USE_XHR","XMLHttpRequest","ENQUEUE_REQUESTS","sendBeacon","DEFAULT_CONFIG","DOM_LOADED","PostHogLib","create_mplib","_cached_groups","_user_decide_check_complete","_events_captureed_before_user_decide_check_complete","num_buckets","num_enabled_buckets","_execute_array","_loaded","set_config","_event_queue","_empty_queue_count","_should_poll","__dom_loaded_queue","__request_queue","__disabled_events","_gdpr_init","uuid","capture_pageview","_dom_loaded","item","_capture_dom","has_opted_out_captureing","_event_queue_poll","DomClass","dt","callback_function","jsc","randomized_cb","floor","callback_string","_event_enqueue","requests","request","DEFAULT_OPTIONS","transport","body_data","use_sendBeacon","use_post","verbose_mode","img","req","open","headers","headerValue","headerName","setRequestHeader","withCredentials","onreadystatechange","readyState","responseText","statusText","send","script","async","defer","fn_name","alias_calls","other_calls","captureing_calls","execute","calls","caller","disable","events","disable_all_events","_event_is_disabled","start_timestamp","duration_in_ms","toFixed","property_blacklist","blacklisted_prop","data_object","cb","has_unique_traits","set_group","group_ids","add_group","old_values","remove_group","old_value","idx","splice","capture_with_groups","groups","captureing_props","_create_map_key","_remove_group_from_cache","get_group","map_key","group","page","capture_links","capture_forms","FormCaptureer","time_event","property","_register_single","identify","new_distinct_id","previous_distinct_id","reset","alias","original","name_tag","prop_name","property_name","_handle_user_decide_check_complete","is_localStorage_requested","has_opted_in_captureing","opt_in_captureing","opt_out_captureing","clear_opt_in_out_captureing","_gdpr_update_persistence","_gdpr_call_func","_check_and_handle_notifications","instances","extend_mp","override_ph_init_func","add_dom_loaded_handler","dom_loaded_handler","done","inst","do_scroll_check","documentElement","doScroll","attachEvent","toplevel","frameElement","init_from_snippet","posthog","init_as_module","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","protocol","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","message","stack","overlay","createErrorOverlay","stackTrace","innerText","innerHTML","getParents","modules","parents","dep","deps","cached","cache","some"],"mappings":"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","file":"array.js","sourceRoot":"../src","sourcesContent":["var Config = {\n    DEBUG: false,\n    LIB_VERSION: '1.0.0'\n};\n\nexport default Config;\n","/* eslint camelcase: \"off\", eqeqeq: \"off\" */\nimport Config from './config';\n\n// since es6 imports are static and we run unit tests from the console, window won't be defined when importing this file\nvar win;\nif (typeof(window) === 'undefined') {\n    var loc = {\n        hostname: ''\n    };\n    win = {\n        navigator: { userAgent: '' },\n        document: {\n            location: loc,\n            referrer: ''\n        },\n        screen: { width: 0, height: 0 },\n        location: loc\n    };\n} else {\n    win = window;\n}\n\n/*\n * Saved references to long variable names, so that closure compiler can\n * minimize file size.\n */\n\nvar ArrayProto = Array.prototype,\n    FuncProto = Function.prototype,\n    ObjProto = Object.prototype,\n    slice = ArrayProto.slice,\n    toString = ObjProto.toString,\n    hasOwnProperty = ObjProto.hasOwnProperty,\n    windowConsole = win.console,\n    navigator = win.navigator,\n    document = win.document,\n    windowOpera = win.opera,\n    screen = win.screen,\n    userAgent = navigator.userAgent;\n\nvar nativeBind = FuncProto.bind,\n    nativeForEach = ArrayProto.forEach,\n    nativeIndexOf = ArrayProto.indexOf,\n    nativeIsArray = Array.isArray,\n    breaker = {};\n\nvar DOMAIN_MATCH_REGEX = /[a-z0-9][a-z0-9-]+\\.[a-z.]{2,6}$/i;\n\nvar _ = {\n    trim: function(str) {\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim#Polyfill\n        return str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n    }\n};\n\n// Console override\nvar console = {\n    /** @type {function(...*)} */\n    log: function() {\n        if (Config.DEBUG && !_.isUndefined(windowConsole) && windowConsole) {\n            try {\n                windowConsole.log.apply(windowConsole, arguments);\n            } catch (err) {\n                _.each(arguments, function(arg) {\n                    windowConsole.log(arg);\n                });\n            }\n        }\n    },\n    /** @type {function(...*)} */\n    error: function() {\n        if (Config.DEBUG && !_.isUndefined(windowConsole) && windowConsole) {\n            var args = ['PostHog error:'].concat(_.toArray(arguments));\n            try {\n                windowConsole.error.apply(windowConsole, args);\n            } catch (err) {\n                _.each(args, function(arg) {\n                    windowConsole.error(arg);\n                });\n            }\n        }\n    },\n    /** @type {function(...*)} */\n    critical: function() {\n        if (!_.isUndefined(windowConsole) && windowConsole) {\n            var args = ['PostHog error:'].concat(_.toArray(arguments));\n            try {\n                windowConsole.error.apply(windowConsole, args);\n            } catch (err) {\n                _.each(args, function(arg) {\n                    windowConsole.error(arg);\n                });\n            }\n        }\n    }\n};\n\n\n// UNDERSCORE\n// Embed part of the Underscore Library\n_.bind = function(func, context) {\n    var args, bound;\n    if (nativeBind && func.bind === nativeBind) {\n        return nativeBind.apply(func, slice.call(arguments, 1));\n    }\n    if (!_.isFunction(func)) {\n        throw new TypeError();\n    }\n    args = slice.call(arguments, 2);\n    bound = function() {\n        if (!(this instanceof bound)) {\n            return func.apply(context, args.concat(slice.call(arguments)));\n        }\n        var ctor = {};\n        ctor.prototype = func.prototype;\n        var self = new ctor();\n        ctor.prototype = null;\n        var result = func.apply(self, args.concat(slice.call(arguments)));\n        if (Object(result) === result) {\n            return result;\n        }\n        return self;\n    };\n    return bound;\n};\n\n_.bind_instance_methods = function(obj) {\n    for (var func in obj) {\n        if (typeof(obj[func]) === 'function') {\n            obj[func] = _.bind(obj[func], obj);\n        }\n    }\n};\n\n/**\n * @param {*=} obj\n * @param {function(...*)=} iterator\n * @param {Object=} context\n */\n_.each = function(obj, iterator, context) {\n    if (obj === null || obj === undefined) {\n        return;\n    }\n    if (nativeForEach && obj.forEach === nativeForEach) {\n        obj.forEach(iterator, context);\n    } else if (obj.length === +obj.length) {\n        for (var i = 0, l = obj.length; i < l; i++) {\n            if (i in obj && iterator.call(context, obj[i], i, obj) === breaker) {\n                return;\n            }\n        }\n    } else {\n        for (var key in obj) {\n            if (hasOwnProperty.call(obj, key)) {\n                if (iterator.call(context, obj[key], key, obj) === breaker) {\n                    return;\n                }\n            }\n        }\n    }\n};\n\n_.escapeHTML = function(s) {\n    var escaped = s;\n    if (escaped && _.isString(escaped)) {\n        escaped = escaped\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&#039;');\n    }\n    return escaped;\n};\n\n_.extend = function(obj) {\n    _.each(slice.call(arguments, 1), function(source) {\n        for (var prop in source) {\n            if (source[prop] !== void 0) {\n                obj[prop] = source[prop];\n            }\n        }\n    });\n    return obj;\n};\n\n_.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) === '[object Array]';\n};\n\n// from a comment on http://dbj.org/dbj/?p=286\n// fails on only one very rare and deliberate custom object:\n// var bomb = { toString : undefined, valueOf: function(o) { return \"function BOMBA!\"; }};\n_.isFunction = function(f) {\n    try {\n        return /^\\s*\\bfunction\\b/.test(f);\n    } catch (x) {\n        return false;\n    }\n};\n\n_.isArguments = function(obj) {\n    return !!(obj && hasOwnProperty.call(obj, 'callee'));\n};\n\n_.toArray = function(iterable) {\n    if (!iterable) {\n        return [];\n    }\n    if (iterable.toArray) {\n        return iterable.toArray();\n    }\n    if (_.isArray(iterable)) {\n        return slice.call(iterable);\n    }\n    if (_.isArguments(iterable)) {\n        return slice.call(iterable);\n    }\n    return _.values(iterable);\n};\n\n_.keys = function(obj) {\n    var results = [];\n    if (obj === null) {\n        return results;\n    }\n    _.each(obj, function(value, key) {\n        results[results.length] = key;\n    });\n    return results;\n};\n\n_.values = function(obj) {\n    var results = [];\n    if (obj === null) {\n        return results;\n    }\n    _.each(obj, function(value) {\n        results[results.length] = value;\n    });\n    return results;\n};\n\n_.identity = function(value) {\n    return value;\n};\n\n_.include = function(obj, target) {\n    var found = false;\n    if (obj === null) {\n        return found;\n    }\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) {\n        return obj.indexOf(target) != -1;\n    }\n    _.each(obj, function(value) {\n        if (found || (found = (value === target))) {\n            return breaker;\n        }\n    });\n    return found;\n};\n\n_.includes = function(str, needle) {\n    return str.indexOf(needle) !== -1;\n};\n\n// Underscore Addons\n_.inherit = function(subclass, superclass) {\n    subclass.prototype = new superclass();\n    subclass.prototype.constructor = subclass;\n    subclass.superclass = superclass.prototype;\n    return subclass;\n};\n\n_.isObject = function(obj) {\n    return (obj === Object(obj) && !_.isArray(obj));\n};\n\n_.isEmptyObject = function(obj) {\n    if (_.isObject(obj)) {\n        for (var key in obj) {\n            if (hasOwnProperty.call(obj, key)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    return false;\n};\n\n_.isUndefined = function(obj) {\n    return obj === void 0;\n};\n\n_.isString = function(obj) {\n    return toString.call(obj) == '[object String]';\n};\n\n_.isDate = function(obj) {\n    return toString.call(obj) == '[object Date]';\n};\n\n_.isNumber = function(obj) {\n    return toString.call(obj) == '[object Number]';\n};\n\n_.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n};\n\n_.encodeDates = function(obj) {\n    _.each(obj, function(v, k) {\n        if (_.isDate(v)) {\n            obj[k] = _.formatDate(v);\n        } else if (_.isObject(v)) {\n            obj[k] = _.encodeDates(v); // recurse\n        }\n    });\n    return obj;\n};\n\n_.timestamp = function() {\n    Date.now = Date.now || function() {\n        return +new Date;\n    };\n    return Date.now();\n};\n\n_.formatDate = function(d) {\n    // YYYY-MM-DDTHH:MM:SS in UTC\n    function pad(n) {\n        return n < 10 ? '0' + n : n;\n    }\n    return d.getUTCFullYear() + '-' +\n        pad(d.getUTCMonth() + 1) + '-' +\n        pad(d.getUTCDate()) + 'T' +\n        pad(d.getUTCHours()) + ':' +\n        pad(d.getUTCMinutes()) + ':' +\n        pad(d.getUTCSeconds());\n};\n\n_.safewrap = function(f) {\n    return function() {\n        try {\n            return f.apply(this, arguments);\n        } catch (e) {\n            console.critical('Implementation error. Please turn on debug and contact support@posthog.com.');\n            if (Config.DEBUG){\n                console.critical(e);\n            }\n        }\n    };\n};\n\n_.safewrap_class = function(klass, functions) {\n    for (var i = 0; i < functions.length; i++) {\n        klass.prototype[functions[i]] = _.safewrap(klass.prototype[functions[i]]);\n    }\n};\n\n_.safewrap_instance_methods = function(obj) {\n    for (var func in obj) {\n        if (typeof(obj[func]) === 'function') {\n            obj[func] = _.safewrap(obj[func]);\n        }\n    }\n};\n\n_.strip_empty_properties = function(p) {\n    var ret = {};\n    _.each(p, function(v, k) {\n        if (_.isString(v) && v.length > 0) {\n            ret[k] = v;\n        }\n    });\n    return ret;\n};\n\n/*\n * this function returns a copy of object after truncating it.  If\n * passed an Array or Object it will iterate through obj and\n * truncate all the values recursively.\n */\n_.truncate = function(obj, length) {\n    var ret;\n\n    if (typeof(obj) === 'string') {\n        ret = obj.slice(0, length);\n    } else if (_.isArray(obj)) {\n        ret = [];\n        _.each(obj, function(val) {\n            ret.push(_.truncate(val, length));\n        });\n    } else if (_.isObject(obj)) {\n        ret = {};\n        _.each(obj, function(val, key) {\n            ret[key] = _.truncate(val, length);\n        });\n    } else {\n        ret = obj;\n    }\n\n    return ret;\n};\n\n_.JSONEncode = (function() {\n    return function(mixed_val) {\n        var value = mixed_val;\n        var quote = function(string) {\n            var escapable = /[\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g; // eslint-disable-line no-control-regex\n            var meta = { // table of character substitutions\n                '\\b': '\\\\b',\n                '\\t': '\\\\t',\n                '\\n': '\\\\n',\n                '\\f': '\\\\f',\n                '\\r': '\\\\r',\n                '\"': '\\\\\"',\n                '\\\\': '\\\\\\\\'\n            };\n\n            escapable.lastIndex = 0;\n            return escapable.test(string) ?\n                '\"' + string.replace(escapable, function(a) {\n                    var c = meta[a];\n                    return typeof c === 'string' ? c :\n                        '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n                }) + '\"' :\n                '\"' + string + '\"';\n        };\n\n        var str = function(key, holder) {\n            var gap = '';\n            var indent = '    ';\n            var i = 0; // The loop counter.\n            var k = ''; // The member key.\n            var v = ''; // The member value.\n            var length = 0;\n            var mind = gap;\n            var partial = [];\n            var value = holder[key];\n\n            // If the value has a toJSON method, call it to obtain a replacement value.\n            if (value && typeof value === 'object' &&\n                typeof value.toJSON === 'function') {\n                value = value.toJSON(key);\n            }\n\n            // What happens next depends on the value's type.\n            switch (typeof value) {\n                case 'string':\n                    return quote(value);\n\n                case 'number':\n                    // JSON numbers must be finite. Encode non-finite numbers as null.\n                    return isFinite(value) ? String(value) : 'null';\n\n                case 'boolean':\n                case 'null':\n                    // If the value is a boolean or null, convert it to a string. Note:\n                    // typeof null does not produce 'null'. The case is included here in\n                    // the remote chance that this gets fixed someday.\n\n                    return String(value);\n\n                case 'object':\n                    // If the type is 'object', we might be dealing with an object or an array or\n                    // null.\n                    // Due to a specification blunder in ECMAScript, typeof null is 'object',\n                    // so watch out for that case.\n                    if (!value) {\n                        return 'null';\n                    }\n\n                    // Make an array to hold the partial results of stringifying this object value.\n                    gap += indent;\n                    partial = [];\n\n                    // Is the value an array?\n                    if (toString.apply(value) === '[object Array]') {\n                        // The value is an array. Stringify every element. Use null as a placeholder\n                        // for non-JSON values.\n\n                        length = value.length;\n                        for (i = 0; i < length; i += 1) {\n                            partial[i] = str(i, value) || 'null';\n                        }\n\n                        // Join all of the elements together, separated with commas, and wrap them in\n                        // brackets.\n                        v = partial.length === 0 ? '[]' :\n                            gap ? '[\\n' + gap +\n                            partial.join(',\\n' + gap) + '\\n' +\n                            mind + ']' :\n                                '[' + partial.join(',') + ']';\n                        gap = mind;\n                        return v;\n                    }\n\n                    // Iterate through all of the keys in the object.\n                    for (k in value) {\n                        if (hasOwnProperty.call(value, k)) {\n                            v = str(k, value);\n                            if (v) {\n                                partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                            }\n                        }\n                    }\n\n                    // Join all of the member texts together, separated with commas,\n                    // and wrap them in braces.\n                    v = partial.length === 0 ? '{}' :\n                        gap ? '{' + partial.join(',') + '' +\n                        mind + '}' : '{' + partial.join(',') + '}';\n                    gap = mind;\n                    return v;\n            }\n        };\n\n        // Make a fake root object containing our value under the key of ''.\n        // Return the result of stringifying the value.\n        return str('', {\n            '': value\n        });\n    };\n})();\n\n/**\n * From https://github.com/douglascrockford/JSON-js/blob/master/json_parse.js\n * Slightly modified to throw a real Error rather than a POJO\n */\n_.JSONDecode = (function() {\n    var at, // The index of the current character\n        ch, // The current character\n        escapee = {\n            '\"': '\"',\n            '\\\\': '\\\\',\n            '/': '/',\n            'b': '\\b',\n            'f': '\\f',\n            'n': '\\n',\n            'r': '\\r',\n            't': '\\t'\n        },\n        text,\n        error = function(m) {\n            var e = new SyntaxError(m);\n            e.at = at;\n            e.text = text;\n            throw e;\n        },\n        next = function(c) {\n            // If a c parameter is provided, verify that it matches the current character.\n            if (c && c !== ch) {\n                error('Expected \\'' + c + '\\' instead of \\'' + ch + '\\'');\n            }\n            // Get the next character. When there are no more characters,\n            // return the empty string.\n            ch = text.charAt(at);\n            at += 1;\n            return ch;\n        },\n        number = function() {\n            // Parse a number value.\n            var number,\n                string = '';\n\n            if (ch === '-') {\n                string = '-';\n                next('-');\n            }\n            while (ch >= '0' && ch <= '9') {\n                string += ch;\n                next();\n            }\n            if (ch === '.') {\n                string += '.';\n                while (next() && ch >= '0' && ch <= '9') {\n                    string += ch;\n                }\n            }\n            if (ch === 'e' || ch === 'E') {\n                string += ch;\n                next();\n                if (ch === '-' || ch === '+') {\n                    string += ch;\n                    next();\n                }\n                while (ch >= '0' && ch <= '9') {\n                    string += ch;\n                    next();\n                }\n            }\n            number = +string;\n            if (!isFinite(number)) {\n                error('Bad number');\n            } else {\n                return number;\n            }\n        },\n\n        string = function() {\n            // Parse a string value.\n            var hex,\n                i,\n                string = '',\n                uffff;\n            // When parsing for string values, we must look for \" and \\ characters.\n            if (ch === '\"') {\n                while (next()) {\n                    if (ch === '\"') {\n                        next();\n                        return string;\n                    }\n                    if (ch === '\\\\') {\n                        next();\n                        if (ch === 'u') {\n                            uffff = 0;\n                            for (i = 0; i < 4; i += 1) {\n                                hex = parseInt(next(), 16);\n                                if (!isFinite(hex)) {\n                                    break;\n                                }\n                                uffff = uffff * 16 + hex;\n                            }\n                            string += String.fromCharCode(uffff);\n                        } else if (typeof escapee[ch] === 'string') {\n                            string += escapee[ch];\n                        } else {\n                            break;\n                        }\n                    } else {\n                        string += ch;\n                    }\n                }\n            }\n            error('Bad string');\n        },\n        white = function() {\n            // Skip whitespace.\n            while (ch && ch <= ' ') {\n                next();\n            }\n        },\n        word = function() {\n            // true, false, or null.\n            switch (ch) {\n                case 't':\n                    next('t');\n                    next('r');\n                    next('u');\n                    next('e');\n                    return true;\n                case 'f':\n                    next('f');\n                    next('a');\n                    next('l');\n                    next('s');\n                    next('e');\n                    return false;\n                case 'n':\n                    next('n');\n                    next('u');\n                    next('l');\n                    next('l');\n                    return null;\n            }\n            error('Unexpected \"' + ch + '\"');\n        },\n        value, // Placeholder for the value function.\n        array = function() {\n            // Parse an array value.\n            var array = [];\n\n            if (ch === '[') {\n                next('[');\n                white();\n                if (ch === ']') {\n                    next(']');\n                    return array; // empty array\n                }\n                while (ch) {\n                    array.push(value());\n                    white();\n                    if (ch === ']') {\n                        next(']');\n                        return array;\n                    }\n                    next(',');\n                    white();\n                }\n            }\n            error('Bad array');\n        },\n        object = function() {\n            // Parse an object value.\n            var key,\n                object = {};\n\n            if (ch === '{') {\n                next('{');\n                white();\n                if (ch === '}') {\n                    next('}');\n                    return object; // empty object\n                }\n                while (ch) {\n                    key = string();\n                    white();\n                    next(':');\n                    if (Object.hasOwnProperty.call(object, key)) {\n                        error('Duplicate key \"' + key + '\"');\n                    }\n                    object[key] = value();\n                    white();\n                    if (ch === '}') {\n                        next('}');\n                        return object;\n                    }\n                    next(',');\n                    white();\n                }\n            }\n            error('Bad object');\n        };\n\n    value = function() {\n        // Parse a JSON value. It could be an object, an array, a string,\n        // a number, or a word.\n        white();\n        switch (ch) {\n            case '{':\n                return object();\n            case '[':\n                return array();\n            case '\"':\n                return string();\n            case '-':\n                return number();\n            default:\n                return ch >= '0' && ch <= '9' ? number() : word();\n        }\n    };\n\n    // Return the json_parse function. It will have access to all of the\n    // above functions and variables.\n    return function(source) {\n        var result;\n\n        text = source;\n        at = 0;\n        ch = ' ';\n        result = value();\n        white();\n        if (ch) {\n            error('Syntax error');\n        }\n\n        return result;\n    };\n})();\n\n_.base64Encode = function(data) {\n    var b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n    var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,\n        ac = 0,\n        enc = '',\n        tmp_arr = [];\n\n    if (!data) {\n        return data;\n    }\n\n    data = _.utf8Encode(data);\n\n    do { // pack three octets into four hexets\n        o1 = data.charCodeAt(i++);\n        o2 = data.charCodeAt(i++);\n        o3 = data.charCodeAt(i++);\n\n        bits = o1 << 16 | o2 << 8 | o3;\n\n        h1 = bits >> 18 & 0x3f;\n        h2 = bits >> 12 & 0x3f;\n        h3 = bits >> 6 & 0x3f;\n        h4 = bits & 0x3f;\n\n        // use hexets to index into b64, and append result to encoded string\n        tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);\n    } while (i < data.length);\n\n    enc = tmp_arr.join('');\n\n    switch (data.length % 3) {\n        case 1:\n            enc = enc.slice(0, -2) + '==';\n            break;\n        case 2:\n            enc = enc.slice(0, -1) + '=';\n            break;\n    }\n\n    return enc;\n};\n\n_.utf8Encode = function(string) {\n    string = (string + '').replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n\n    var utftext = '',\n        start,\n        end;\n    var stringl = 0,\n        n;\n\n    start = end = 0;\n    stringl = string.length;\n\n    for (n = 0; n < stringl; n++) {\n        var c1 = string.charCodeAt(n);\n        var enc = null;\n\n        if (c1 < 128) {\n            end++;\n        } else if ((c1 > 127) && (c1 < 2048)) {\n            enc = String.fromCharCode((c1 >> 6) | 192, (c1 & 63) | 128);\n        } else {\n            enc = String.fromCharCode((c1 >> 12) | 224, ((c1 >> 6) & 63) | 128, (c1 & 63) | 128);\n        }\n        if (enc !== null) {\n            if (end > start) {\n                utftext += string.substring(start, end);\n            }\n            utftext += enc;\n            start = end = n + 1;\n        }\n    }\n\n    if (end > start) {\n        utftext += string.substring(start, string.length);\n    }\n\n    return utftext;\n};\n\n_.UUID = (function() {\n\n    // Time/ticks information\n    // 1*new Date() is a cross browser version of Date.now()\n    var T = function() {\n        var d = 1 * new Date(),\n            i = 0;\n\n        // this while loop figures how many browser ticks go by\n        // before 1*new Date() returns a new number, ie the amount\n        // of ticks that go by per millisecond\n        while (d == 1 * new Date()) {\n            i++;\n        }\n\n        return d.toString(16) + i.toString(16);\n    };\n\n    // Math.Random entropy\n    var R = function() {\n        return Math.random().toString(16).replace('.', '');\n    };\n\n    // User agent entropy\n    // This function takes the user agent string, and then xors\n    // together each sequence of 8 bytes.  This produces a final\n    // sequence of 8 bytes which it returns as hex.\n    var UA = function() {\n        var ua = userAgent,\n            i, ch, buffer = [],\n            ret = 0;\n\n        function xor(result, byte_array) {\n            var j, tmp = 0;\n            for (j = 0; j < byte_array.length; j++) {\n                tmp |= (buffer[j] << j * 8);\n            }\n            return result ^ tmp;\n        }\n\n        for (i = 0; i < ua.length; i++) {\n            ch = ua.charCodeAt(i);\n            buffer.unshift(ch & 0xFF);\n            if (buffer.length >= 4) {\n                ret = xor(ret, buffer);\n                buffer = [];\n            }\n        }\n\n        if (buffer.length > 0) {\n            ret = xor(ret, buffer);\n        }\n\n        return ret.toString(16);\n    };\n\n    return function() {\n        var se = (screen.height * screen.width).toString(16);\n        return (T() + '-' + R() + '-' + UA() + '-' + se + '-' + T());\n    };\n})();\n\n// _.isBlockedUA()\n// This is to block various web spiders from executing our JS and\n// sending false captureing data\n_.isBlockedUA = function(ua) {\n    if (/(google web preview|baiduspider|yandexbot|bingbot|googlebot|yahoo! slurp)/i.test(ua)) {\n        return true;\n    }\n    return false;\n};\n\n/**\n * @param {Object=} formdata\n * @param {string=} arg_separator\n */\n_.HTTPBuildQuery = function(formdata, arg_separator) {\n    var use_val, use_key, tph_arr = [];\n\n    if (_.isUndefined(arg_separator)) {\n        arg_separator = '&';\n    }\n\n    _.each(formdata, function(val, key) {\n        use_val = encodeURIComponent(val.toString());\n        use_key = encodeURIComponent(key);\n        tph_arr[tph_arr.length] = use_key + '=' + use_val;\n    });\n\n    return tph_arr.join(arg_separator);\n};\n\n_.getQueryParam = function(url, param) {\n    // Expects a raw URL\n\n    param = param.replace(/[[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n    var regexS = '[\\\\?&]' + param + '=([^&#]*)',\n        regex = new RegExp(regexS),\n        results = regex.exec(url);\n    if (results === null || (results && typeof(results[1]) !== 'string' && results[1].length)) {\n        return '';\n    } else {\n        var result = results[1];\n        try {\n            result = decodeURIComponent(result);\n        } catch(err) {\n            console.error('Skipping decoding for malformed query param: ' + result);\n        }\n        return result.replace(/\\+/g, ' ');\n    }\n};\n\n_.getHashParam = function(hash, param) {\n    var matches = hash.match(new RegExp(param + '=([^&]*)'));\n    return matches ? matches[1] : null;\n};\n\n// _.cookie\n// Methods partially borrowed from quirksmode.org/js/cookies.html\n_.cookie = {\n    get: function(name) {\n        try {\n            var nameEQ = name + '=';\n            var ca = document.cookie.split(';');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == ' ') {\n                    c = c.substring(1, c.length);\n                }\n                if (c.indexOf(nameEQ) === 0) {\n                    return decodeURIComponent(c.substring(nameEQ.length, c.length));\n                }\n            }\n        } catch(err) {} \n        return null;\n    },\n\n    parse: function(name) {\n        var cookie;\n        try {\n            cookie = _.JSONDecode(_.cookie.get(name)) || {};\n        } catch (err) {\n            // noop\n        }\n        return cookie;\n    },\n\n    set_seconds: function(name, value, seconds, cross_subdomain, is_secure) {\n        try {\n            var cdomain = '',\n                expires = '',\n                secure = '';\n\n            if (cross_subdomain) {\n                var matches = document.location.hostname.match(DOMAIN_MATCH_REGEX),\n                    domain = matches ? matches[0] : '';\n\n                cdomain = ((domain) ? '; domain=.' + domain : '');\n            }\n\n            if (seconds) {\n                var date = new Date();\n                date.setTime(date.getTime() + (seconds * 1000));\n                expires = '; expires=' + date.toGMTString();\n            }\n\n            if (is_secure) {\n                secure = '; secure';\n            }\n\n            document.cookie = name + '=' + encodeURIComponent(value) + expires + '; path=/' + cdomain + secure;\n        } catch(err) { return }\n    },\n\n    set: function(name, value, days, cross_subdomain, is_secure) {\n        try {\n            var cdomain = '', expires = '', secure = '';\n\n            if (cross_subdomain) {\n                var matches = document.location.hostname.match(DOMAIN_MATCH_REGEX),\n                    domain = matches ? matches[0] : '';\n\n                cdomain   = ((domain) ? '; domain=.' + domain : '');\n            }\n\n            if (days) {\n                var date = new Date();\n                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n                expires = '; expires=' + date.toGMTString();\n            }\n\n            if (is_secure) {\n                secure = '; secure';\n            }\n\n            var new_cookie_val = name + '=' + encodeURIComponent(value) + expires + '; path=/' + cdomain + secure;\n            document.cookie = new_cookie_val;\n            return new_cookie_val;\n        } catch(err) { return }\n    },\n\n    remove: function(name, cross_subdomain) {\n        try {\n            _.cookie.set(name, '', -1, cross_subdomain);\n        } catch(err) { return }\n    }\n};\n\n// _.localStorage\nvar _localStorage_supported = null;\n_.localStorage = {\n    is_supported: function() {\n        if (_localStorage_supported !== null) {\n            return _localStorage_supported;\n        }\n\n        var supported = true;\n        try {\n            var key = '__mplssupport__',\n                val = 'xyz';\n            _.localStorage.set(key, val);\n            if (_.localStorage.get(key) !== val) {\n                supported = false;\n            }\n            _.localStorage.remove(key);\n        } catch (err) {\n            supported = false;\n        }\n        if (!supported) {\n            console.error('localStorage unsupported; falling back to cookie store');\n        }\n\n        _localStorage_supported = supported;\n        return supported;\n    },\n\n    error: function(msg) {\n        console.error('localStorage error: ' + msg);\n    },\n\n    get: function(name) {\n        try {\n            return window.localStorage.getItem(name);\n        } catch (err) {\n            _.localStorage.error(err);\n        }\n        return null;\n    },\n\n    parse: function(name) {\n        try {\n            return _.JSONDecode(_.localStorage.get(name)) || {};\n        } catch (err) {\n            // noop\n        }\n        return null;\n    },\n\n    set: function(name, value) {\n        try {\n            window.localStorage.setItem(name, value);\n        } catch (err) {\n            _.localStorage.error(err);\n        }\n    },\n\n    remove: function(name) {\n        try {\n            window.localStorage.removeItem(name);\n        } catch (err) {\n            _.localStorage.error(err);\n        }\n    }\n};\n\n_.register_event = (function() {\n    // written by Dean Edwards, 2005\n    // with input from Tino Zijdel - crisp@xs4all.nl\n    // with input from Carl Sverre - mail@carlsverre.com\n    // with input from PostHog\n    // http://dean.edwards.name/weblog/2005/10/add-event/\n    // https://gist.github.com/1930440\n\n    /**\n     * @param {Object} element\n     * @param {string} type\n     * @param {function(...*)} handler\n     * @param {boolean=} oldSchool\n     * @param {boolean=} useCapture\n     */\n    var register_event = function(element, type, handler, oldSchool, useCapture) {\n        if (!element) {\n            console.error('No valid element provided to register_event');\n            return;\n        }\n\n        if (element.addEventListener && !oldSchool) {\n            element.addEventListener(type, handler, !!useCapture);\n        } else {\n            var ontype = 'on' + type;\n            var old_handler = element[ontype]; // can be undefined\n            element[ontype] = makeHandler(element, handler, old_handler);\n        }\n    };\n\n    function makeHandler(element, new_handler, old_handlers) {\n        var handler = function(event) {\n            event = event || fixEvent(window.event);\n\n            // this basically happens in firefox whenever another script\n            // overwrites the onload callback and doesn't pass the event\n            // object to previously defined callbacks.  All the browsers\n            // that don't define window.event implement addEventListener\n            // so the dom_loaded handler will still be fired as usual.\n            if (!event) {\n                return undefined;\n            }\n\n            var ret = true;\n            var old_result, new_result;\n\n            if (_.isFunction(old_handlers)) {\n                old_result = old_handlers(event);\n            }\n            new_result = new_handler.call(element, event);\n\n            if ((false === old_result) || (false === new_result)) {\n                ret = false;\n            }\n\n            return ret;\n        };\n\n        return handler;\n    }\n\n    function fixEvent(event) {\n        if (event) {\n            event.preventDefault = fixEvent.preventDefault;\n            event.stopPropagation = fixEvent.stopPropagation;\n        }\n        return event;\n    }\n    fixEvent.preventDefault = function() {\n        this.returnValue = false;\n    };\n    fixEvent.stopPropagation = function() {\n        this.cancelBubble = true;\n    };\n\n    return register_event;\n})();\n\n\nvar TOKEN_MATCH_REGEX = new RegExp('^(\\\\w*)\\\\[(\\\\w+)([=~\\\\|\\\\^\\\\$\\\\*]?)=?\"?([^\\\\]\"]*)\"?\\\\]$');\n\n_.dom_query = (function() {\n    /* document.getElementsBySelector(selector)\n    - returns an array of element objects from the current document\n    matching the CSS selector. Selectors can contain element names,\n    class names and ids and can be nested. For example:\n\n    elements = document.getElementsBySelector('div#main p a.external')\n\n    Will return an array of all 'a' elements with 'external' in their\n    class attribute that are contained inside 'p' elements that are\n    contained inside the 'div' element which has id=\"main\"\n\n    New in version 0.4: Support for CSS2 and CSS3 attribute selectors:\n    See http://www.w3.org/TR/css3-selectors/#attribute-selectors\n\n    Version 0.4 - Simon Willison, March 25th 2003\n    -- Works in Phoenix 0.5, Mozilla 1.3, Opera 7, Internet Explorer 6, Internet Explorer 5 on Windows\n    -- Opera 7 fails\n\n    Version 0.5 - Carl Sverre, Jan 7th 2013\n    -- Now uses jQuery-esque `hasClass` for testing class name\n    equality.  This fixes a bug related to '-' characters being\n    considered not part of a 'word' in regex.\n    */\n\n    function getAllChildren(e) {\n        // Returns all children of element. Workaround required for IE5/Windows. Ugh.\n        return e.all ? e.all : e.getElementsByTagName('*');\n    }\n\n    var bad_whitespace = /[\\t\\r\\n]/g;\n\n    function hasClass(elem, selector) {\n        var className = ' ' + selector + ' ';\n        return ((' ' + elem.className + ' ').replace(bad_whitespace, ' ').indexOf(className) >= 0);\n    }\n\n    function getElementsBySelector(selector) {\n        // Attempt to fail gracefully in lesser browsers\n        if (!document.getElementsByTagName) {\n            return [];\n        }\n        // Split selector in to tokens\n        var tokens = selector.split(' ');\n        var token, bits, tagName, found, foundCount, i, j, k, elements, currentContextIndex;\n        var currentContext = [document];\n        for (i = 0; i < tokens.length; i++) {\n            token = tokens[i].replace(/^\\s+/, '').replace(/\\s+$/, '');\n            if (token.indexOf('#') > -1) {\n                // Token is an ID selector\n                bits = token.split('#');\n                tagName = bits[0];\n                var id = bits[1];\n                var element = document.getElementById(id);\n                if (!element || (tagName && element.nodeName.toLowerCase() != tagName)) {\n                    // element not found or tag with that ID not found, return false\n                    return [];\n                }\n                // Set currentContext to contain just this element\n                currentContext = [element];\n                continue; // Skip to next token\n            }\n            if (token.indexOf('.') > -1) {\n                // Token contains a class selector\n                bits = token.split('.');\n                tagName = bits[0];\n                var className = bits[1];\n                if (!tagName) {\n                    tagName = '*';\n                }\n                // Get elements matching tag, filter them for class selector\n                found = [];\n                foundCount = 0;\n                for (j = 0; j < currentContext.length; j++) {\n                    if (tagName == '*') {\n                        elements = getAllChildren(currentContext[j]);\n                    } else {\n                        elements = currentContext[j].getElementsByTagName(tagName);\n                    }\n                    for (k = 0; k < elements.length; k++) {\n                        found[foundCount++] = elements[k];\n                    }\n                }\n                currentContext = [];\n                currentContextIndex = 0;\n                for (j = 0; j < found.length; j++) {\n                    if (found[j].className &&\n                        _.isString(found[j].className) && // some SVG elements have classNames which are not strings\n                        hasClass(found[j], className)\n                    ) {\n                        currentContext[currentContextIndex++] = found[j];\n                    }\n                }\n                continue; // Skip to next token\n            }\n            // Code to deal with attribute selectors\n            var token_match = token.match(TOKEN_MATCH_REGEX);\n            if (token_match) {\n                tagName = token_match[1];\n                var attrName = token_match[2];\n                var attrOperator = token_match[3];\n                var attrValue = token_match[4];\n                if (!tagName) {\n                    tagName = '*';\n                }\n                // Grab all of the tagName elements within current context\n                found = [];\n                foundCount = 0;\n                for (j = 0; j < currentContext.length; j++) {\n                    if (tagName == '*') {\n                        elements = getAllChildren(currentContext[j]);\n                    } else {\n                        elements = currentContext[j].getElementsByTagName(tagName);\n                    }\n                    for (k = 0; k < elements.length; k++) {\n                        found[foundCount++] = elements[k];\n                    }\n                }\n                currentContext = [];\n                currentContextIndex = 0;\n                var checkFunction; // This function will be used to filter the elements\n                switch (attrOperator) {\n                    case '=': // Equality\n                        checkFunction = function(e) {\n                            return (e.getAttribute(attrName) == attrValue);\n                        };\n                        break;\n                    case '~': // Match one of space seperated words\n                        checkFunction = function(e) {\n                            return (e.getAttribute(attrName).match(new RegExp('\\\\b' + attrValue + '\\\\b')));\n                        };\n                        break;\n                    case '|': // Match start with value followed by optional hyphen\n                        checkFunction = function(e) {\n                            return (e.getAttribute(attrName).match(new RegExp('^' + attrValue + '-?')));\n                        };\n                        break;\n                    case '^': // Match starts with value\n                        checkFunction = function(e) {\n                            return (e.getAttribute(attrName).indexOf(attrValue) === 0);\n                        };\n                        break;\n                    case '$': // Match ends with value - fails with \"Warning\" in Opera 7\n                        checkFunction = function(e) {\n                            return (e.getAttribute(attrName).lastIndexOf(attrValue) == e.getAttribute(attrName).length - attrValue.length);\n                        };\n                        break;\n                    case '*': // Match ends with value\n                        checkFunction = function(e) {\n                            return (e.getAttribute(attrName).indexOf(attrValue) > -1);\n                        };\n                        break;\n                    default:\n                        // Just test for existence of attribute\n                        checkFunction = function(e) {\n                            return e.getAttribute(attrName);\n                        };\n                }\n                currentContext = [];\n                currentContextIndex = 0;\n                for (j = 0; j < found.length; j++) {\n                    if (checkFunction(found[j])) {\n                        currentContext[currentContextIndex++] = found[j];\n                    }\n                }\n                // alert('Attribute Selector: '+tagName+' '+attrName+' '+attrOperator+' '+attrValue);\n                continue; // Skip to next token\n            }\n            // If we get here, token is JUST an element (not a class or ID selector)\n            tagName = token;\n            found = [];\n            foundCount = 0;\n            for (j = 0; j < currentContext.length; j++) {\n                elements = currentContext[j].getElementsByTagName(tagName);\n                for (k = 0; k < elements.length; k++) {\n                    found[foundCount++] = elements[k];\n                }\n            }\n            currentContext = found;\n        }\n        return currentContext;\n    }\n\n    return function(query) {\n        if (_.isElement(query)) {\n            return [query];\n        } else if (_.isObject(query) && !_.isUndefined(query.length)) {\n            return query;\n        } else {\n            return getElementsBySelector.call(this, query);\n        }\n    };\n})();\n\n_.info = {\n    campaignParams: function() {\n        var campaign_keywords = 'utm_source utm_medium utm_campaign utm_content utm_term'.split(' '),\n            kw = '',\n            params = {};\n        _.each(campaign_keywords, function(kwkey) {\n            kw = _.getQueryParam(document.URL, kwkey);\n            if (kw.length) {\n                params[kwkey] = kw;\n            }\n        });\n\n        return params;\n    },\n\n    searchEngine: function(referrer) {\n        if (referrer.search('https?://(.*)google.([^/?]*)') === 0) {\n            return 'google';\n        } else if (referrer.search('https?://(.*)bing.com') === 0) {\n            return 'bing';\n        } else if (referrer.search('https?://(.*)yahoo.com') === 0) {\n            return 'yahoo';\n        } else if (referrer.search('https?://(.*)duckduckgo.com') === 0) {\n            return 'duckduckgo';\n        } else {\n            return null;\n        }\n    },\n\n    searchInfo: function(referrer) {\n        var search = _.info.searchEngine(referrer),\n            param = (search != 'yahoo') ? 'q' : 'p',\n            ret = {};\n\n        if (search !== null) {\n            ret['$search_engine'] = search;\n\n            var keyword = _.getQueryParam(referrer, param);\n            if (keyword.length) {\n                ret['ph_keyword'] = keyword;\n            }\n        }\n\n        return ret;\n    },\n\n    /**\n     * This function detects which browser is running this script.\n     * The order of the checks are important since many user agents\n     * include key words used in later checks.\n     */\n    browser: function(user_agent, vendor, opera) {\n        vendor = vendor || ''; // vendor is undefined for at least IE9\n        if (opera || _.includes(user_agent, ' OPR/')) {\n            if (_.includes(user_agent, 'Mini')) {\n                return 'Opera Mini';\n            }\n            return 'Opera';\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n            return 'BlackBerry';\n        } else if (_.includes(user_agent, 'IEMobile') || _.includes(user_agent, 'WPDesktop')) {\n            return 'Internet Explorer Mobile';\n        } else if (_.includes(user_agent, 'SamsungBrowser/')) {\n            // https://developer.samsung.com/internet/user-agent-string-format\n            return 'Samsung Internet';\n        } else if (_.includes(user_agent, 'Edge') || _.includes(user_agent, 'Edg/')) {\n            return 'Microsoft Edge';\n        } else if (_.includes(user_agent, 'FBIOS')) {\n            return 'Facebook Mobile';\n        } else if (_.includes(user_agent, 'Chrome')) {\n            return 'Chrome';\n        } else if (_.includes(user_agent, 'CriOS')) {\n            return 'Chrome iOS';\n        } else if (_.includes(user_agent, 'UCWEB') || _.includes(user_agent, 'UCBrowser')) {\n            return 'UC Browser';\n        } else if (_.includes(user_agent, 'FxiOS')) {\n            return 'Firefox iOS';\n        } else if (_.includes(vendor, 'Apple')) {\n            if (_.includes(user_agent, 'Mobile')) {\n                return 'Mobile Safari';\n            }\n            return 'Safari';\n        } else if (_.includes(user_agent, 'Android')) {\n            return 'Android Mobile';\n        } else if (_.includes(user_agent, 'Konqueror')) {\n            return 'Konqueror';\n        } else if (_.includes(user_agent, 'Firefox')) {\n            return 'Firefox';\n        } else if (_.includes(user_agent, 'MSIE') || _.includes(user_agent, 'Trident/')) {\n            return 'Internet Explorer';\n        } else if (_.includes(user_agent, 'Gecko')) {\n            return 'Mozilla';\n        } else {\n            return '';\n        }\n    },\n\n    /**\n     * This function detects which browser version is running this script,\n     * parsing major and minor version (e.g., 42.1). User agent strings from:\n     * http://www.useragentstring.com/pages/useragentstring.php\n     */\n    browserVersion: function(userAgent, vendor, opera) {\n        var browser = _.info.browser(userAgent, vendor, opera);\n        var versionRegexs = {\n            'Internet Explorer Mobile': /rv:(\\d+(\\.\\d+)?)/,\n            'Microsoft Edge': /Edge?\\/(\\d+(\\.\\d+)?)/,\n            'Chrome': /Chrome\\/(\\d+(\\.\\d+)?)/,\n            'Chrome iOS': /CriOS\\/(\\d+(\\.\\d+)?)/,\n            'UC Browser' : /(UCBrowser|UCWEB)\\/(\\d+(\\.\\d+)?)/,\n            'Safari': /Version\\/(\\d+(\\.\\d+)?)/,\n            'Mobile Safari': /Version\\/(\\d+(\\.\\d+)?)/,\n            'Opera': /(Opera|OPR)\\/(\\d+(\\.\\d+)?)/,\n            'Firefox': /Firefox\\/(\\d+(\\.\\d+)?)/,\n            'Firefox iOS': /FxiOS\\/(\\d+(\\.\\d+)?)/,\n            'Konqueror': /Konqueror:(\\d+(\\.\\d+)?)/,\n            'BlackBerry': /BlackBerry (\\d+(\\.\\d+)?)/,\n            'Android Mobile': /android\\s(\\d+(\\.\\d+)?)/,\n            'Samsung Internet': /SamsungBrowser\\/(\\d+(\\.\\d+)?)/,\n            'Internet Explorer': /(rv:|MSIE )(\\d+(\\.\\d+)?)/,\n            'Mozilla': /rv:(\\d+(\\.\\d+)?)/\n        };\n        var regex = versionRegexs[browser];\n        if (regex === undefined) {\n            return null;\n        }\n        var matches = userAgent.match(regex);\n        if (!matches) {\n            return null;\n        }\n        return parseFloat(matches[matches.length - 2]);\n    },\n\n    os: function() {\n        var a = userAgent;\n        if (/Windows/i.test(a)) {\n            if (/Phone/.test(a) || /WPDesktop/.test(a)) {\n                return 'Windows Phone';\n            }\n            return 'Windows';\n        } else if (/(iPhone|iPad|iPod)/.test(a)) {\n            return 'iOS';\n        } else if (/Android/.test(a)) {\n            return 'Android';\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(a)) {\n            return 'BlackBerry';\n        } else if (/Mac/i.test(a)) {\n            return 'Mac OS X';\n        } else if (/Linux/.test(a)) {\n            return 'Linux';\n        } else if (/CrOS/.test(a)) {\n            return 'Chrome OS';\n        } else {\n            return '';\n        }\n    },\n\n    device: function(user_agent) {\n        if (/Windows Phone/i.test(user_agent) || /WPDesktop/.test(user_agent)) {\n            return 'Windows Phone';\n        } else if (/iPad/.test(user_agent)) {\n            return 'iPad';\n        } else if (/iPod/.test(user_agent)) {\n            return 'iPod Touch';\n        } else if (/iPhone/.test(user_agent)) {\n            return 'iPhone';\n        } else if (/(BlackBerry|PlayBook|BB10)/i.test(user_agent)) {\n            return 'BlackBerry';\n        } else if (/Android/.test(user_agent)) {\n            return 'Android';\n        } else {\n            return '';\n        }\n    },\n\n    referringDomain: function(referrer) {\n        var split = referrer.split('/');\n        if (split.length >= 3) {\n            return split[2];\n        }\n        return '';\n    },\n\n    properties: function() {\n        return _.extend(_.strip_empty_properties({\n            '$os': _.info.os(),\n            '$browser': _.info.browser(userAgent, navigator.vendor, windowOpera),\n            '$referrer': document.referrer,\n            '$referring_domain': _.info.referringDomain(document.referrer),\n            '$device': _.info.device(userAgent)\n        }), {\n            '$current_url': win.location.href,\n            '$browser_version': _.info.browserVersion(userAgent, navigator.vendor, windowOpera),\n            '$screen_height': screen.height,\n            '$screen_width': screen.width,\n            '$lib': 'web',\n            '$lib_version': Config.LIB_VERSION,\n            '$insert_id': Math.random().toString(36).substring(2, 10) + Math.random().toString(36).substring(2, 10),\n            '$time': _.timestamp() / 1000 // epoch time in seconds\n        });\n    },\n\n    people_properties: function() {\n        return _.extend(_.strip_empty_properties({\n            '$os': _.info.os(),\n            '$browser': _.info.browser(userAgent, navigator.vendor, windowOpera)\n        }), {\n            '$browser_version': _.info.browserVersion(userAgent, navigator.vendor, windowOpera)\n        });\n    }\n};\n\n// EXPORTS (for closure compiler)\n_['toArray']                = _.toArray;\n_['isObject']               = _.isObject;\n_['JSONEncode']             = _.JSONEncode;\n_['JSONDecode']             = _.JSONDecode;\n_['isBlockedUA']            = _.isBlockedUA;\n_['isEmptyObject']          = _.isEmptyObject;\n_['info']                   = _.info;\n_['info']['device']         = _.info.device;\n_['info']['browser']        = _.info.browser;\n_['info']['browserVersion'] = _.info.browserVersion;\n_['info']['properties']     = _.info.properties;\n\nexport { _, userAgent, console, win as window, document, navigator };\n","import { _ } from './utils';\n\n/*\n * Get the className of an element, accounting for edge cases where element.className is an object\n * @param {Element} el - element to get the className of\n * @returns {string} the element's class\n */\nexport function getClassName(el) {\n    switch(typeof el.className) {\n        case 'string':\n            return el.className;\n        case 'object': // handle cases where className might be SVGAnimatedString or some other type\n            return el.className.baseVal || el.getAttribute('class') || '';\n        default: // future proof\n            return '';\n    }\n}\n\n/*\n * Get the direct text content of an element, protecting against sensitive data collection.\n * Concats textContent of each of the element's text node children; this avoids potential\n * collection of sensitive data that could happen if we used element.textContent and the\n * element had sensitive child elements, since element.textContent includes child content.\n * Scrubs values that look like they could be sensitive (i.e. cc or ssn number).\n * @param {Element} el - element to get the text of\n * @returns {string} the element's direct text content\n */\nexport function getSafeText(el) {\n    var elText = '';\n\n    if (shouldCaptureElement(el) && el.childNodes && el.childNodes.length) {\n        _.each(el.childNodes, function(child) {\n            if (isTextNode(child) && child.textContent) {\n                elText += _.trim(child.textContent)\n                    // scrub potentially sensitive values\n                    .split(/(\\s+)/).filter(shouldCaptureValue).join('')\n                    // normalize whitespace\n                    .replace(/[\\r\\n]/g, ' ').replace(/[ ]+/g, ' ')\n                    // truncate\n                    .substring(0, 255);\n            }\n        });\n    }\n\n    return _.trim(elText);\n}\n\n/*\n * Check whether an element has nodeType Node.ELEMENT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\nexport function isElementNode(el) {\n    return el && el.nodeType === 1; // Node.ELEMENT_NODE - use integer constant for browser portability\n}\n\n/*\n * Check whether an element is of a given tag type.\n * Due to potential reference discrepancies (such as the webcomponents.js polyfill),\n * we want to match tagNames instead of specific references because something like\n * element === document.body won't always work because element might not be a native\n * element.\n * @param {Element} el - element to check\n * @param {string} tag - tag name (e.g., \"div\")\n * @returns {boolean} whether el is of the given tag type\n */\nexport function isTag(el, tag) {\n    return el && el.tagName && el.tagName.toLowerCase() === tag.toLowerCase();\n}\n\n/*\n * Check whether an element has nodeType Node.TEXT_NODE\n * @param {Element} el - element to check\n * @returns {boolean} whether el is of the correct nodeType\n */\nexport function isTextNode(el) {\n    return el && el.nodeType === 3; // Node.TEXT_NODE - use integer constant for browser portability\n}\n\nexport var usefulElements = ['a', 'button', 'form', 'input', 'select', 'textarea', 'label'];\n/*\n * Check whether a DOM event should be \"captureed\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {Element} el - element to check\n * @param {Event} event - event to check\n * @returns {boolean} whether the event should be captureed\n */\nexport function shouldCaptureDomEvent(el, event) {\n    if (!el || isTag(el, 'html') || !isElementNode(el)) {\n        return false;\n    }\n\n    var parentIsUsefulElement = false;\n    var targetElementList = [el];\n    var curEl = el;\n    while (curEl.parentNode && !isTag(curEl, 'body')) {\n        if(usefulElements.indexOf(curEl.parentNode.tagName.toLowerCase()) > -1) parentIsUsefulElement = true;\n        targetElementList.push(curEl.parentNode);\n        curEl = curEl.parentNode;\n    }\n    var tag = el.tagName.toLowerCase();\n    switch (tag) {\n        case 'html':\n            return false;\n        case 'form':\n            return event.type === 'submit';\n        case 'input':\n            return event.type === 'change' || event.type === 'click';\n        case 'select':\n        case 'textarea':\n            return event.type === 'change' || event.type === 'click';\n        default:\n            if(parentIsUsefulElement) return event.type == 'click';\n            return event.type === 'click' && (usefulElements.indexOf(tag) > -1 || el.getAttribute('contenteditable') === 'true');\n    }\n}\n\n/*\n * Check whether a DOM element should be \"captureed\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {Element} el - element to check\n * @returns {boolean} whether the element should be captureed\n */\nexport function shouldCaptureElement(el) {\n    for (var curEl = el; curEl.parentNode && !isTag(curEl, 'body'); curEl = curEl.parentNode) {\n        var classes = getClassName(curEl).split(' ');\n        if (_.includes(classes, 'ph-sensitive') || _.includes(classes, 'ph-no-capture')) {\n            return false;\n        }\n    }\n\n    if (_.includes(getClassName(el).split(' '), 'ph-include')) {\n        return true;\n    }\n\n    // don't send data from inputs or similar elements since there will always be\n    // a risk of clientside javascript placing sensitive data in attributes\n    if (\n        (isTag(el, 'input') && el.type != 'button') ||\n        isTag(el, 'select') ||\n        isTag(el, 'textarea') ||\n        el.getAttribute('contenteditable') === 'true'\n    ) {\n        return false;\n    }\n\n    // don't include hidden or password fields\n    var type = el.type || '';\n    if (typeof type === 'string') { // it's possible for el.type to be a DOM element if el is a form with a child input[name=\"type\"]\n        switch(type.toLowerCase()) {\n            case 'hidden':\n                return false;\n            case 'password':\n                return false;\n        }\n    }\n\n    // filter out data from fields that look like sensitive fields\n    var name = el.name || el.id || '';\n    if (typeof name === 'string') { // it's possible for el.name or el.id to be a DOM element if el is a form with a child input[name=\"name\"]\n        var sensitiveNameRegex = /^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i;\n        if (sensitiveNameRegex.test(name.replace(/[^a-zA-Z0-9]/g, ''))) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\n/*\n * Check whether a string value should be \"captureed\" or if it may contain sentitive data\n * using a variety of heuristics.\n * @param {string} value - string value to check\n * @returns {boolean} whether the element should be captureed\n */\nexport function shouldCaptureValue(value) {\n    if (value === null || _.isUndefined(value)) {\n        return false;\n    }\n\n    if (typeof value === 'string') {\n        value = _.trim(value);\n\n        // check to see if input value looks like a credit card number\n        // see: https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html\n        var ccRegex = /^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/;\n        if (ccRegex.test((value || '').replace(/[- ]/g, ''))) {\n            return false;\n        }\n\n        // check to see if input value looks like a social security number\n        var ssnRegex = /(^\\d{3}-?\\d{2}-?\\d{4}$)/;\n        if (ssnRegex.test(value)) {\n            return false;\n        }\n    }\n\n    return true;\n}\n","import { _ } from './utils';\nimport {\n    getClassName,\n    getSafeText,\n    isElementNode,\n    isTag,\n    isTextNode,\n    shouldCaptureDomEvent,\n    shouldCaptureElement,\n    shouldCaptureValue,\n    usefulElements\n} from './autocapture-utils';\n\nvar autocapture = {\n    _initializedTokens: [],\n\n    _previousElementSibling: function(el) {\n        if (el.previousElementSibling) {\n            return el.previousElementSibling;\n        } else {\n            do {\n                el = el.previousSibling;\n            } while (el && !isElementNode(el));\n            return el;\n        }\n    },\n\n    _loadScript: function(scriptUrlToLoad, callback) {\n        var scriptTag = document.createElement('script');\n        scriptTag.type = 'text/javascript';\n        scriptTag.src = scriptUrlToLoad;\n        scriptTag.onload = callback;\n\n        var scripts = document.getElementsByTagName('script');\n        if (scripts.length > 0) {\n            scripts[0].parentNode.insertBefore(scriptTag, scripts[0]);\n        } else {\n            document.body.appendChild(scriptTag);\n        }\n    },\n\n    _getPropertiesFromElement: function(elem) {\n        var tag_name = elem.tagName.toLowerCase();\n        var props = {\n            'tag_name': tag_name\n        };\n        if(usefulElements.indexOf(tag_name) > -1) props['$el_text'] = getSafeText(elem);\n\n        var classes = getClassName(elem);\n        if(classes.length > 0) props['classes'] = classes.split(' ');\n\n        if (shouldCaptureElement(elem)) {\n            _.each(elem.attributes, function(attr) {\n                if (shouldCaptureValue(attr.value)) {\n                    props['attr__' + attr.name] = attr.value;\n                }\n            });\n        }\n\n        var nthChild = 1;\n        var nthOfType = 1;\n        var currentElem = elem;\n        while (currentElem = this._previousElementSibling(currentElem)) { // eslint-disable-line no-cond-assign\n            nthChild++;\n            if (currentElem.tagName === elem.tagName) {\n                nthOfType++;\n            }\n        }\n        props['nth_child'] = nthChild;\n        props['nth_of_type'] = nthOfType;\n\n        return props;\n    },\n\n    _getDefaultProperties: function(eventType) {\n        return {\n            '$event_type': eventType,\n            '$ce_version': 1,\n            '$host': window.location.host,\n            '$pathname': window.location.pathname\n        };\n    },\n\n    _extractCustomPropertyValue: function(customProperty) {\n        var propValues = [];\n        _.each(document.querySelectorAll(customProperty['css_selector']), function(matchedElem) {\n            var value;\n\n            if (['input', 'select'].indexOf(matchedElem.tagName.toLowerCase()) > -1) {\n                value = matchedElem['value'];\n            } else if (matchedElem['textContent']) {\n                value = matchedElem['textContent'];\n            }\n\n            if (shouldCaptureValue(value)) {\n                propValues.push(value);\n            }\n        });\n        return propValues.join(', ');\n    },\n\n    _getCustomProperties: function(targetElementList) {\n        var props = {};\n        _.each(this._customProperties, function(customProperty) {\n            _.each(customProperty['event_selectors'], function(eventSelector) {\n                var eventElements = document.querySelectorAll(eventSelector);\n                _.each(eventElements, function(eventElement) {\n                    if (_.includes(targetElementList, eventElement) && shouldCaptureElement(eventElement)) {\n                        props[customProperty['name']] = this._extractCustomPropertyValue(customProperty);\n                    }\n                }, this);\n            }, this);\n        }, this);\n        return props;\n    },\n\n    _getEventTarget: function(e) {\n        // https://developer.mozilla.org/en-US/docs/Web/API/Event/target#Compatibility_notes\n        if (typeof e.target === 'undefined') {\n            return e.srcElement;\n        } else {\n            return e.target;\n        }\n    },\n\n    _captureEvent: function(e, instance) {\n        /*** Don't mess with this code without running IE8 tests on it ***/\n        var target = this._getEventTarget(e);\n        if (isTextNode(target)) { // defeat Safari bug (see: http://www.quirksmode.org/js/events_properties.html)\n            target = target.parentNode;\n        }\n\n        if (shouldCaptureDomEvent(target, e)) {\n            var targetElementList = [target];\n            var curEl = target;\n            while (curEl.parentNode && !isTag(curEl, 'body')) {\n                targetElementList.push(curEl.parentNode);\n                curEl = curEl.parentNode;\n            }\n\n            var elementsJson = [];\n            var href, explicitNoCapture = false;\n            _.each(targetElementList, function(el) {\n                var shouldCaptureEl = shouldCaptureElement(el);\n\n                // if the element or a parent element is an anchor tag\n                // include the href as a property\n                if (el.tagName.toLowerCase() === 'a') {\n                    href = el.getAttribute('href');\n                    href = shouldCaptureEl && shouldCaptureValue(href) && href;\n                }\n\n                // allow users to programatically prevent captureing of elements by adding class 'ph-no-capture'\n                var classes = getClassName(el).split(' ');\n                if (_.includes(classes, 'ph-no-capture')) {\n                    explicitNoCapture = true;\n                }\n\n                elementsJson.push(this._getPropertiesFromElement(el));\n            }, this);\n\n            elementsJson[0]['$el_text'] = getSafeText(target);\n\n            if (explicitNoCapture) {\n                return false;\n            }\n\n            // only populate text content from target element (not parents)\n            // to prevent text within a sensitive element from being collected\n            // as part of a parent's el.textContent\n            var elementText;\n            var safeElementText = getSafeText(target);\n            if (safeElementText && safeElementText.length) {\n                elementText = safeElementText;\n            }\n\n            var props = _.extend(\n                this._getDefaultProperties(e.type),\n                {\n                    '$elements':  elementsJson\n                },\n                this._getCustomProperties(targetElementList)\n            );\n\n            instance.capture('$autocapture', props);\n            return true;\n        }\n    },\n\n    // only reason is to stub for unit tests\n    // since you can't override window.location props\n    _navigate: function(href) {\n        window.location.href = href;\n    },\n\n    _addDomEventHandlers: function(instance) {\n        var handler = _.bind(function(e) {\n            e = e || window.event;\n            this._captureEvent(e, instance);\n        }, this);\n        _.register_event(document, 'submit', handler, false, true);\n        _.register_event(document, 'change', handler, false, true);\n        _.register_event(document, 'click', handler, false, true);\n    },\n\n    _customProperties: {},\n    init: function(instance) {\n        if (!(document && document.body)) {\n            console.log('document not ready yet, trying again in 500 milliseconds...');\n            var that = this;\n            setTimeout(function() { that.init(instance); }, 500);\n            return;\n        }\n\n        var token = instance.get_config('token');\n        if (this._initializedTokens.indexOf(token) > -1) {\n            console.log('autocapture already initialized for token \"' + token + '\"');\n            return;\n        }\n        this._initializedTokens.push(token);\n\n        if (!this._maybeLoadEditor(instance)) { // don't autocapture actions when the editor is enabled\n            var parseDecideResponse = _.bind(function(response) {\n                if (response && response['config'] && response['config']['enable_collect_everything'] === true) {\n\n                    if (response['custom_properties']) {\n                        this._customProperties = response['custom_properties'];\n                    }\n\n                    this._addDomEventHandlers(instance);\n\n                } else {\n                    instance['__autocapture_enabled'] = false;\n                }\n            }, this);\n\n            instance._send_request(\n                instance.get_config('api_host') + '/decide/', {\n                    'verbose': true,\n                    'version': '1',\n                    'lib': 'web',\n                    'token': token\n                },\n                {method: 'GET'},\n                instance._prepare_callback(parseDecideResponse)\n            );\n        }\n    },\n\n    _editorParamsFromHash: function(instance, hash) {\n        var editorParams;\n        try {\n            var state = _.getHashParam(hash, 'state');\n            state = JSON.parse(decodeURIComponent(state));\n            var expiresInSeconds = _.getHashParam(hash, 'expires_in');\n            editorParams = {\n                'accessToken': _.getHashParam(hash, 'access_token'),\n                'accessTokenExpiresAt': (new Date()).getTime() + (Number(expiresInSeconds) * 1000),\n                'actionId': state['actionId'],\n                'projectToken': state['token'],\n                'apiURL': state['apiURL'],\n                'temporaryToken': state['temporaryToken']\n            };\n            window.sessionStorage.setItem('editorParams', JSON.stringify(editorParams));\n            window.sessionStorage.setItem('editorActionId', editorParams['actionId']);\n\n            if (state['desiredHash']) {\n                window.location.hash = state['desiredHash'];\n            } else if (window.history) {\n                history.replaceState('', document.title, window.location.pathname + window.location.search); // completely remove hash\n            } else {\n                window.location.hash = ''; // clear hash (but leaves # unfortunately)\n            }\n        } catch (e) {\n            console.error('Unable to parse data from hash', e);\n        }\n        return editorParams;\n    },\n\n    /**\n     * To load the visual editor, we need an access token and other state. That state comes from one of three places:\n     * 1. In the URL hash params if the customer is using an old snippet\n     * 2. From session storage under the key `_mpcehash` if the snippet already parsed the hash\n     * 3. From session storage under the key `editorParams` if the editor was initialized on a previous page\n     */\n    _maybeLoadEditor: function(instance) {\n        try {\n            var parseFromUrl = false;\n            if (_.getHashParam(window.location.hash, 'state')) {\n                var state = _.getHashParam(window.location.hash, 'state');\n                state = JSON.parse(decodeURIComponent(state));\n                parseFromUrl = state['action'] === 'mpeditor';\n            }\n            var parseFromStorage = !!window.sessionStorage.getItem('_mpcehash');\n            var editorParams;\n\n            if (parseFromUrl) { // happens if they are initializing the editor using an old snippet\n                editorParams = this._editorParamsFromHash(instance, window.location.hash);\n            } else if (parseFromStorage) { // happens if they are initialized the editor and using the new snippet\n                editorParams = this._editorParamsFromHash(instance, window.sessionStorage.getItem('_mpcehash'));\n                window.sessionStorage.removeItem('_mpcehash');\n            } else { // get credentials from sessionStorage from a previous initialzation\n                editorParams = JSON.parse(window.sessionStorage.getItem('editorParams') || '{}');\n            }\n\n            if (editorParams['projectToken'] && instance.get_config('token') === editorParams['projectToken']) {\n                this._loadEditor(instance, editorParams);\n                return true;\n            } else {\n                return false;\n            }\n        } catch (e) {\n            return false;\n        }\n    },\n\n    _loadEditor: function(instance, editorParams) {\n        if (!window['_mpEditorLoaded']) { // only load the codeless event editor once, even if there are multiple instances of PostHogLib\n            window['_mpEditorLoaded'] = true;\n            var editorUrl = instance.get_config('api_host')\n              + '/static/editor.js?_ts='\n              + (new Date()).getTime();\n            this._loadScript(editorUrl, function() {\n                window['ph_load_editor'](editorParams);\n            });\n            return true;\n        }\n        return false;\n    },\n\n    // this is a mechanism to ramp up CE with no server-side interaction.\n    // when CE is active, every page load results in a decide request. we\n    // need to gently ramp this up so we don't overload decide. this decides\n    // deterministically if CE is enabled for this project by modding the char\n    // value of the project token.\n    enabledForProject: function(token, numBuckets, numEnabledBuckets) {\n        numBuckets = !_.isUndefined(numBuckets) ? numBuckets : 10;\n        numEnabledBuckets = !_.isUndefined(numEnabledBuckets) ? numEnabledBuckets : 10;\n        var charCodeSum = 0;\n        for (var i = 0; i < token.length; i++) {\n            charCodeSum += token.charCodeAt(i);\n        }\n        return (charCodeSum % numBuckets) < numEnabledBuckets;\n    },\n\n    isBrowserSupported: function() {\n        return _.isFunction(document.querySelectorAll);\n    }\n};\n\n_.bind_instance_methods(autocapture);\n_.safewrap_instance_methods(autocapture);\n\nexport { autocapture };\n","/* eslint camelcase: \"off\" */\n\nimport { _, console } from './utils';\n\n/**\n * DomCapture Object\n * @constructor\n */\nvar DomCapture = function() {};\n\n\n// interface\nDomCapture.prototype.create_properties = function() {};\nDomCapture.prototype.event_handler = function() {};\nDomCapture.prototype.after_capture_handler = function() {};\n\nDomCapture.prototype.init = function(posthog_instance) {\n    this.mp = posthog_instance;\n    return this;\n};\n\n/**\n * @param {Object|string} query\n * @param {string} event_name\n * @param {Object=} properties\n * @param {function=} user_callback\n */\nDomCapture.prototype.capture = function(query, event_name, properties, user_callback) {\n    var that = this;\n    var elements = _.dom_query(query);\n\n    if (elements.length === 0) {\n        console.error('The DOM query (' + query + ') returned 0 elements');\n        return;\n    }\n\n    _.each(elements, function(element) {\n        _.register_event(element, this.override_event, function(e) {\n            var options = {};\n            var props = that.create_properties(properties, this);\n            var timeout = that.mp.get_config('capture_links_timeout');\n\n            that.event_handler(e, this, options);\n\n            // in case the posthog servers don't get back to us in time\n            window.setTimeout(that.capture_callback(user_callback, props, options, true), timeout);\n\n            // fire the captureing event\n            that.mp.capture(event_name, props, that.capture_callback(user_callback, props, options));\n        });\n    }, this);\n\n    return true;\n};\n\n/**\n * @param {function} user_callback\n * @param {Object} props\n * @param {boolean=} timeout_occured\n */\nDomCapture.prototype.capture_callback = function(user_callback, props, options, timeout_occured) {\n    timeout_occured = timeout_occured || false;\n    var that = this;\n\n    return function() {\n        // options is referenced from both callbacks, so we can have\n        // a 'lock' of sorts to ensure only one fires\n        if (options.callback_fired) { return; }\n        options.callback_fired = true;\n\n        if (user_callback && user_callback(timeout_occured, props) === false) {\n            // user can prevent the default functionality by\n            // returning false from their callback\n            return;\n        }\n\n        that.after_capture_handler(props, options, timeout_occured);\n    };\n};\n\nDomCapture.prototype.create_properties = function(properties, element) {\n    var props;\n\n    if (typeof(properties) === 'function') {\n        props = properties(element);\n    } else {\n        props = _.extend({}, properties);\n    }\n\n    return props;\n};\n\n/**\n * LinkCapture Object\n * @constructor\n * @extends DomCapture\n */\nvar LinkCapture = function() {\n    this.override_event = 'click';\n};\n_.inherit(LinkCapture, DomCapture);\n\nLinkCapture.prototype.create_properties = function(properties, element) {\n    var props = LinkCapture.superclass.create_properties.apply(this, arguments);\n\n    if (element.href) { props['url'] = element.href; }\n\n    return props;\n};\n\nLinkCapture.prototype.event_handler = function(evt, element, options) {\n    options.new_tab = (\n        evt.which === 2 ||\n        evt.metaKey ||\n        evt.ctrlKey ||\n        element.target === '_blank'\n    );\n    options.href = element.href;\n\n    if (!options.new_tab) {\n        evt.preventDefault();\n    }\n};\n\nLinkCapture.prototype.after_capture_handler = function(props, options) {\n    if (options.new_tab) { return; }\n\n    setTimeout(function() {\n        window.location = options.href;\n    }, 0);\n};\n\n/**\n * FormCapture Object\n * @constructor\n * @extends DomCapture\n */\nvar FormCapture = function() {\n    this.override_event = 'submit';\n};\n_.inherit(FormCapture, DomCapture);\n\nFormCapture.prototype.event_handler = function(evt, element, options) {\n    options.element = element;\n    evt.preventDefault();\n};\n\nFormCapture.prototype.after_capture_handler = function(props, options) {\n    setTimeout(function() {\n        options.element.submit();\n    }, 0);\n};\n\n\nexport {\n    FormCapture,\n    LinkCapture\n};\n","/**\n * GDPR utils\n *\n * The General Data Protection Regulation (GDPR) is a regulation in EU law on data protection\n * and privacy for all individuals within the European Union. It addresses the export of personal\n * data outside the EU. The GDPR aims primarily to give control back to citizens and residents\n * over their personal data and to simplify the regulatory environment for international business\n * by unifying the regulation within the EU.\n *\n * This set of utilities is intended to enable opt in/out functionality in the PostHog JS SDK.\n * These functions are used internally by the SDK and are not intended to be publicly exposed.\n */\n\nimport { _, window } from './utils';\n\n/**\n * A function used to capture a PostHog event (e.g. PostHogLib.capture)\n * @callback captureFunction\n * @param {String} event_name The name of the event. This can be anything the user does - 'Button Click', 'Sign Up', 'Item Purchased', etc.\n * @param {Object} [properties] A set of properties to include with the event you're sending. These describe the user who did the event or details about the event itself.\n * @param {Function} [callback] If provided, the callback function will be called after captureing the event.\n */\n\n/** Public **/\n\nvar GDPR_DEFAULT_PERSISTENCE_PREFIX = '__ph_opt_in_out_';\n\n/**\n * Opt the user in to data captureing and cookies/localstorage for the given token\n * @param {string} token - PostHog project captureing token\n * @param {Object} [options]\n * @param {captureFunction} [options.capture] - function used for captureing a PostHog event to record the opt-in action\n * @param {string} [options.captureEventName] - event name to be used for captureing the opt-in action\n * @param {Object} [options.captureProperties] - set of properties to be captureed along with the opt-in action\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nexport function optIn(token, options) {\n    _optInOut(true, token, options);\n}\n\n/**\n * Opt the user out of data captureing and cookies/localstorage for the given token\n * @param {string} token - PostHog project captureing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-out cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-out cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-out cookie is set as secure or not\n */\nexport function optOut(token, options) {\n    _optInOut(false, token, options);\n}\n\n/**\n * Check whether the user has opted in to data captureing and cookies/localstorage for the given token\n * @param {string} token - PostHog project captureing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} whether the user has opted in to the given opt type\n */\nexport function hasOptedIn(token, options) {\n    return _getStorageValue(token, options) === '1';\n}\n\n/**\n * Check whether the user has opted out of data captureing and cookies/localstorage for the given token\n * @param {string} token - PostHog project captureing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} whether the user has opted out of the given opt type\n */\nexport function hasOptedOut(token, options) {\n    if (_hasDoNotCaptureFlagOn(options)) {\n        return true;\n    }\n    return _getStorageValue(token, options) === '0';\n}\n\n/**\n * Wrap a PostHogLib method with a check for whether the user is opted out of data captureing and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\nexport function addOptOutCheckPostHogLib(method) {\n    return _addOptOutCheck(method, function(name) {\n        return this.get_config(name);\n    });\n}\n\n/**\n * Wrap a PostHogPeople method with a check for whether the user is opted out of data captureing and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\nexport function addOptOutCheckPostHogPeople(method) {\n    return _addOptOutCheck(method, function(name) {\n        return this._get_config(name);\n    });\n}\n\n/**\n * Wrap a PostHogGroup method with a check for whether the user is opted out of data captureing and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\nexport function addOptOutCheckPostHogGroup(method) {\n    return _addOptOutCheck(method, function(name) {\n        return this._get_config(name);\n    });\n}\n\n/**\n * Clear the user's opt in/out status of data captureing and cookies/localstorage for the given token\n * @param {string} token - PostHog project captureing token\n * @param {Object} [options]\n * @param {string} [options.persistenceType] Persistence mechanism used - cookie or localStorage\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nexport function clearOptInOut(token, options) {\n    options = options || {};\n    _getStorage(options).remove(_getStorageKey(token, options), !!options.crossSubdomainCookie);\n}\n\n/** Private **/\n\n/**\n * Get storage util\n * @param {Object} [options]\n * @param {string} [options.persistenceType]\n * @returns {object} either _.cookie or _.localstorage\n */\nfunction _getStorage(options) {\n    options = options || {};\n    return options.persistenceType === 'localStorage' ? _.localStorage : _.cookie;\n}\n\n/**\n * Get the name of the cookie that is used for the given opt type (captureing, cookie, etc.)\n * @param {string} token - PostHog project captureing token\n * @param {Object} [options]\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {string} the name of the cookie for the given opt type\n */\nfunction _getStorageKey(token, options) {\n    options = options || {};\n    return (options.persistencePrefix || GDPR_DEFAULT_PERSISTENCE_PREFIX) + token;\n}\n\n/**\n * Get the value of the cookie that is used for the given opt type (captureing, cookie, etc.)\n * @param {string} token - PostHog project captureing token\n * @param {Object} [options]\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @returns {string} the value of the cookie for the given opt type\n */\nfunction _getStorageValue(token, options) {\n    return _getStorage(options).get(_getStorageKey(token, options));\n}\n\n/**\n * Check whether the user has set the DNT/doNotCapture setting to true in their browser\n * @param {Object} [options]\n * @param {string} [options.window] - alternate window object to check; used to force various DNT settings in browser tests\n * @returns {boolean} whether the DNT setting is true\n */\nfunction _hasDoNotCaptureFlagOn(options) {\n    var win = (options && options.window) || window;\n    var nav = win['navigator'] || {};\n    var hasDntOn = false;\n\n    _.each([\n        nav['doNotCapture'], // standard\n        nav['msDoNotCapture'],\n        win['doNotCapture']\n    ], function(dntValue) {\n        if (_.includes([true, 1, '1', 'yes'], dntValue)) {\n            hasDntOn = true;\n        }\n    });\n\n    return hasDntOn;\n}\n\n/**\n * Set cookie/localstorage for the user indicating that they are opted in or out for the given opt type\n * @param {boolean} optValue - whether to opt the user in or out for the given opt type\n * @param {string} token - PostHog project captureing token\n * @param {Object} [options]\n * @param {captureFunction} [options.capture] - function used for captureing a PostHog event to record the opt-in action\n * @param {string} [options.captureEventName] - event name to be used for captureing the opt-in action\n * @param {Object} [options.captureProperties] - set of properties to be captureed along with the opt-in action\n * @param {string} [options.persistencePrefix=__ph_opt_in_out] - custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookieExpiration] - number of days until the opt-in cookie expires\n * @param {boolean} [options.crossSubdomainCookie] - whether the opt-in cookie is set as cross-subdomain or not\n * @param {boolean} [options.secureCookie] - whether the opt-in cookie is set as secure or not\n */\nfunction _optInOut(optValue, token, options) {\n    if (!_.isString(token) || !token.length) {\n        console.error('gdpr.' + (optValue ? 'optIn' : 'optOut') + ' called with an invalid token');\n        return;\n    }\n\n    options = options || {};\n\n    _getStorage(options).set(\n        _getStorageKey(token, options),\n        optValue ? 1 : 0,\n        _.isNumber(options.cookieExpiration) ? options.cookieExpiration : null,\n        !!options.crossSubdomainCookie,\n        !!options.secureCookie\n    );\n\n    if (options.capture && optValue) { // only capture event if opting in (optValue=true)\n        options.capture(options.captureEventName || '$opt_in', options.captureProperties);\n    }\n}\n\n/**\n * Wrap a method with a check for whether the user is opted out of data captureing and cookies/localstorage for the given token\n * If the user has opted out, return early instead of executing the method.\n * If a callback argument was provided, execute it passing the 0 error code.\n * @param {function} method - wrapped method to be executed if the user has not opted out\n * @param {function} getConfigValue - getter function for the PostHog API token and other options to be used with opt-out check\n * @returns {*} the result of executing method OR undefined if the user has opted out\n */\nfunction _addOptOutCheck(method, getConfigValue) {\n    return function() {\n        var optedOut = false;\n\n        try {\n            var token = getConfigValue.call(this, 'token');\n            var persistenceType = getConfigValue.call(this, 'opt_out_captureing_persistence_type');\n            var persistencePrefix = getConfigValue.call(this, 'opt_out_captureing_cookie_prefix');\n            var win = getConfigValue.call(this, 'window'); // used to override window during browser tests\n\n            if (token) { // if there was an issue getting the token, continue method execution as normal\n                optedOut = hasOptedOut(token, {\n                    persistenceType: persistenceType,\n                    persistencePrefix: persistencePrefix,\n                    window: win\n                });\n            }\n        } catch(err) {\n            console.error('Unexpected error when checking captureing opt-out status: ' + err);\n        }\n\n        if (!optedOut) {\n            return method.apply(this, arguments);\n        }\n\n        var callback = arguments[arguments.length - 1];\n        if (typeof(callback) === 'function') {\n            callback(0);\n        }\n\n        return;\n    };\n}\n","/* eslint camelcase: \"off\" */\n\nimport { _ } from './utils';\n\n/** @const */ var SET_ACTION      = '$set';\n/** @const */ var SET_ONCE_ACTION = '$set_once';\n/** @const */ var UNSET_ACTION    = '$unset';\n/** @const */ var ADD_ACTION      = '$add';\n/** @const */ var APPEND_ACTION   = '$append';\n/** @const */ var UNION_ACTION    = '$union';\n/** @const */ var REMOVE_ACTION   = '$remove';\n/** @const */ var DELETE_ACTION   = '$delete';\n\n// Common internal methods for posthog.people and posthog.group APIs.\n// These methods shouldn't involve network I/O.\nvar apiActions = {\n    set_action: function(prop, to) {\n        var data = {};\n        var $set = {};\n        if (_.isObject(prop)) {\n            _.each(prop, function(v, k) {\n                if (!this._is_reserved_property(k)) {\n                    $set[k] = v;\n                }\n            }, this);\n        } else {\n            $set[prop] = to;\n        }\n\n        data[SET_ACTION] = $set;\n        return data;\n    },\n\n    unset_action: function(prop) {\n        var data = {};\n        var $unset = [];\n        if (!_.isArray(prop)) {\n            prop = [prop];\n        }\n\n        _.each(prop, function(k) {\n            if (!this._is_reserved_property(k)) {\n                $unset.push(k);\n            }\n        }, this);\n\n        data[UNSET_ACTION] = $unset;\n        return data;\n    },\n\n    set_once_action: function(prop, to) {\n        var data = {};\n        var $set_once = {};\n        if (_.isObject(prop)) {\n            _.each(prop, function(v, k) {\n                if (!this._is_reserved_property(k)) {\n                    $set_once[k] = v;\n                }\n            }, this);\n        } else {\n            $set_once[prop] = to;\n        }\n        data[SET_ONCE_ACTION] = $set_once;\n        return data;\n    },\n\n    union_action: function(list_name, values) {\n        var data = {};\n        var $union = {};\n        if (_.isObject(list_name)) {\n            _.each(list_name, function(v, k) {\n                if (!this._is_reserved_property(k)) {\n                    $union[k] = _.isArray(v) ? v : [v];\n                }\n            }, this);\n        } else {\n            $union[list_name] = _.isArray(values) ? values : [values];\n        }\n        data[UNION_ACTION] = $union;\n        return data;\n    },\n\n    append_action: function(list_name, value) {\n        var data = {};\n        var $append = {};\n        if (_.isObject(list_name)) {\n            _.each(list_name, function(v, k) {\n                if (!this._is_reserved_property(k)) {\n                    $append[k] = v;\n                }\n            }, this);\n        } else {\n            $append[list_name] = value;\n        }\n        data[APPEND_ACTION] = $append;\n        return data;\n    },\n\n    remove_action: function(list_name, value) {\n        var data = {};\n        var $remove = {};\n        if (_.isObject(list_name)) {\n            _.each(list_name, function(v, k) {\n                if (!this._is_reserved_property(k)) {\n                    $remove[k] = v;\n                }\n            }, this);\n        } else {\n            $remove[list_name] = value;\n        }\n        data[REMOVE_ACTION] = $remove;\n        return data;\n    },\n\n    delete_action: function() {\n        var data = {};\n        data[DELETE_ACTION] = '';\n        return data;\n    }\n};\n\nexport {\n    SET_ACTION,\n    SET_ONCE_ACTION,\n    UNSET_ACTION,\n    ADD_ACTION,\n    APPEND_ACTION,\n    UNION_ACTION,\n    REMOVE_ACTION,\n    DELETE_ACTION,\n    apiActions\n};\n","/* eslint camelcase: \"off\" */\nimport { addOptOutCheckPostHogGroup } from './gdpr-utils';\nimport { apiActions } from './api-actions';\nimport { _, console } from './utils';\n\n/**\n * PostHog Group Object\n * @constructor\n */\nvar PostHogGroup = function() {};\n\n_.extend(PostHogGroup.prototype, apiActions);\n\nPostHogGroup.prototype._init = function(posthog_instance, group_key, group_id) {\n    this._posthog = posthog_instance;\n    this._group_key = group_key;\n    this._group_id = group_id;\n};\n\n/**\n * Set properties on a group.\n *\n * ### Usage:\n *\n *     posthog.get_group('company', 'posthog').set('Location', '405 Howard');\n *\n *     // or set multiple properties at once\n *     posthog.get_group('company', 'posthog').set({\n *          'Location': '405 Howard',\n *          'Founded' : 2009,\n *     });\n *     // properties can be strings, integers, dates, or lists\n *\n * @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n * @param {*} [to] A value to set on the given property name\n * @param {Function} [callback] If provided, the callback will be called after the captureing event\n */\nPostHogGroup.prototype.set = addOptOutCheckPostHogGroup(function(prop, to, callback) {\n    var data = this.set_action(prop, to);\n    if (_.isObject(prop)) {\n        callback = to;\n    }\n    return this._send_request(data, callback);\n});\n\n/**\n * Set properties on a group, only if they do not yet exist.\n * This will not overwrite previous group property values, unlike\n * group.set().\n *\n * ### Usage:\n *\n *     posthog.get_group('company', 'posthog').set_once('Location', '405 Howard');\n *\n *     // or set multiple properties at once\n *     posthog.get_group('company', 'posthog').set_once({\n *          'Location': '405 Howard',\n *          'Founded' : 2009,\n *     });\n *     // properties can be strings, integers, lists or dates\n *\n * @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n * @param {*} [to] A value to set on the given property name\n * @param {Function} [callback] If provided, the callback will be called after the captureing event\n */\nPostHogGroup.prototype.set_once = addOptOutCheckPostHogGroup(function(prop, to, callback) {\n    var data = this.set_once_action(prop, to);\n    if (_.isObject(prop)) {\n        callback = to;\n    }\n    return this._send_request(data, callback);\n});\n\n/**\n * Unset properties on a group permanently.\n *\n * ### Usage:\n *\n *     posthog.get_group('company', 'posthog').unset('Founded');\n *\n * @param {String} prop The name of the property.\n * @param {Function} [callback] If provided, the callback will be called after the captureing event\n */\nPostHogGroup.prototype.unset = addOptOutCheckPostHogGroup(function(prop, callback) {\n    var data = this.unset_action(prop);\n    return this._send_request(data, callback);\n});\n\n/**\n * Merge a given list with a list-valued group property, excluding duplicate values.\n *\n * ### Usage:\n *\n *     // merge a value to a list, creating it if needed\n *     posthog.get_group('company', 'posthog').union('Location', ['San Francisco', 'London']);\n *\n * @param {String} list_name Name of the property.\n * @param {Array} values Values to merge with the given property\n * @param {Function} [callback] If provided, the callback will be called after the captureing event\n */\nPostHogGroup.prototype.union = addOptOutCheckPostHogGroup(function(list_name, values, callback) {\n    if (_.isObject(list_name)) {\n        callback = values;\n    }\n    var data = this.union_action(list_name, values);\n    return this._send_request(data, callback);\n});\n\n/**\n * Permanently delete a group.\n *\n * ### Usage:\n *     posthog.get_group('company', 'posthog').delete();\n */\nPostHogGroup.prototype['delete'] = addOptOutCheckPostHogGroup(function(callback) {\n    var data = this.delete_action();\n    return this._send_request(data, callback);\n});\n\n/**\n * Remove a property from a group. The value will be ignored if doesn't exist.\n *\n * ### Usage:\n *\n *     posthog.get_group('company', 'posthog').remove('Location', 'London');\n *\n * @param {String} list_name Name of the property.\n * @param {Object} value Value to remove from the given group property\n * @param {Function} [callback] If provided, the callback will be called after the captureing event\n */\nPostHogGroup.prototype.remove = addOptOutCheckPostHogGroup(function(list_name, value, callback) {\n    var data = this.remove_action(list_name, value);\n    return this._send_request(data, callback);\n});\n\nPostHogGroup.prototype._send_request = function(data, callback) {\n    data['$group_key'] = this._group_key;\n    data['$group_id'] = this._group_id;\n    data['$token'] = this._get_config('token');\n\n    var date_encoded_data = _.encodeDates(data);\n    var truncated_data    = _.truncate(date_encoded_data, 255);\n    var json_data         = _.JSONEncode(date_encoded_data);\n    var encoded_data      = _.base64Encode(json_data);\n\n    console.log(data);\n    this._posthog._send_request(\n        this._posthog.get_config('api_host') + '/groups/',\n        {'data': encoded_data},\n        this._posthog._prepare_callback(callback, truncated_data)\n    );\n\n    return truncated_data;\n};\n\nPostHogGroup.prototype._is_reserved_property = function(prop) {\n    return prop === '$group_key' || prop === '$group_id';\n};\n\nPostHogGroup.prototype._get_config = function(conf) {\n    return this._posthog.get_config(conf);\n};\n\nPostHogGroup.prototype.toString = function() {\n    return this._posthog.toString() + '.group.' + this._group_key + '.' + this._group_id;\n};\n\n// PostHogGroup Exports\nPostHogGroup.prototype['remove']   = PostHogGroup.prototype.remove;\nPostHogGroup.prototype['set']      = PostHogGroup.prototype.set;\nPostHogGroup.prototype['set_once'] = PostHogGroup.prototype.set_once;\nPostHogGroup.prototype['union']    = PostHogGroup.prototype.union;\nPostHogGroup.prototype['unset']    = PostHogGroup.prototype.unset;\nPostHogGroup.prototype['toString'] = PostHogGroup.prototype.toString;\n\nexport {PostHogGroup};\n","/* eslint camelcase: \"off\" */\nimport { addOptOutCheckPostHogPeople } from './gdpr-utils';\nimport {\n    SET_ACTION,\n    SET_ONCE_ACTION,\n    UNSET_ACTION,\n    ADD_ACTION,\n    APPEND_ACTION,\n    REMOVE_ACTION,\n    UNION_ACTION,\n    apiActions\n} from './api-actions';\nimport { _, console } from './utils';\n\n/**\n * PostHog People Object\n * @constructor\n */\nvar PostHogPeople = function() {};\n\n_.extend(PostHogPeople.prototype, apiActions);\n\nPostHogPeople.prototype._init = function(posthog_instance) {\n    this._posthog = posthog_instance;\n};\n\n/*\n* Set properties on a user record.\n*\n* ### Usage:\n*\n*     posthog.people.set('gender', 'm');\n*\n*     // or set multiple properties at once\n*     posthog.people.set({\n*         'Company': 'Acme',\n*         'Plan': 'Premium',\n*         'Upgrade date': new Date()\n*     });\n*     // properties can be strings, integers, dates, or lists\n*\n* @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [to] A value to set on the given property name\n* @param {Function} [callback] If provided, the callback will be called after captureing the event.\n*/\nPostHogPeople.prototype.set = addOptOutCheckPostHogPeople(function(prop, to, callback) {\n    var data = this.set_action(prop, to);\n    if (_.isObject(prop)) {\n        callback = to;\n    }\n    // make sure that the referrer info has been updated and saved\n    if (this._get_config('save_referrer')) {\n        this._posthog['persistence'].update_referrer_info(document.referrer);\n    }\n\n    // update $set object with default people properties\n    data[SET_ACTION] = _.extend(\n        {},\n        _.info.people_properties(),\n        this._posthog['persistence'].get_referrer_info(),\n        data[SET_ACTION]\n    );\n    return this._send_request(data, callback);\n});\n\n/*\n* Set properties on a user record, only if they do not yet exist.\n* This will not overwrite previous people property values, unlike\n* people.set().\n*\n* ### Usage:\n*\n*     posthog.people.set_once('First Login Date', new Date());\n*\n*     // or set multiple properties at once\n*     posthog.people.set_once({\n*         'First Login Date': new Date(),\n*         'Starting Plan': 'Premium'\n*     });\n*\n*     // properties can be strings, integers or dates\n*\n* @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [to] A value to set on the given property name\n* @param {Function} [callback] If provided, the callback will be called after captureing the event.\n*/\nPostHogPeople.prototype.set_once = addOptOutCheckPostHogPeople(function(prop, to, callback) {\n    var data = this.set_once_action(prop, to);\n    if (_.isObject(prop)) {\n        callback = to;\n    }\n    return this._send_request(data, callback);\n});\n\n/*\n* Unset properties on a user record (permanently removes the properties and their values from a profile).\n*\n* ### Usage:\n*\n*     posthog.people.unset('gender');\n*\n*     // or unset multiple properties at once\n*     posthog.people.unset(['gender', 'Company']);\n*\n* @param {Array|String} prop If a string, this is the name of the property. If an array, this is a list of property names.\n* @param {Function} [callback] If provided, the callback will be called after captureing the event.\n*/\nPostHogPeople.prototype.unset = addOptOutCheckPostHogPeople(function(prop, callback) {\n    var data = this.unset_action(prop);\n    return this._send_request(data, callback);\n});\n\n/*\n* Increment/decrement numeric people analytics properties.\n*\n* ### Usage:\n*\n*     posthog.people.increment('page_views', 1);\n*\n*     // or, for convenience, if you're just incrementing a counter by\n*     // 1, you can simply do\n*     posthog.people.increment('page_views');\n*\n*     // to decrement a counter, pass a negative number\n*     posthog.people.increment('credits_left', -1);\n*\n*     // like posthog.people.set(), you can increment multiple\n*     // properties at once:\n*     posthog.people.increment({\n*         counter1: 1,\n*         counter2: 6\n*     });\n*\n* @param {Object|String} prop If a string, this is the name of the property. If an object, this is an associative array of names and numeric values.\n* @param {Number} [by] An amount to increment the given property\n* @param {Function} [callback] If provided, the callback will be called after captureing the event.\n*/\nPostHogPeople.prototype.increment = addOptOutCheckPostHogPeople(function(prop, by, callback) {\n    var data = {};\n    var $add = {};\n    if (_.isObject(prop)) {\n        _.each(prop, function(v, k) {\n            if (!this._is_reserved_property(k)) {\n                if (isNaN(parseFloat(v))) {\n                    console.error('Invalid increment value passed to posthog.people.increment - must be a number');\n                    return;\n                } else {\n                    $add[k] = v;\n                }\n            }\n        }, this);\n        callback = by;\n    } else {\n        // convenience: posthog.people.increment('property'); will\n        // increment 'property' by 1\n        if (_.isUndefined(by)) {\n            by = 1;\n        }\n        $add[prop] = by;\n    }\n    data[ADD_ACTION] = $add;\n\n    return this._send_request(data, callback);\n});\n\n/*\n* Append a value to a list-valued people analytics property.\n*\n* ### Usage:\n*\n*     // append a value to a list, creating it if needed\n*     posthog.people.append('pages_visited', 'homepage');\n*\n*     // like posthog.people.set(), you can append multiple\n*     // properties at once:\n*     posthog.people.append({\n*         list1: 'bob',\n*         list2: 123\n*     });\n*\n* @param {Object|String} list_name If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [value] value An item to append to the list\n* @param {Function} [callback] If provided, the callback will be called after captureing the event.\n*/\nPostHogPeople.prototype.append = addOptOutCheckPostHogPeople(function(list_name, value, callback) {\n    if (_.isObject(list_name)) {\n        callback = value;\n    }\n    var data = this.append_action(list_name, value);\n    return this._send_request(data, callback);\n});\n\n/*\n* Remove a value from a list-valued people analytics property.\n*\n* ### Usage:\n*\n*     posthog.people.remove('School', 'UCB');\n*\n* @param {Object|String} list_name If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [value] value Item to remove from the list\n* @param {Function} [callback] If provided, the callback will be called after captureing the event.\n*/\nPostHogPeople.prototype.remove = addOptOutCheckPostHogPeople(function(list_name, value, callback) {\n    if (_.isObject(list_name)) {\n        callback = value;\n    }\n    var data = this.remove_action(list_name, value);\n    return this._send_request(data, callback);\n});\n\n/*\n* Merge a given list with a list-valued people analytics property,\n* excluding duplicate values.\n*\n* ### Usage:\n*\n*     // merge a value to a list, creating it if needed\n*     posthog.people.union('pages_visited', 'homepage');\n*\n*     // like posthog.people.set(), you can append multiple\n*     // properties at once:\n*     posthog.people.union({\n*         list1: 'bob',\n*         list2: 123\n*     });\n*\n*     // like posthog.people.append(), you can append multiple\n*     // values to the same list:\n*     posthog.people.union({\n*         list1: ['bob', 'billy']\n*     });\n*\n* @param {Object|String} list_name If a string, this is the name of the property. If an object, this is an associative array of names and values.\n* @param {*} [value] Value / values to merge with the given property\n* @param {Function} [callback] If provided, the callback will be called after captureing the event.\n*/\nPostHogPeople.prototype.union = addOptOutCheckPostHogPeople(function(list_name, values, callback) {\n    if (_.isObject(list_name)) {\n        callback = values;\n    }\n    var data = this.union_action(list_name, values);\n    return this._send_request(data, callback);\n});\n\n/*\n* Record that you have charged the current user a certain amount\n* of money. Charges recorded with capture_charge() will appear in the\n* PostHog revenue report.\n*\n* ### Usage:\n*\n*     // charge a user $50\n*     posthog.people.capture_charge(50);\n*\n*     // charge a user $30.50 on the 2nd of january\n*     posthog.people.capture_charge(30.50, {\n*         '$time': new Date('jan 1 2012')\n*     });\n*\n* @param {Number} amount The amount of money charged to the current user\n* @param {Object} [properties] An associative array of properties associated with the charge\n* @param {Function} [callback] If provided, the callback will be called when the server responds\n*/\nPostHogPeople.prototype.capture_charge = addOptOutCheckPostHogPeople(function(amount, properties, callback) {\n    if (!_.isNumber(amount)) {\n        amount = parseFloat(amount);\n        if (isNaN(amount)) {\n            console.error('Invalid value passed to posthog.people.capture_charge - must be a number');\n            return;\n        }\n    }\n\n    return this.append('$transactions', _.extend({\n        '$amount': amount\n    }, properties), callback);\n});\n\n/*\n* Permanently clear all revenue report transactions from the\n* current user's people analytics profile.\n*\n* ### Usage:\n*\n*     posthog.people.clear_charges();\n*\n* @param {Function} [callback] If provided, the callback will be called after captureing the event.\n*/\nPostHogPeople.prototype.clear_charges = function(callback) {\n    return this.set('$transactions', [], callback);\n};\n\n/*\n* Permanently deletes the current people analytics profile from\n* PostHog (using the current distinct_id).\n*\n* ### Usage:\n*\n*     // remove the all data you have stored about the current user\n*     posthog.people.delete_user();\n*\n*/\nPostHogPeople.prototype.delete_user = function() {\n    if (!this._identify_called()) {\n        console.error('posthog.people.delete_user() requires you to call identify() first');\n        return;\n    }\n    var data = {'$delete': this._posthog.get_distinct_id()};\n    return this._send_request(data);\n};\n\nPostHogPeople.prototype.toString = function() {\n    return this._posthog.toString() + '.people';\n};\n\nPostHogPeople.prototype._send_request = function(data, callback) {\n    data['$token'] = this._get_config('token');\n    data['$distinct_id'] = this._posthog.get_distinct_id();\n    var device_id = this._posthog.get_property('$device_id');\n    var user_id = this._posthog.get_property('$user_id');\n    var had_persisted_distinct_id = this._posthog.get_property('$had_persisted_distinct_id');\n    if (device_id) {\n        data['$device_id'] = device_id;\n    }\n    if (user_id) {\n        data['$user_id'] = user_id;\n    }\n    if (had_persisted_distinct_id) {\n        data['$had_persisted_distinct_id'] = had_persisted_distinct_id;\n    }\n\n    var date_encoded_data = _.encodeDates(data);\n    var truncated_data    = _.truncate(date_encoded_data, 255);\n    var json_data         = _.JSONEncode(date_encoded_data);\n    var encoded_data      = _.base64Encode(json_data);\n\n    if (!this._identify_called()) {\n        this._enqueue(data);\n        if (!_.isUndefined(callback)) {\n            if (this._get_config('verbose')) {\n                callback({status: -1, error: null});\n            } else {\n                callback(-1);\n            }\n        }\n        return truncated_data;\n    }\n\n    console.log('POSTHOG PEOPLE REQUEST:');\n    console.log(truncated_data);\n\n    this._posthog._send_request(\n        this._get_config('api_host') + '/engage/',\n        {'data': encoded_data},\n        this._posthog._prepare_callback(callback, truncated_data)\n    );\n\n    return truncated_data;\n};\n\nPostHogPeople.prototype._get_config = function(conf_var) {\n    return this._posthog.get_config(conf_var);\n};\n\nPostHogPeople.prototype._identify_called = function() {\n    return this._posthog._flags.identify_called === true;\n};\n\n// Queue up engage operations if identify hasn't been called yet.\nPostHogPeople.prototype._enqueue = function(data) {\n    if (SET_ACTION in data) {\n        this._posthog['persistence']._add_to_people_queue(SET_ACTION, data);\n    } else if (SET_ONCE_ACTION in data) {\n        this._posthog['persistence']._add_to_people_queue(SET_ONCE_ACTION, data);\n    } else if (UNSET_ACTION in data) {\n        this._posthog['persistence']._add_to_people_queue(UNSET_ACTION, data);\n    } else if (ADD_ACTION in data) {\n        this._posthog['persistence']._add_to_people_queue(ADD_ACTION, data);\n    } else if (APPEND_ACTION in data) {\n        this._posthog['persistence']._add_to_people_queue(APPEND_ACTION, data);\n    } else if (REMOVE_ACTION in data) {\n        this._posthog['persistence']._add_to_people_queue(REMOVE_ACTION, data);\n    } else if (UNION_ACTION in data) {\n        this._posthog['persistence']._add_to_people_queue(UNION_ACTION, data);\n    } else {\n        console.error('Invalid call to _enqueue():', data);\n    }\n};\n\nPostHogPeople.prototype._flush_one_queue = function(action, action_method, callback, queue_to_params_fn) {\n    var _this = this;\n    var queued_data = _.extend({}, this._posthog['persistence']._get_queue(action));\n    var action_params = queued_data;\n\n    if (!_.isUndefined(queued_data) && _.isObject(queued_data) && !_.isEmptyObject(queued_data)) {\n        _this._posthog['persistence']._pop_from_people_queue(action, queued_data);\n        if (queue_to_params_fn) {\n            action_params = queue_to_params_fn(queued_data);\n        }\n        action_method.call(_this, action_params, function(response, data) {\n            // on bad response, we want to add it back to the queue\n            if (response === 0) {\n                _this._posthog['persistence']._add_to_people_queue(action, queued_data);\n            }\n            if (!_.isUndefined(callback)) {\n                callback(response, data);\n            }\n        });\n    }\n};\n\n// Flush queued engage operations - order does not matter,\n// and there are network level race conditions anyway\nPostHogPeople.prototype._flush = function(\n    _set_callback, _add_callback, _append_callback, _set_once_callback, _union_callback, _unset_callback, _remove_callback\n) {\n    var _this = this;\n    var $append_queue = this._posthog['persistence']._get_queue(APPEND_ACTION);\n    var $remove_queue = this._posthog['persistence']._get_queue(REMOVE_ACTION);\n\n    this._flush_one_queue(SET_ACTION, this.set, _set_callback);\n    this._flush_one_queue(SET_ONCE_ACTION, this.set_once, _set_once_callback);\n    this._flush_one_queue(UNSET_ACTION, this.unset, _unset_callback, function(queue) { return _.keys(queue); });\n    this._flush_one_queue(ADD_ACTION, this.increment, _add_callback);\n    this._flush_one_queue(UNION_ACTION, this.union, _union_callback);\n\n    // we have to fire off each $append individually since there is\n    // no concat method server side\n    if (!_.isUndefined($append_queue) && _.isArray($append_queue) && $append_queue.length) {\n        var $append_item;\n        var append_callback = function(response, data) {\n            if (response === 0) {\n                _this._posthog['persistence']._add_to_people_queue(APPEND_ACTION, $append_item);\n            }\n            if (!_.isUndefined(_append_callback)) {\n                _append_callback(response, data);\n            }\n        };\n        for (var i = $append_queue.length - 1; i >= 0; i--) {\n            $append_item = $append_queue.pop();\n            if (!_.isEmptyObject($append_item)) {\n                _this.append($append_item, append_callback);\n            }\n        }\n        // Save the shortened append queue\n        _this._posthog['persistence'].save();\n    }\n\n    // same for $remove\n    if (!_.isUndefined($remove_queue) && _.isArray($remove_queue) && $remove_queue.length) {\n        var $remove_item;\n        var remove_callback = function(response, data) {\n            if (response === 0) {\n                _this._posthog['persistence']._add_to_people_queue(REMOVE_ACTION, $remove_item);\n            }\n            if (!_.isUndefined(_remove_callback)) {\n                _remove_callback(response, data);\n            }\n        };\n        for (var j = $remove_queue.length - 1; j >= 0; j--) {\n            $remove_item = $remove_queue.pop();\n            if (!_.isEmptyObject($remove_item)) {\n                _this.remove($remove_item, remove_callback);\n            }\n        }\n        _this._posthog['persistence'].save();\n    }\n};\n\nPostHogPeople.prototype._is_reserved_property = function(prop) {\n    return prop === '$distinct_id' || prop === '$token' || prop === '$device_id' || prop === '$user_id' || prop === '$had_persisted_distinct_id';\n};\n\n// PostHogPeople Exports\nPostHogPeople.prototype['set']           = PostHogPeople.prototype.set;\nPostHogPeople.prototype['set_once']      = PostHogPeople.prototype.set_once;\nPostHogPeople.prototype['unset']         = PostHogPeople.prototype.unset;\nPostHogPeople.prototype['increment']     = PostHogPeople.prototype.increment;\nPostHogPeople.prototype['append']        = PostHogPeople.prototype.append;\nPostHogPeople.prototype['remove']        = PostHogPeople.prototype.remove;\nPostHogPeople.prototype['union']         = PostHogPeople.prototype.union;\nPostHogPeople.prototype['capture_charge']  = PostHogPeople.prototype.capture_charge;\nPostHogPeople.prototype['clear_charges'] = PostHogPeople.prototype.clear_charges;\nPostHogPeople.prototype['delete_user']   = PostHogPeople.prototype.delete_user;\nPostHogPeople.prototype['toString']      = PostHogPeople.prototype.toString;\n\nexport { PostHogPeople };\n","/* eslint camelcase: \"off\" */\n\nimport {\n    SET_ACTION,\n    SET_ONCE_ACTION,\n    UNSET_ACTION,\n    ADD_ACTION,\n    APPEND_ACTION,\n    REMOVE_ACTION,\n    UNION_ACTION\n} from './api-actions';\nimport Config from './config';\nimport { _, console } from './utils';\n\n/*\n * Constants\n */\n/** @const */ var SET_QUEUE_KEY          = '__mps';\n/** @const */ var SET_ONCE_QUEUE_KEY     = '__mpso';\n/** @const */ var UNSET_QUEUE_KEY        = '__mpus';\n/** @const */ var ADD_QUEUE_KEY          = '__mpa';\n/** @const */ var APPEND_QUEUE_KEY       = '__mpap';\n/** @const */ var REMOVE_QUEUE_KEY       = '__mpr';\n/** @const */ var UNION_QUEUE_KEY        = '__mpu';\n// This key is deprecated, but we want to check for it to see whether aliasing is allowed.\n/** @const */ var PEOPLE_DISTINCT_ID_KEY = '$people_distinct_id';\n/** @const */ var ALIAS_ID_KEY           = '__alias';\n/** @const */ var CAMPAIGN_IDS_KEY       = '__cmpns';\n/** @const */ var EVENT_TIMERS_KEY       = '__timers';\n/** @const */ var RESERVED_PROPERTIES = [\n    SET_QUEUE_KEY,\n    SET_ONCE_QUEUE_KEY,\n    UNSET_QUEUE_KEY,\n    ADD_QUEUE_KEY,\n    APPEND_QUEUE_KEY,\n    REMOVE_QUEUE_KEY,\n    UNION_QUEUE_KEY,\n    PEOPLE_DISTINCT_ID_KEY,\n    ALIAS_ID_KEY,\n    CAMPAIGN_IDS_KEY,\n    EVENT_TIMERS_KEY\n];\n\n/**\n * PostHog Persistence Object\n * @constructor\n */\nvar PostHogPersistence = function(config) {\n    this['props'] = {};\n    this.campaign_params_saved = false;\n\n    if (config['persistence_name']) {\n        this.name = 'ph_' + config['persistence_name'];\n    } else {\n        this.name = 'ph_' + config['token'] + '_posthog';\n    }\n\n    var storage_type = config['persistence'];\n    if (storage_type !== 'cookie' && storage_type !== 'localStorage') {\n        console.critical('Unknown persistence type ' + storage_type + '; falling back to cookie');\n        storage_type = config['persistence'] = 'cookie';\n    }\n\n    if (storage_type === 'localStorage' && _.localStorage.is_supported()) {\n        this.storage = _.localStorage;\n    } else {\n        this.storage = _.cookie;\n    }\n\n    this.load();\n    this.update_config(config);\n    this.upgrade(config);\n    this.save();\n};\n\nPostHogPersistence.prototype.properties = function() {\n    var p = {};\n    // Filter out reserved properties\n    _.each(this['props'], function(v, k) {\n        if (!_.include(RESERVED_PROPERTIES, k)) {\n            p[k] = v;\n        }\n    });\n    return p;\n};\n\nPostHogPersistence.prototype.load = function() {\n    if (this.disabled) { return; }\n\n    var entry = this.storage.parse(this.name);\n\n    if (entry) {\n        this['props'] = _.extend({}, entry);\n    }\n};\n\nPostHogPersistence.prototype.upgrade = function(config) {\n    var upgrade_from_old_lib = config['upgrade'],\n        old_cookie_name,\n        old_cookie;\n\n    if (upgrade_from_old_lib) {\n        old_cookie_name = 'ph_super_properties';\n        // Case where they had a custom cookie name before.\n        if (typeof(upgrade_from_old_lib) === 'string') {\n            old_cookie_name = upgrade_from_old_lib;\n        }\n\n        old_cookie = this.storage.parse(old_cookie_name);\n\n        // remove the cookie\n        this.storage.remove(old_cookie_name);\n        this.storage.remove(old_cookie_name, true);\n\n        if (old_cookie) {\n            this['props'] = _.extend(\n                this['props'],\n                old_cookie['all'],\n                old_cookie['events']\n            );\n        }\n    }\n\n    if (!config['cookie_name'] && config['name'] !== 'posthog') {\n        // special case to handle people with cookies of the form\n        // ph_TOKEN_INSTANCENAME from the first release of this library\n        old_cookie_name = 'ph_' + config['token'] + '_' + config['name'];\n        old_cookie = this.storage.parse(old_cookie_name);\n\n        if (old_cookie) {\n            this.storage.remove(old_cookie_name);\n            this.storage.remove(old_cookie_name, true);\n\n            // Save the prop values that were in the cookie from before -\n            // this should only happen once as we delete the old one.\n            this.register_once(old_cookie);\n        }\n    }\n\n    if (this.storage === _.localStorage) {\n        old_cookie = _.cookie.parse(this.name);\n\n        _.cookie.remove(this.name);\n        _.cookie.remove(this.name, true);\n\n        if (old_cookie) {\n            this.register_once(old_cookie);\n        }\n    }\n};\n\nPostHogPersistence.prototype.save = function() {\n    if (this.disabled) { return; }\n    this._expire_notification_campaigns();\n    this.storage.set(\n        this.name,\n        _.JSONEncode(this['props']),\n        this.expire_days,\n        this.cross_subdomain,\n        this.secure\n    );\n};\n\nPostHogPersistence.prototype.remove = function() {\n    // remove both domain and subdomain cookies\n    this.storage.remove(this.name, false);\n    this.storage.remove(this.name, true);\n};\n\n// removes the storage entry and deletes all loaded data\n// forced name for tests\nPostHogPersistence.prototype.clear = function() {\n    this.remove();\n    this['props'] = {};\n};\n\n/**\n* @param {Object} props\n* @param {*=} default_value\n* @param {number=} days\n*/\nPostHogPersistence.prototype.register_once = function(props, default_value, days) {\n    if (_.isObject(props)) {\n        if (typeof(default_value) === 'undefined') { default_value = 'None'; }\n        this.expire_days = (typeof(days) === 'undefined') ? this.default_expiry : days;\n\n        _.each(props, function(val, prop) {\n            if (!this['props'].hasOwnProperty(prop) || this['props'][prop] === default_value) {\n                this['props'][prop] = val;\n            }\n        }, this);\n\n        this.save();\n\n        return true;\n    }\n    return false;\n};\n\n/**\n* @param {Object} props\n* @param {number=} days\n*/\nPostHogPersistence.prototype.register = function(props, days) {\n    if (_.isObject(props)) {\n        this.expire_days = (typeof(days) === 'undefined') ? this.default_expiry : days;\n\n        _.extend(this['props'], props);\n\n        this.save();\n\n        return true;\n    }\n    return false;\n};\n\nPostHogPersistence.prototype.unregister = function(prop) {\n    if (prop in this['props']) {\n        delete this['props'][prop];\n        this.save();\n    }\n};\n\nPostHogPersistence.prototype._expire_notification_campaigns = _.safewrap(function() {\n    var campaigns_shown = this['props'][CAMPAIGN_IDS_KEY],\n        EXPIRY_TIME = Config.DEBUG ? 60 * 1000 : 60 * 60 * 1000; // 1 minute (Config.DEBUG) / 1 hour (PDXN)\n    if (!campaigns_shown) {\n        return;\n    }\n    for (var campaign_id in campaigns_shown) {\n        if (1 * new Date() - campaigns_shown[campaign_id] > EXPIRY_TIME) {\n            delete campaigns_shown[campaign_id];\n        }\n    }\n    if (_.isEmptyObject(campaigns_shown)) {\n        delete this['props'][CAMPAIGN_IDS_KEY];\n    }\n});\n\nPostHogPersistence.prototype.update_campaign_params = function() {\n    if (!this.campaign_params_saved) {\n        this.register_once(_.info.campaignParams());\n        this.campaign_params_saved = true;\n    }\n};\n\nPostHogPersistence.prototype.update_search_keyword = function(referrer) {\n    this.register(_.info.searchInfo(referrer));\n};\n\n// EXPORTED METHOD, we test this directly.\nPostHogPersistence.prototype.update_referrer_info = function(referrer) {\n    // If referrer doesn't exist, we want to note the fact that it was type-in traffic.\n    this.register_once({\n        '$initial_referrer': referrer || '$direct',\n        '$initial_referring_domain': _.info.referringDomain(referrer) || '$direct'\n    }, '');\n};\n\nPostHogPersistence.prototype.get_referrer_info = function() {\n    return _.strip_empty_properties({\n        '$initial_referrer': this['props']['$initial_referrer'],\n        '$initial_referring_domain': this['props']['$initial_referring_domain']\n    });\n};\n\n// safely fills the passed in object with stored properties,\n// does not override any properties defined in both\n// returns the passed in object\nPostHogPersistence.prototype.safe_merge = function(props) {\n    _.each(this['props'], function(val, prop) {\n        if (!(prop in props)) {\n            props[prop] = val;\n        }\n    });\n\n    return props;\n};\n\nPostHogPersistence.prototype.update_config = function(config) {\n    this.default_expiry = this.expire_days = config['cookie_expiration'];\n    this.set_disabled(config['disable_persistence']);\n    this.set_cross_subdomain(config['cross_subdomain_cookie']);\n    this.set_secure(config['secure_cookie']);\n};\n\nPostHogPersistence.prototype.set_disabled = function(disabled) {\n    this.disabled = disabled;\n    if (this.disabled) {\n        this.remove();\n    } else {\n        this.save();\n    }\n};\n\nPostHogPersistence.prototype.set_cross_subdomain = function(cross_subdomain) {\n    if (cross_subdomain !== this.cross_subdomain) {\n        this.cross_subdomain = cross_subdomain;\n        this.remove();\n        this.save();\n    }\n};\n\nPostHogPersistence.prototype.get_cross_subdomain = function() {\n    return this.cross_subdomain;\n};\n\nPostHogPersistence.prototype.set_secure = function(secure) {\n    if (secure !== this.secure) {\n        this.secure = secure ? true : false;\n        this.remove();\n        this.save();\n    }\n};\n\nPostHogPersistence.prototype._add_to_people_queue = function(queue, data) {\n    var q_key = this._get_queue_key(queue),\n        q_data = data[queue],\n        set_q = this._get_or_create_queue(SET_ACTION),\n        set_once_q = this._get_or_create_queue(SET_ONCE_ACTION),\n        unset_q = this._get_or_create_queue(UNSET_ACTION),\n        add_q = this._get_or_create_queue(ADD_ACTION),\n        union_q = this._get_or_create_queue(UNION_ACTION),\n        remove_q = this._get_or_create_queue(REMOVE_ACTION, []),\n        append_q = this._get_or_create_queue(APPEND_ACTION, []);\n\n    if (q_key === SET_QUEUE_KEY) {\n        // Update the set queue - we can override any existing values\n        _.extend(set_q, q_data);\n        // if there was a pending increment, override it\n        // with the set.\n        this._pop_from_people_queue(ADD_ACTION, q_data);\n        // if there was a pending union, override it\n        // with the set.\n        this._pop_from_people_queue(UNION_ACTION, q_data);\n        this._pop_from_people_queue(UNSET_ACTION, q_data);\n    } else if (q_key === SET_ONCE_QUEUE_KEY) {\n        // only queue the data if there is not already a set_once call for it.\n        _.each(q_data, function(v, k) {\n            if (!(k in set_once_q)) {\n                set_once_q[k] = v;\n            }\n        });\n        this._pop_from_people_queue(UNSET_ACTION, q_data);\n    } else if (q_key === UNSET_QUEUE_KEY) {\n        _.each(q_data, function(prop) {\n\n            // undo previously-queued actions on this key\n            _.each([set_q, set_once_q, add_q, union_q], function(enqueued_obj) {\n                if (prop in enqueued_obj) {\n                    delete enqueued_obj[prop];\n                }\n            });\n            _.each(append_q, function(append_obj) {\n                if (prop in append_obj) {\n                    delete append_obj[prop];\n                }\n            });\n\n            unset_q[prop] = true;\n\n        });\n    } else if (q_key === ADD_QUEUE_KEY) {\n        _.each(q_data, function(v, k) {\n            // If it exists in the set queue, increment\n            // the value\n            if (k in set_q) {\n                set_q[k] += v;\n            } else {\n                // If it doesn't exist, update the add\n                // queue\n                if (!(k in add_q)) {\n                    add_q[k] = 0;\n                }\n                add_q[k] += v;\n            }\n        }, this);\n        this._pop_from_people_queue(UNSET_ACTION, q_data);\n    } else if (q_key === UNION_QUEUE_KEY) {\n        _.each(q_data, function(v, k) {\n            if (_.isArray(v)) {\n                if (!(k in union_q)) {\n                    union_q[k] = [];\n                }\n                // We may send duplicates, the server will dedup them.\n                union_q[k] = union_q[k].concat(v);\n            }\n        });\n        this._pop_from_people_queue(UNSET_ACTION, q_data);\n    } else if (q_key === REMOVE_QUEUE_KEY) {\n        remove_q.push(q_data);\n        this._pop_from_people_queue(APPEND_ACTION, q_data);\n    } else if (q_key === APPEND_QUEUE_KEY) {\n        append_q.push(q_data);\n        this._pop_from_people_queue(UNSET_ACTION, q_data);\n    }\n\n    console.log('POSTHOG PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):');\n    console.log(data);\n\n    this.save();\n};\n\nPostHogPersistence.prototype._pop_from_people_queue = function(queue, data) {\n    var q = this._get_queue(queue);\n    if (!_.isUndefined(q)) {\n        _.each(data, function(v, k) {\n            if (queue === APPEND_ACTION || queue === REMOVE_ACTION) {\n                // list actions: only remove if both k+v match\n                // e.g. remove should not override append in a case like\n                // append({foo: 'bar'}); remove({foo: 'qux'})\n                _.each(q, function(queued_action) {\n                    if (queued_action[k] === v) {\n                        delete queued_action[k];\n                    }\n                });\n            } else {\n                delete q[k];\n            }\n        }, this);\n\n        this.save();\n    }\n};\n\nPostHogPersistence.prototype._get_queue_key = function(queue) {\n    if (queue === SET_ACTION) {\n        return SET_QUEUE_KEY;\n    } else if (queue === SET_ONCE_ACTION) {\n        return SET_ONCE_QUEUE_KEY;\n    } else if (queue === UNSET_ACTION) {\n        return UNSET_QUEUE_KEY;\n    } else if (queue === ADD_ACTION) {\n        return ADD_QUEUE_KEY;\n    } else if (queue === APPEND_ACTION) {\n        return APPEND_QUEUE_KEY;\n    } else if (queue === REMOVE_ACTION) {\n        return REMOVE_QUEUE_KEY;\n    } else if (queue === UNION_ACTION) {\n        return UNION_QUEUE_KEY;\n    } else {\n        console.error('Invalid queue:', queue);\n    }\n};\n\nPostHogPersistence.prototype._get_queue = function(queue) {\n    return this['props'][this._get_queue_key(queue)];\n};\nPostHogPersistence.prototype._get_or_create_queue = function(queue, default_val) {\n    var key = this._get_queue_key(queue);\n    default_val = _.isUndefined(default_val) ? {} : default_val;\n\n    return this['props'][key] || (this['props'][key] = default_val);\n};\n\nPostHogPersistence.prototype.set_event_timer = function(event_name, timestamp) {\n    var timers = this['props'][EVENT_TIMERS_KEY] || {};\n    timers[event_name] = timestamp;\n    this['props'][EVENT_TIMERS_KEY] = timers;\n    this.save();\n};\n\nPostHogPersistence.prototype.remove_event_timer = function(event_name) {\n    var timers = this['props'][EVENT_TIMERS_KEY] || {};\n    var timestamp = timers[event_name];\n    if (!_.isUndefined(timestamp)) {\n        delete this['props'][EVENT_TIMERS_KEY][event_name];\n        this.save();\n    }\n    return timestamp;\n};\n\nexport {\n    PostHogPersistence,\n    SET_QUEUE_KEY,\n    SET_ONCE_QUEUE_KEY,\n    UNSET_QUEUE_KEY,\n    ADD_QUEUE_KEY,\n    APPEND_QUEUE_KEY,\n    REMOVE_QUEUE_KEY,\n    UNION_QUEUE_KEY,\n    PEOPLE_DISTINCT_ID_KEY,\n    ALIAS_ID_KEY,\n    CAMPAIGN_IDS_KEY,\n    EVENT_TIMERS_KEY\n};\n","/* eslint camelcase: \"off\" */\nimport Config from './config';\nimport { _, console, userAgent, window, document, navigator } from './utils';\nimport { autocapture } from './autocapture';\nimport { FormCapture, LinkCapture } from './dom-capture';\nimport { PostHogGroup } from './posthog-group';\nimport { PostHogPeople } from './posthog-people';\nimport {\n    PostHogPersistence,\n    PEOPLE_DISTINCT_ID_KEY,\n    ALIAS_ID_KEY\n} from './posthog-persistence';\nimport {\n    optIn,\n    optOut,\n    hasOptedIn,\n    hasOptedOut,\n    clearOptInOut,\n    addOptOutCheckPostHogLib\n} from './gdpr-utils';\n\n// ==ClosureCompiler==\n// @compilation_level ADVANCED_OPTIMIZATIONS\n// @output_file_name posthog-2.8.min.js\n// ==/ClosureCompiler==\n\n/*\nSIMPLE STYLE GUIDE:\n\nthis.x === public function\nthis._x === internal - only use within this file\nthis.__x === private - only use within the class\n\nGlobals should be all caps\n*/\n\nvar init_type;       // MODULE or SNIPPET loader\nvar posthog_master; // main posthog instance / object\nvar INIT_MODULE  = 0;\nvar INIT_SNIPPET = 1;\n// some globals for comparisons\nvar __NOOP = function () {}\nvar __NOOPTIONS = {}\n\n/** @const */ var PRIMARY_INSTANCE_NAME = 'posthog';\n\n\n/*\n * Dynamic... constants? Is that an oxymoron?\n */\n// http://hacks.mozilla.org/2009/07/cross-site-xmlhttprequest-with-cors/\n// https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#withCredentials\nvar USE_XHR = (window.XMLHttpRequest && 'withCredentials' in new XMLHttpRequest());\n\n// IE<10 does not support cross-origin XHR's but script tags\n// with defer won't block window.onload; ENQUEUE_REQUESTS\n// should only be true for Opera<12\nvar ENQUEUE_REQUESTS = !USE_XHR && (userAgent.indexOf('MSIE') === -1) && (userAgent.indexOf('Mozilla') === -1);\n\n// save reference to navigator.sendBeacon so it can be minified\nvar sendBeacon = navigator['sendBeacon'];\nif (sendBeacon) {\n    sendBeacon = _.bind(sendBeacon, navigator);\n}\n\n/*\n * Module-level globals\n */\nvar DEFAULT_CONFIG = {\n    'api_host':                          'https://t.posthog.com',\n    'api_method':                        'POST',\n    'api_transport':                     'XHR',\n    'autocapture':                         true,\n    'cdn':                               'https://cdn.posthog.com',\n    'cross_subdomain_cookie':            document.location.hostname.indexOf('herokuapp.com') === -1,\n    'persistence':                       'cookie',\n    'persistence_name':                  '',\n    'cookie_name':                       '',\n    'loaded':                            function() {},\n    'store_google':                      true,\n    'save_referrer':                     true,\n    'test':                              false,\n    'verbose':                           false,\n    'img':                               false,\n    'capture_pageview':                    true,\n    'debug':                             false,\n    'capture_links_timeout':               300,\n    'cookie_expiration':                 365,\n    'upgrade':                           false,\n    'disable_persistence':               false,\n    'disable_cookie':                    false,\n    'secure_cookie':                     false,\n    'ip':                                true,\n    'opt_out_captureing_by_default':       false,\n    'opt_out_persistence_by_default':    false,\n    'opt_out_captureing_persistence_type': 'localStorage',\n    'opt_out_captureing_cookie_prefix':    null,\n    'property_blacklist':                [],\n    'xhr_headers':                       {}, // { header: value, header2: value }\n    'inapp_protocol':                    '//',\n    'inapp_link_new_window':             false,\n    'request_batching':                  true\n};\n\nvar DOM_LOADED = false;\n\n/**\n * PostHog Library Object\n * @constructor\n */\nvar PostHogLib = function() {};\n\n\n/**\n * create_mplib(token:string, config:object, name:string)\n *\n * This function is used by the init method of PostHogLib objects\n * as well as the main initializer at the end of the JSLib (that\n * initializes document.posthog as well as any additional instances\n * declared before this file has loaded).\n */\nvar create_mplib = function(token, config, name) {\n    var instance,\n        target = (name === PRIMARY_INSTANCE_NAME) ? posthog_master : posthog_master[name];\n\n    if (target && init_type === INIT_MODULE) {\n        instance = target;\n    } else {\n        if (target && !_.isArray(target)) {\n            console.error('You have already initialized ' + name);\n            return;\n        }\n        instance = new PostHogLib();\n    }\n\n    instance._cached_groups = {}; // cache groups in a pool\n    instance._user_decide_check_complete = false;\n    instance._events_captureed_before_user_decide_check_complete = [];\n\n    instance._init(token, config, name);\n\n    instance['people'] = new PostHogPeople();\n    instance['people']._init(instance);\n\n    // if any instance on the page has debug = true, we set the\n    // global debug to be true\n    Config.DEBUG = Config.DEBUG || instance.get_config('debug');\n\n    instance['__autocapture_enabled'] = instance.get_config('autocapture');\n    if (instance.get_config('autocapture')) {\n        var num_buckets = 100;\n        var num_enabled_buckets = 100;\n        if (!autocapture.enabledForProject(instance.get_config('token'), num_buckets, num_enabled_buckets)) {\n            instance['__autocapture_enabled'] = false;\n            console.log('Not in active bucket: disabling Automatic Event Collection.');\n        } else if (!autocapture.isBrowserSupported()) {\n            instance['__autocapture_enabled'] = false;\n            console.log('Disabling Automatic Event Collection because this browser is not supported');\n        } else {\n            autocapture.init(instance);\n        }\n    }\n\n    // if target is not defined, we called init after the lib already\n    // loaded, so there won't be an array of things to execute\n    if (!_.isUndefined(target) && _.isArray(target)) {\n        // Crunch through the people queue first - we queue this data up &\n        // flush on identify, so it's better to do all these operations first\n        instance._execute_array.call(instance['people'], target['people']);\n        instance._execute_array(target);\n    }\n\n    return instance;\n};\n\n// Initialization methods\n\n/**\n * This function initializes a new instance of the PostHog captureing object.\n * All new instances are added to the main posthog object as sub properties (such as\n * posthog.library_name) and also returned by this function. To define a\n * second instance on the page, you would call:\n *\n *     posthog.init('new token', { your: 'config' }, 'library_name');\n *\n * and use it like so:\n *\n *     posthog.library_name.capture(...);\n *\n * @param {String} token   Your PostHog API token\n * @param {Object} [config]  A dictionary of config options to override. <a href=\"https://github.com/posthog/posthog-js/blob/8b2e1f7b/src/posthog-core.js#L87-L110\">See a list of default config options</a>.\n * @param {String} [name]    The name for the new posthog instance that you want created\n */\nPostHogLib.prototype.init = function (token, config, name) {\n    if (_.isUndefined(name)) {\n        console.error('You must name your new library: init(token, config, name)');\n        return;\n    }\n    if (name === PRIMARY_INSTANCE_NAME) {\n        console.error('You must initialize the main posthog object right after you include the PostHog js snippet');\n        return;\n    }\n\n    var instance = create_mplib(token, config, name);\n    posthog_master[name] = instance;\n    instance._loaded();\n\n    return instance;\n};\n\n// posthog._init(token:string, config:object, name:string)\n//\n// This function sets up the current instance of the posthog\n// library.  The difference between this method and the init(...)\n// method is this one initializes the actual instance, whereas the\n// init(...) method sets up a new library and calls _init on it.\n//\nPostHogLib.prototype._init = function(token, config, name) {\n    this['__loaded'] = true;\n    this['config'] = {};\n    this['_triggered_notifs'] = [];\n\n    this.set_config(_.extend({}, DEFAULT_CONFIG, config, {\n        'name': name,\n        'token': token,\n        'callback_fn': ((name === PRIMARY_INSTANCE_NAME) ? name : PRIMARY_INSTANCE_NAME + '.' + name) + '._jsc'\n    }));\n\n    this['_jsc'] = function() {};\n\n    // batching requests variabls\n    // TODO: add options to allow disabling of polling or intervals?\n    this._event_queue = []\n    this._empty_queue_count = 0 // to track empty polls\n    this._should_poll = true // flag to continue to recursively poll or not\n\n    this.__dom_loaded_queue = [];\n    this.__request_queue = [];\n    this.__disabled_events = [];\n    this._flags = {\n        'disable_all_events': false,\n        'identify_called': false\n    };\n\n    this['persistence'] = this['cookie'] = new PostHogPersistence(this['config']);\n    this._gdpr_init();\n\n    var uuid = _.UUID();\n    if (!this.get_distinct_id()) {\n        // There is no need to set the distinct id\n        // or the device id if something was already stored\n        // in the persitence\n        this.register_once({\n            'distinct_id': uuid,\n            '$device_id': uuid\n        }, '');\n    }\n};\n\n// Private methods\n\nPostHogLib.prototype._loaded = function() {\n    this.get_config('loaded')(this);\n\n    // this happens after so a user can call identify/name_tag in\n    // the loaded callback\n    if (this.get_config('capture_pageview')) {\n        this.capture_pageview();\n    }\n};\n\nPostHogLib.prototype._dom_loaded = function () {\n    _.each(this.__dom_loaded_queue, function (item) {\n        this._capture_dom.apply(this, item);\n    }, this);\n\n    if (!this.has_opted_out_captureing()) {\n        _.each(this.__request_queue, function (item) {\n            this._send_request.apply(this, item);\n        }, this);\n        if(this.get_config('request_batching')) {\n            this._event_queue_poll()\n        }\n    }\n\n    delete this.__dom_loaded_queue;\n    delete this.__request_queue;\n};\n\nPostHogLib.prototype._capture_dom = function(DomClass, args) {\n    if (this.get_config('img')) {\n        console.error('You can\\'t use DOM captureing functions with img = true.');\n        return false;\n    }\n\n    if (!DOM_LOADED) {\n        this.__dom_loaded_queue.push([DomClass, args]);\n        return false;\n    }\n\n    var dt = new DomClass().init(this);\n    return dt.capture.apply(dt, args);\n};\n\n/**\n * _prepare_callback() should be called by callers of _send_request for use\n * as the callback argument.\n *\n * If there is no callback, this returns null.\n * If we are going to make XHR/XDR requests, this returns a function.\n * If we are going to use script tags, this returns a string to use as the\n * callback GET param.\n */\nPostHogLib.prototype._prepare_callback = function(callback, data) {\n    if (_.isUndefined(callback)) {\n        return null;\n    }\n\n    if (USE_XHR) {\n        var callback_function = function(response) {\n            callback(response, data);\n        };\n        return callback_function;\n    } else {\n        // if the user gives us a callback, we store as a random\n        // property on this instances jsc function and update our\n        // callback string to reflect that.\n        var jsc = this['_jsc'];\n        var randomized_cb = '' + Math.floor(Math.random() * 100000000);\n        var callback_string = this.get_config('callback_fn') + '[' + randomized_cb + ']';\n        jsc[randomized_cb] = function(response) {\n            delete jsc[randomized_cb];\n            callback(response, data);\n        };\n        return callback_string;\n    }\n};\n\nPostHogLib.prototype._event_enqueue = function (url, data, options, callback) {\n    this._event_queue.push({url, data, options, callback})\n\n    if (!this._should_poll) {\n        this._should_poll = true\n        this._event_queue_poll()\n    }\n}\n\nPostHogLib.prototype._event_queue_poll = function () {\n    setTimeout(() => {\n        if (this._event_queue.length > 0) {\n            const requests = {}\n            _.each(this._event_queue, (request) => {\n                const { url, data } = request\n                if (requests[url] === undefined) requests[url] = []\n                requests[url].push(data.data)\n            })\n            for (let url in requests) {\n                this._send_request(url, requests[url], __NOOPTIONS, __NOOP)\n            }\n            this._event_queue.length = 0 // flush the _event_queue\n        } else {\n            this._empty_queue_count++\n        }\n\n        if (this._empty_queue_count > 4) {\n            this._should_poll = false\n            this._empty_queue_count = 0\n        }\n        if (this._should_poll) {\n            this._event_queue_poll()\n        }\n    }, 3000)\n}\n\nPostHogLib.prototype._send_request = function(url, data, options, callback) {\n    if (ENQUEUE_REQUESTS) {\n        this.__request_queue.push(arguments);\n        return;\n    }\n\n    var DEFAULT_OPTIONS = {\n        method: this.get_config('api_method'),\n        transport: this.get_config('api_transport')\n    };\n\n    var body_data = null;\n\n    if (!callback && (_.isFunction(options) || typeof options === 'string')) {\n        callback = options;\n        options = null;\n    }\n    options = _.extend(DEFAULT_OPTIONS, options || {});\n    if (!USE_XHR) {\n        options.method = 'GET';\n    }\n\n    var use_sendBeacon = sendBeacon && options.transport.toLowerCase() === 'sendbeacon';\n    var use_post = use_sendBeacon || options.method === 'POST';\n\n    // needed to correctly format responses\n    var verbose_mode = this.get_config('verbose');\n    if (data['verbose']) { verbose_mode = true; }\n\n    if (this.get_config('test')) { data['test'] = 1; }\n    if (verbose_mode) { data['verbose'] = 1; }\n    if (this.get_config('img')) { data['img'] = 1; }\n    if (!USE_XHR) {\n        if (callback) {\n            data['callback'] = callback;\n        } else if (verbose_mode || this.get_config('test')) {\n            // Verbose output (from verbose mode, or an error in test mode) is a json blob,\n            // which by itself is not valid javascript. Without a callback, this verbose output will\n            // cause an error when returned via jsonp, so we force a no-op callback param.\n            // See the ECMA script spec: http://www.ecma-international.org/ecma-262/5.1/#sec-12.4\n            data['callback'] = '(function(){})';\n        }\n    }\n\n    var args = {}\n    args['ip'] = this.get_config('ip') ? 1 : 0;\n    args['_'] = new Date().getTime().toString();\n\n    url += '?' + _.HTTPBuildQuery(args);\n\n    if(use_post) {\n        if (Array.isArray(data)) {\n            body_data = JSON.stringify(data)\n        } else {\n            body_data = 'data=' + data['data'];\n            delete data['data'];\n        }\n    }\n    \n    if ('img' in data) {\n        var img = document.createElement('img');\n        img.src = url;\n        document.body.appendChild(img);\n    } else if (use_sendBeacon) {\n        try {\n            sendBeacon(url, body_data);\n        } catch (e) {\n            console.error(e);\n        }\n    } else if (USE_XHR) {\n        try {\n            var req = new XMLHttpRequest();\n            req.open(options.method, url, true);\n\n            var headers = this.get_config('xhr_headers');\n            if (use_post) {\n                if(!Array.isArray(data)) {\n                    headers['Content-Type'] = 'application/x-www-form-urlencoded';\n                } else {\n                    headers['Content-Type'] = 'application/json';\n                }\n            }\n            _.each(headers, function(headerValue, headerName) {\n                req.setRequestHeader(headerName, headerValue);\n            });\n\n            // send the ph_optout cookie\n            // withCredentials cannot be modified until after calling .open on Android and Mobile Safari\n            req.withCredentials = true;\n            req.onreadystatechange = function () {\n                if (req.readyState === 4) { // XMLHttpRequest.DONE == 4, except in safari 4\n                    if (req.status === 200) {\n                        if (callback) {\n                            if (verbose_mode) {\n                                var response;\n                                try {\n                                    response = _.JSONDecode(req.responseText);\n                                } catch (e) {\n                                    console.error(e);\n                                    return;\n                                }\n                                callback(response);\n                            } else {\n                                callback(Number(req.responseText));\n                            }\n                        }\n                    } else {\n                        var error = 'Bad HTTP status: ' + req.status + ' ' + req.statusText;\n                        console.error(error);\n                        if (callback) {\n                            if (verbose_mode) {\n                                callback({status: 0, error: error});\n                            } else {\n                                callback(0);\n                            }\n                        }\n                    }\n                }\n            };\n            req.send(body_data);\n        } catch (e) {\n            console.error(e);\n        }\n    } else {\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.async = true;\n        script.defer = true;\n        script.src = url;\n        var s = document.getElementsByTagName('script')[0];\n        s.parentNode.insertBefore(script, s);\n    }\n};\n\n/**\n * _execute_array() deals with processing any posthog function\n * calls that were called before the PostHog library were loaded\n * (and are thus stored in an array so they can be called later)\n *\n * Note: we fire off all the posthog function calls && user defined\n * functions BEFORE we fire off posthog captureing calls. This is so\n * identify/register/set_config calls can properly modify early\n * captureing calls.\n *\n * @param {Array} array\n */\nPostHogLib.prototype._execute_array = function(array) {\n    var fn_name, alias_calls = [], other_calls = [], captureing_calls = [];\n    _.each(array, function(item) {\n        if (item) {\n            fn_name = item[0];\n            if (_.isArray(fn_name)) {\n                captureing_calls.push(item); // chained call e.g. posthog.get_group().set()\n            } else if (typeof(item) === 'function') {\n                item.call(this);\n            } else if (_.isArray(item) && fn_name === 'alias') {\n                alias_calls.push(item);\n            } else if (_.isArray(item) && fn_name.indexOf('capture') !== -1 && typeof(this[fn_name]) === 'function') {\n                captureing_calls.push(item);\n            } else {\n                other_calls.push(item);\n            }\n        }\n    }, this);\n\n    var execute = function(calls, context) {\n        _.each(calls, function(item) {\n            if (_.isArray(item[0])) {\n                // chained call\n                var caller = context;\n                _.each(item, function(call) {\n                    caller = caller[call[0]].apply(caller, call.slice(1));\n                });\n            } else {\n                this[item[0]].apply(this, item.slice(1));\n            }\n        }, context);\n    };\n\n    execute(alias_calls, this);\n    execute(other_calls, this);\n    execute(captureing_calls, this);\n};\n\n/**\n * push() keeps the standard async-array-push\n * behavior around after the lib is loaded.\n * This is only useful for external integrations that\n * do not wish to rely on our convenience methods\n * (created in the snippet).\n *\n * ### Usage:\n *     posthog.push(['register', { a: 'b' }]);\n *\n * @param {Array} item A [function_name, args...] array to be executed\n */\nPostHogLib.prototype.push = function(item) {\n    this._execute_array([item]);\n};\n\n/**\n * Disable events on the PostHog object. If passed no arguments,\n * this function disables captureing of any event. If passed an\n * array of event names, those events will be disabled, but other\n * events will continue to be captureed.\n *\n * Note: this function does not stop other posthog functions from\n * firing, such as register() or people.set().\n *\n * @param {Array} [events] An array of event names to disable\n */\nPostHogLib.prototype.disable = function(events) {\n    if (typeof(events) === 'undefined') {\n        this._flags.disable_all_events = true;\n    } else {\n        this.__disabled_events = this.__disabled_events.concat(events);\n    }\n};\n\n/**\n * Capture an event. This is the most important and\n * frequently used PostHog function.\n *\n * ### Usage:\n *\n *     // capture an event named 'Registered'\n *     posthog.capture('Registered', {'Gender': 'Male', 'Age': 21});\n *\n *     // capture an event using navigator.sendBeacon\n *     posthog.capture('Left page', {'duration_seconds': 35}, {transport: 'sendBeacon'});\n *\n * To capture link clicks or form submissions, see capture_links() or capture_forms().\n *\n * @param {String} event_name The name of the event. This can be anything the user does - 'Button Click', 'Sign Up', 'Item Purchased', etc.\n * @param {Object} [properties] A set of properties to include with the event you're sending. These describe the user who did the event or details about the event itself.\n * @param {Object} [options] Optional configuration for this capture request.\n * @param {String} [options.transport] Transport method for network request ('xhr' or 'sendBeacon').\n * @param {Function} [callback] If provided, the callback function will be called after captureing the event.\n */\nPostHogLib.prototype.capture = addOptOutCheckPostHogLib(function(event_name, properties, options, callback) {\n    if (!callback && typeof options === 'function') {\n        callback = options;\n        options = null;\n    }\n    options = options || __NOOPTIONS;\n    var transport = options['transport']; // external API, don't minify 'transport' prop\n    if (transport) {\n        options.transport = transport; // 'transport' prop name can be minified internally\n    }\n    if (typeof callback !== 'function') {\n        callback = __NOOP\n    }\n\n    if (_.isUndefined(event_name)) {\n        console.error('No event name provided to posthog.capture');\n        return;\n    }\n\n    if (this._event_is_disabled(event_name)) {\n        callback(0);\n        return;\n    }\n\n    // set defaults\n    properties = properties || {};\n    properties['token'] = this.get_config('token');\n\n    // set $duration if time_event was previously called for this event\n    var start_timestamp = this['persistence'].remove_event_timer(event_name);\n    if (!_.isUndefined(start_timestamp)) {\n        var duration_in_ms = new Date().getTime() - start_timestamp;\n        properties['$duration'] = parseFloat((duration_in_ms / 1000).toFixed(3));\n    }\n\n    // update persistence\n    this['persistence'].update_search_keyword(document.referrer);\n\n    if (this.get_config('store_google')) { this['persistence'].update_campaign_params(); }\n    if (this.get_config('save_referrer')) { this['persistence'].update_referrer_info(document.referrer); }\n\n    // note: extend writes to the first object, so lets make sure we\n    // don't write to the persistence properties object and info\n    // properties object by passing in a new object\n\n    // update properties with pageview info and super-properties\n    properties = _.extend(\n        {},\n        _.info.properties(),\n        this['persistence'].properties(),\n        properties\n    );\n\n    var property_blacklist = this.get_config('property_blacklist');\n    if (_.isArray(property_blacklist)) {\n        _.each(property_blacklist, function(blacklisted_prop) {\n            delete properties[blacklisted_prop];\n        });\n    } else {\n        console.error('Invalid value for property_blacklist config: ' + property_blacklist);\n    }\n\n    var data = {\n        'event': event_name,\n        'properties': properties\n    };\n    var truncated_data  = _.truncate(data, 255);\n    var json_data      = _.JSONEncode(truncated_data);\n    var encoded_data   = _.base64Encode(json_data);\n\n    const url = this.get_config('api_host') + '/e/'\n    const data_object = {'data': encoded_data}\n    const cb = this._prepare_callback(callback, truncated_data)\n\n    const has_unique_traits = callback !== __NOOP || options !== __NOOPTIONS\n    const args = [url, data_object, options, cb]\n\n    if (!this.get_config('request_batching') || has_unique_traits) {\n        this._send_request(...args);\n    } else {\n        data_object.data = truncated_data\n        this._event_enqueue(...args)\n    }\n\n    return truncated_data;\n});\n\n/**\n * Register the current user into one/many groups.\n *\n * ### Usage:\n *\n *      posthog.set_group('company', ['posthog', 'google']) // an array of IDs\n *      posthog.set_group('company', 'posthog')\n *      posthog.set_group('company', 128746312)\n *\n * @param {String} group_key Group key\n * @param {Array|String|Number} group_ids An array of group IDs, or a singular group ID\n * @param {Function} [callback] If provided, the callback will be called after captureing the event.\n *\n */\nPostHogLib.prototype.set_group = addOptOutCheckPostHogLib(function(group_key, group_ids, callback) {\n    if (!_.isArray(group_ids)) {\n        group_ids = [group_ids];\n    }\n    var prop = {};\n    prop[group_key] = group_ids;\n    this.register(prop);\n    return this['people'].set(group_key, group_ids, callback);\n});\n\n/**\n * Add a new group for this user.\n *\n * ### Usage:\n *\n *      posthog.add_group('company', 'posthog')\n *\n * @param {String} group_key Group key\n * @param {*} group_id A valid PostHog property type\n * @param {Function} [callback] If provided, the callback will be called after captureing the event.\n */\nPostHogLib.prototype.add_group = addOptOutCheckPostHogLib(function(group_key, group_id, callback) {\n    var old_values = this.get_property(group_key);\n    if (old_values === undefined) {\n        var prop = {};\n        prop[group_key] = [group_id];\n        this.register(prop);\n    } else {\n        if (old_values.indexOf(group_id) === -1) {\n            old_values.push(group_id);\n            this.register(prop);\n        }\n    }\n    return this['people'].union(group_key, group_id, callback);\n});\n\n/**\n * Remove a group from this user.\n *\n * ### Usage:\n *\n *      posthog.remove_group('company', 'posthog')\n *\n * @param {String} group_key Group key\n * @param {*} group_id A valid PostHog property type\n * @param {Function} [callback] If provided, the callback will be called after captureing the event.\n */\nPostHogLib.prototype.remove_group = addOptOutCheckPostHogLib(function(group_key, group_id, callback) {\n    var old_value = this.get_property(group_key);\n    // if the value doesn't exist, the persistent store is unchanged\n    if (old_value !== undefined) {\n        var idx = old_value.indexOf(group_id);\n        if (idx > -1) {\n            old_value.splice(idx, 1);\n            this.register({group_key: old_value});\n        }\n        if (old_value.length === 0) {\n            this.unregister(group_key);\n        }\n    }\n    return this['people'].remove(group_key, group_id, callback);\n});\n\n/**\n * Capture an event with specific groups.\n *\n * ### Usage:\n *\n *      posthog.capture_with_groups('purchase', {'product': 'iphone'}, {'University': ['UCB', 'UCLA']})\n *\n * @param {String} event_name The name of the event (see `posthog.capture()`)\n * @param {Object=} properties A set of properties to include with the event you're sending (see `posthog.capture()`)\n * @param {Object=} groups An object mapping group name keys to one or more values\n * @param {Function} [callback] If provided, the callback will be called after captureing the event.\n */\nPostHogLib.prototype.capture_with_groups = addOptOutCheckPostHogLib(function(event_name, properties, groups, callback) {\n    var captureing_props = _.extend({}, properties || {});\n    _.each(groups, function(v, k) {\n        if (v !== null && v !== undefined) {\n            captureing_props[k] = v;\n        }\n    });\n    return this.capture(event_name, captureing_props, callback);\n});\n\nPostHogLib.prototype._create_map_key = function (group_key, group_id) {\n    return group_key + '_' + JSON.stringify(group_id);\n};\n\nPostHogLib.prototype._remove_group_from_cache = function (group_key, group_id) {\n    delete this._cached_groups[this._create_map_key(group_key, group_id)];\n};\n\n/**\n * Look up reference to a PostHog group\n *\n * ### Usage:\n *\n *       posthog.get_group(group_key, group_id)\n *\n * @param {String} group_key Group key\n * @param {Object} group_id A valid PostHog property type\n * @returns {Object} A PostHogGroup identifier\n */\nPostHogLib.prototype.get_group = function (group_key, group_id) {\n    var map_key = this._create_map_key(group_key, group_id);\n    var group = this._cached_groups[map_key];\n    if (group === undefined || group._group_key !== group_key || group._group_id !== group_id) {\n        group = new PostHogGroup();\n        group._init(this, group_key, group_id);\n        this._cached_groups[map_key] = group;\n    }\n    return group;\n};\n\n/**\n * Capture a page view event, which is currently ignored by the server.\n * This function is called by default on page load unless the\n * capture_pageview configuration variable is false.\n *\n * @param {String} [page] The url of the page to record. If you don't include this, it defaults to the current url.\n * @api private\n */\nPostHogLib.prototype.capture_pageview = function(page) {\n    if (_.isUndefined(page)) {\n        page = document.location.href;\n    }\n    this.capture('$pageview');\n};\n\n/**\n * Capture clicks on a set of document elements. Selector must be a\n * valid query. Elements must exist on the page at the time capture_links is called.\n *\n * ### Usage:\n *\n *     // capture click for link id #nav\n *     posthog.capture_links('#nav', 'Clicked Nav Link');\n *\n * ### Notes:\n *\n * This function will wait up to 300 ms for the PostHog\n * servers to respond. If they have not responded by that time\n * it will head to the link without ensuring that your event\n * has been captureed.  To configure this timeout please see the\n * set_config() documentation below.\n *\n * If you pass a function in as the properties argument, the\n * function will receive the DOMElement that triggered the\n * event as an argument.  You are expected to return an object\n * from the function; any properties defined on this object\n * will be sent to posthog as event properties.\n *\n * @type {Function}\n * @param {Object|String} query A valid DOM query, element or jQuery-esque list\n * @param {String} event_name The name of the event to capture\n * @param {Object|Function} [properties] A properties object or function that returns a dictionary of properties when passed a DOMElement\n */\nPostHogLib.prototype.capture_links = function() {\n    return this._capture_dom.call(this, LinkCapture, arguments);\n};\n\n/**\n * Capture form submissions. Selector must be a valid query.\n *\n * ### Usage:\n *\n *     // capture submission for form id 'register'\n *     posthog.capture_forms('#register', 'Created Account');\n *\n * ### Notes:\n *\n * This function will wait up to 300 ms for the posthog\n * servers to respond, if they have not responded by that time\n * it will head to the link without ensuring that your event\n * has been captureed.  To configure this timeout please see the\n * set_config() documentation below.\n *\n * If you pass a function in as the properties argument, the\n * function will receive the DOMElement that triggered the\n * event as an argument.  You are expected to return an object\n * from the function; any properties defined on this object\n * will be sent to posthog as event properties.\n *\n * @type {Function}\n * @param {Object|String} query A valid DOM query, element or jQuery-esque list\n * @param {String} event_name The name of the event to capture\n * @param {Object|Function} [properties] This can be a set of properties, or a function that returns a set of properties after being passed a DOMElement\n */\nPostHogLib.prototype.capture_forms = function() {\n    return this._capture_dom.call(this, FormCaptureer, arguments);\n};\n\n/**\n * Time an event by including the time between this call and a\n * later 'capture' call for the same event in the properties sent\n * with the event.\n *\n * ### Usage:\n *\n *     // time an event named 'Registered'\n *     posthog.time_event('Registered');\n *     posthog.capture('Registered', {'Gender': 'Male', 'Age': 21});\n *\n * When called for a particular event name, the next capture call for that event\n * name will include the elapsed time between the 'time_event' and 'capture'\n * calls. This value is stored as seconds in the '$duration' property.\n *\n * @param {String} event_name The name of the event.\n */\nPostHogLib.prototype.time_event = function(event_name) {\n    if (_.isUndefined(event_name)) {\n        console.error('No event name provided to posthog.time_event');\n        return;\n    }\n\n    if (this._event_is_disabled(event_name)) {\n        return;\n    }\n\n    this['persistence'].set_event_timer(event_name,  new Date().getTime());\n};\n\n/**\n * Register a set of super properties, which are included with all\n * events. This will overwrite previous super property values.\n *\n * ### Usage:\n *\n *     // register 'Gender' as a super property\n *     posthog.register({'Gender': 'Female'});\n *\n *     // register several super properties when a user signs up\n *     posthog.register({\n *         'Email': 'jdoe@example.com',\n *         'Account Type': 'Free'\n *     });\n *\n * @param {Object} properties An associative array of properties to store about the user\n * @param {Number} [days] How many days since the user's last visit to store the super properties\n */\nPostHogLib.prototype.register = function(props, days) {\n    this['persistence'].register(props, days);\n};\n\n/**\n * Register a set of super properties only once. This will not\n * overwrite previous super property values, unlike register().\n *\n * ### Usage:\n *\n *     // register a super property for the first time only\n *     posthog.register_once({\n *         'First Login Date': new Date().toISOString()\n *     });\n *\n * ### Notes:\n *\n * If default_value is specified, current super properties\n * with that value will be overwritten.\n *\n * @param {Object} properties An associative array of properties to store about the user\n * @param {*} [default_value] Value to override if already set in super properties (ex: 'False') Default: 'None'\n * @param {Number} [days] How many days since the users last visit to store the super properties\n */\nPostHogLib.prototype.register_once = function(props, default_value, days) {\n    this['persistence'].register_once(props, default_value, days);\n};\n\n/**\n * Delete a super property stored with the current user.\n *\n * @param {String} property The name of the super property to remove\n */\nPostHogLib.prototype.unregister = function(property) {\n    this['persistence'].unregister(property);\n};\n\nPostHogLib.prototype._register_single = function(prop, value) {\n    var props = {};\n    props[prop] = value;\n    this.register(props);\n};\n\n/**\n * Identify a user with a unique ID instead of a PostHog\n * randomly generated distinct_id. If the method is never called,\n * then unique visitors will be identified by a UUID generated\n * the first time they visit the site.\n *\n * ### Notes:\n *\n * You can call this function to overwrite a previously set\n * unique ID for the current user. PostHog cannot translate\n * between IDs at this time, so when you change a user's ID\n * they will appear to be a new user.\n *\n * When used alone, posthog.identify will change the user's\n * distinct_id to the unique ID provided. When used in tandem\n * with posthog.alias, it will allow you to identify based on\n * unique ID and map that back to the original, anonymous\n * distinct_id given to the user upon her first arrival to your\n * site (thus connecting anonymous pre-signup activity to\n * post-signup activity). Though the two work together, do not\n * call identify() at the same time as alias(). Calling the two\n * at the same time can cause a race condition, so it is best\n * practice to call identify on the original, anonymous ID\n * right after you've aliased it.\n * <a href=\"https://posthog.com/help/questions/articles/how-should-i-handle-my-user-identity-with-the-posthog-javascript-library\">Learn more about how posthog.identify and posthog.alias can be used</a>.\n *\n * @param {String} [unique_id] A string that uniquely identifies a user. If not provided, the distinct_id currently in the persistent store (cookie or localStorage) will be used.\n */\nPostHogLib.prototype.identify = function(\n    new_distinct_id, _set_callback, _add_callback, _append_callback, _set_once_callback, _union_callback, _unset_callback, _remove_callback\n) {\n    // Optional Parameters\n    //  _set_callback:function  A callback to be run if and when the People set queue is flushed\n    //  _add_callback:function  A callback to be run if and when the People add queue is flushed\n    //  _append_callback:function  A callback to be run if and when the People append queue is flushed\n    //  _set_once_callback:function  A callback to be run if and when the People set_once queue is flushed\n    //  _union_callback:function  A callback to be run if and when the People union queue is flushed\n    //  _unset_callback:function  A callback to be run if and when the People unset queue is flushed\n\n    var previous_distinct_id = this.get_distinct_id();\n    this.register({'$user_id': new_distinct_id});\n\n    if (!this.get_property('$device_id')) {\n        // The persisted distinct id might not actually be a device id at all\n        // it might be a distinct id of the user from before\n        var device_id = previous_distinct_id;\n        this.register_once({\n            '$had_persisted_distinct_id': true,\n            '$device_id': device_id\n        }, '');\n    }\n\n    // identify only changes the distinct id if it doesn't match either the existing or the alias;\n    // if it's new, blow away the alias as well.\n    if (new_distinct_id !== previous_distinct_id && new_distinct_id !== this.get_property(ALIAS_ID_KEY)) {\n        this.unregister(ALIAS_ID_KEY);\n        this.register({'distinct_id': new_distinct_id});\n    }\n    // this._check_and_handle_notifications(this.get_distinct_id());\n    this._flags.identify_called = true;\n    // Flush any queued up people requests\n    this['people']._flush(_set_callback, _add_callback, _append_callback, _set_once_callback, _union_callback, _unset_callback, _remove_callback);\n\n    // send an $identify event any time the distinct_id is changing - logic on the server\n    // will determine whether or not to do anything with it.\n    if (new_distinct_id !== previous_distinct_id) {\n        this.capture('$identify', { 'distinct_id': new_distinct_id, '$anon_distinct_id': previous_distinct_id });\n    }\n};\n\n/**\n * Clears super properties and generates a new random distinct_id for this instance.\n * Useful for clearing data when a user logs out.\n */\nPostHogLib.prototype.reset = function() {\n    this['persistence'].clear();\n    this._flags.identify_called = false;\n    var uuid = _.UUID();\n    this.register_once({\n        'distinct_id': uuid,\n        '$device_id': uuid\n    }, '');\n};\n\n/**\n * Returns the current distinct id of the user. This is either the id automatically\n * generated by the library or the id that has been passed by a call to identify().\n *\n * ### Notes:\n *\n * get_distinct_id() can only be called after the PostHog library has finished loading.\n * init() has a loaded function available to handle this automatically. For example:\n *\n *     // set distinct_id after the posthog library has loaded\n *     posthog.init('YOUR PROJECT TOKEN', {\n *         loaded: function(posthog) {\n *             distinct_id = posthog.get_distinct_id();\n *         }\n *     });\n */\nPostHogLib.prototype.get_distinct_id = function() {\n    return this.get_property('distinct_id');\n};\n\n/**\n * Create an alias, which PostHog will use to link two distinct_ids going forward (not retroactively).\n * Multiple aliases can map to the same original ID, but not vice-versa. Aliases can also be chained - the\n * following is a valid scenario:\n *\n *     posthog.alias('new_id', 'existing_id');\n *     ...\n *     posthog.alias('newer_id', 'new_id');\n *\n * If the original ID is not passed in, we will use the current distinct_id - probably the auto-generated GUID.\n *\n * ### Notes:\n *\n * The best practice is to call alias() when a unique ID is first created for a user\n * (e.g., when a user first registers for an account and provides an email address).\n * alias() should never be called more than once for a given user, except to\n * chain a newer ID to a previously new ID, as described above.\n *\n * @param {String} alias A unique identifier that you want to use for this user in the future.\n * @param {String} [original] The current identifier being used for this user.\n */\nPostHogLib.prototype.alias = function(alias, original) {\n    // If the $people_distinct_id key exists in persistence, there has been a previous\n    // posthog.people.identify() call made for this user. It is VERY BAD to make an alias with\n    // this ID, as it will duplicate users.\n    if (alias === this.get_property(PEOPLE_DISTINCT_ID_KEY)) {\n        console.critical('Attempting to create alias for existing People user - aborting.');\n        return -2;\n    }\n\n    var _this = this;\n    if (_.isUndefined(original)) {\n        original = this.get_distinct_id();\n    }\n    if (alias !== original) {\n        this._register_single(ALIAS_ID_KEY, alias);\n        return this.capture('$create_alias', { 'alias': alias, 'distinct_id': original }, function() {\n            // Flush the people queue\n            _this.identify(alias);\n        });\n    } else {\n        console.error('alias matches current distinct_id - skipping api call.');\n        this.identify(alias);\n        return -1;\n    }\n};\n\n/**\n * Provide a string to recognize the user by. The string passed to\n * this method will appear in the PostHog Streams product rather\n * than an automatically generated name. Name tags do not have to\n * be unique.\n *\n * This value will only be included in Streams data.\n *\n * @param {String} name_tag A human readable name for the user\n * @api private\n */\nPostHogLib.prototype.name_tag = function(name_tag) {\n    this._register_single('ph_name_tag', name_tag);\n};\n\n/**\n * Update the configuration of a posthog library instance.\n *\n * The default config is:\n *\n *     {\n *       // HTTP method for captureing requests\n *       api_method: 'POST'\n *\n *       // transport for sending requests ('XHR' or 'sendBeacon')\n *       // NB: sendBeacon should only be used for scenarios such as\n *       // page unload where a \"best-effort\" attempt to send is\n *       // acceptable; the sendBeacon API does not support callbacks\n *       // or any way to know the result of the request. PostHog\n *       // captureing via sendBeacon will not support any event-\n *       // batching or retry mechanisms.\n *       api_transport: 'XHR'\n *\n *       // super properties cookie expiration (in days)\n *       cookie_expiration: 365\n *\n *       // super properties span subdomains\n *       cross_subdomain_cookie: true\n *\n *       // debug mode\n *       debug: false\n *\n *       // if this is true, the posthog cookie or localStorage entry\n *       // will be deleted, and no user persistence will take place\n *       disable_persistence: false\n *\n *       // if this is true, PostHog will automatically determine\n *       // City, Region and Country data using the IP address of\n *       //the client\n *       ip: true\n *\n *       // opt users out of captureing by this PostHog instance by default\n *       opt_out_captureing_by_default: false\n *\n *       // opt users out of browser data storage by this PostHog instance by default\n *       opt_out_persistence_by_default: false\n *\n *       // persistence mechanism used by opt-in/opt-out methods - cookie\n *       // or localStorage - falls back to cookie if localStorage is unavailable\n *       opt_out_captureing_persistence_type: 'localStorage'\n *\n *       // customize the name of cookie/localStorage set by opt-in/opt-out methods\n *       opt_out_captureing_cookie_prefix: null\n *\n *       // type of persistent store for super properties (cookie/\n *       // localStorage) if set to 'localStorage', any existing\n *       // posthog cookie value with the same persistence_name\n *       // will be transferred to localStorage and deleted\n *       persistence: 'cookie'\n *\n *       // name for super properties persistent store\n *       persistence_name: ''\n *\n *       // names of properties/superproperties which should never\n *       // be sent with capture() calls\n *       property_blacklist: []\n *\n *       // if this is true, posthog cookies will be marked as\n *       // secure, meaning they will only be transmitted over https\n *       secure_cookie: false\n *\n *       // the amount of time capture_links will\n *       // wait for PostHog's servers to respond\n *       capture_links_timeout: 300\n *\n *       // should we capture a page view on page load\n *       capture_pageview: true\n *\n *       // if you set upgrade to be true, the library will check for\n *       // a cookie from our old js library and import super\n *       // properties from it, then the old cookie is deleted\n *       // The upgrade config option only works in the initialization,\n *       // so make sure you set it when you create the library.\n *       upgrade: false\n *\n *       // extra HTTP request headers to set for each API request, in\n *       // the format {'Header-Name': value}\n *       xhr_headers: {}\n *\n *       // protocol for fetching in-app message resources, e.g.\n *       // 'https://' or 'http://'; defaults to '//' (which defers to the\n *       // current page's protocol)\n *       inapp_protocol: '//'\n *\n *       // whether to open in-app message link in new tab/window\n *       inapp_link_new_window: false\n *     }\n *\n *\n * @param {Object} config A dictionary of new configuration values to update\n */\nPostHogLib.prototype.set_config = function(config) {\n    if (_.isObject(config)) {\n        _.extend(this['config'], config);\n\n        if (!this.get_config('persistence_name')) {\n            this['config']['persistence_name'] = this['config']['cookie_name'];\n        }\n        if (!this.get_config('disable_persistence')) {\n            this['config']['disable_persistence'] = this['config']['disable_cookie'];\n        }\n\n        if (this['persistence']) {\n            this['persistence'].update_config(this['config']);\n        }\n        Config.DEBUG = Config.DEBUG || this.get_config('debug');\n    }\n};\n\n/**\n * returns the current config object for the library.\n */\nPostHogLib.prototype.get_config = function(prop_name) {\n    return this['config'][prop_name];\n};\n\n/**\n * Returns the value of the super property named property_name. If no such\n * property is set, get_property() will return the undefined value.\n *\n * ### Notes:\n *\n * get_property() can only be called after the PostHog library has finished loading.\n * init() has a loaded function available to handle this automatically. For example:\n *\n *     // grab value for 'user_id' after the posthog library has loaded\n *     posthog.init('YOUR PROJECT TOKEN', {\n *         loaded: function(posthog) {\n *             user_id = posthog.get_property('user_id');\n *         }\n *     });\n *\n * @param {String} property_name The name of the super property you want to retrieve\n */\nPostHogLib.prototype.get_property = function(property_name) {\n    return this['persistence']['props'][property_name];\n};\n\nPostHogLib.prototype.toString = function() {\n    var name = this.get_config('name');\n    if (name !== PRIMARY_INSTANCE_NAME) {\n        name = PRIMARY_INSTANCE_NAME + '.' + name;\n    }\n    return name;\n};\n\nPostHogLib.prototype._event_is_disabled = function(event_name) {\n    return _.isBlockedUA(userAgent) ||\n        this._flags.disable_all_events ||\n        _.include(this.__disabled_events, event_name);\n};\n\nPostHogLib.prototype._handle_user_decide_check_complete = function() {\n    this._user_decide_check_complete = true;\n};\n\n// perform some housekeeping around GDPR opt-in/out state\nPostHogLib.prototype._gdpr_init = function() {\n    var is_localStorage_requested = this.get_config('opt_out_captureing_persistence_type') === 'localStorage';\n\n    // try to convert opt-in/out cookies to localStorage if possible\n    if (is_localStorage_requested && _.localStorage.is_supported()) {\n        if (!this.has_opted_in_captureing() && this.has_opted_in_captureing({'persistence_type': 'cookie'})) {\n            this.opt_in_captureing({'enable_persistence': false});\n        }\n        if (!this.has_opted_out_captureing() && this.has_opted_out_captureing({'persistence_type': 'cookie'})) {\n            this.opt_out_captureing({'clear_persistence': false});\n        }\n        this.clear_opt_in_out_captureing({\n            'persistence_type': 'cookie',\n            'enable_persistence': false\n        });\n    }\n\n    // check whether the user has already opted out - if so, clear & disable persistence\n    if (this.has_opted_out_captureing()) {\n        this._gdpr_update_persistence({'clear_persistence': true});\n\n    // check whether we should opt out by default\n    // note: we don't clear persistence here by default since opt-out default state is often\n    //       used as an initial state while GDPR information is being collected\n    } else if (!this.has_opted_in_captureing() && (\n        this.get_config('opt_out_captureing_by_default') || _.cookie.get('ph_optout')\n    )) {\n        _.cookie.remove('ph_optout');\n        this.opt_out_captureing({\n            'clear_persistence': this.get_config('opt_out_persistence_by_default')\n        });\n    }\n};\n\n/**\n * Enable or disable persistence based on options\n * only enable/disable if persistence is not already in this state\n * @param {boolean} [options.clear_persistence] If true, will delete all data stored by the sdk in persistence and disable it\n * @param {boolean} [options.enable_persistence] If true, will re-enable sdk persistence\n */\nPostHogLib.prototype._gdpr_update_persistence = function(options) {\n    var disabled;\n    if (options && options['clear_persistence']) {\n        disabled = true;\n    } else if (options && options['enable_persistence']) {\n        disabled = false;\n    } else {\n        return;\n    }\n\n    if (!this.get_config('disable_persistence') && this['persistence'].disabled !== disabled) {\n        this['persistence'].set_disabled(disabled);\n    }\n};\n\n// call a base gdpr function after constructing the appropriate token and options args\nPostHogLib.prototype._gdpr_call_func = function(func, options) {\n    options = _.extend({\n        'capture': _.bind(this.capture, this),\n        'persistence_type': this.get_config('opt_out_captureing_persistence_type'),\n        'cookie_prefix': this.get_config('opt_out_captureing_cookie_prefix'),\n        'cookie_expiration': this.get_config('cookie_expiration'),\n        'cross_subdomain_cookie': this.get_config('cross_subdomain_cookie'),\n        'secure_cookie': this.get_config('secure_cookie')\n    }, options);\n\n    // check if localStorage can be used for recording opt out status, fall back to cookie if not\n    if (!_.localStorage.is_supported()) {\n        options['persistence_type'] = 'cookie';\n    }\n\n    return func(this.get_config('token'), {\n        capture: options['capture'],\n        captureEventName: options['capture_event_name'],\n        captureProperties: options['capture_properties'],\n        persistenceType: options['persistence_type'],\n        persistencePrefix: options['cookie_prefix'],\n        cookieExpiration: options['cookie_expiration'],\n        crossSubdomainCookie: options['cross_subdomain_cookie'],\n        secureCookie: options['secure_cookie']\n    });\n};\n\n/**\n * Opt the user in to data captureing and cookies/localstorage for this PostHog instance\n *\n * ### Usage\n *\n *     // opt user in\n *     posthog.opt_in_captureing();\n *\n *     // opt user in with specific event name, properties, cookie configuration\n *     posthog.opt_in_captureing({\n *         capture_event_name: 'User opted in',\n *         capture_event_properties: {\n *             'Email': 'jdoe@example.com'\n *         },\n *         cookie_expiration: 30,\n *         secure_cookie: true\n *     });\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {function} [options.capture] Function used for captureing a PostHog event to record the opt-in action (default is this PostHog instance's capture method)\n * @param {string} [options.capture_event_name=$opt_in] Event name to be used for captureing the opt-in action\n * @param {Object} [options.capture_properties] Set of properties to be captureed along with the opt-in action\n * @param {boolean} [options.enable_persistence=true] If true, will re-enable sdk persistence\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n */\nPostHogLib.prototype.opt_in_captureing = function(options) {\n    options = _.extend({\n        'enable_persistence': true\n    }, options);\n\n    this._gdpr_call_func(optIn, options);\n    this._gdpr_update_persistence(options);\n};\n\n/**\n * Opt the user out of data captureing and cookies/localstorage for this PostHog instance\n *\n * ### Usage\n *\n *     // opt user out\n *     posthog.opt_out_captureing();\n *\n *     // opt user out with different cookie configuration from PostHog instance\n *     posthog.opt_out_captureing({\n *         cookie_expiration: 30,\n *         secure_cookie: true\n *     });\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {boolean} [options.delete_user=true] If true, will delete the currently identified user's profile and clear all charges after opting the user out\n * @param {boolean} [options.clear_persistence=true] If true, will delete all data stored by the sdk in persistence\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n */\nPostHogLib.prototype.opt_out_captureing = function(options) {\n    options = _.extend({\n        'clear_persistence': true,\n        'delete_user': true\n    }, options);\n\n    // delete use and clear charges since these methods may be disabled by opt-out\n    if (options['delete_user'] && this['people'] && this['people']._identify_called()) {\n        this['people'].delete_user();\n        this['people'].clear_charges();\n    }\n\n    this._gdpr_call_func(optOut, options);\n    this._gdpr_update_persistence(options);\n};\n\n/**\n * Check whether the user has opted in to data captureing and cookies/localstorage for this PostHog instance\n *\n * ### Usage\n *\n *     var has_opted_in = posthog.has_opted_in_captureing();\n *     // use has_opted_in value\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} current opt-in status\n */\nPostHogLib.prototype.has_opted_in_captureing = function(options) {\n    return this._gdpr_call_func(hasOptedIn, options);\n};\n\n/**\n * Check whether the user has opted out of data captureing and cookies/localstorage for this PostHog instance\n *\n * ### Usage\n *\n *     var has_opted_out = posthog.has_opted_out_captureing();\n *     // use has_opted_out value\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @returns {boolean} current opt-out status\n */\nPostHogLib.prototype.has_opted_out_captureing = function(options) {\n    return this._gdpr_call_func(hasOptedOut, options);\n};\n\n/**\n * Clear the user's opt in/out status of data captureing and cookies/localstorage for this PostHog instance\n *\n * ### Usage\n *\n *     // clear user's opt-in/out status\n *     posthog.clear_opt_in_out_captureing();\n *\n *     // clear user's opt-in/out status with specific cookie configuration - should match\n *     // configuration used when opt_in_captureing/opt_out_captureing methods were called.\n *     posthog.clear_opt_in_out_captureing({\n *         cookie_expiration: 30,\n *         secure_cookie: true\n *     });\n *\n * @param {Object} [options] A dictionary of config options to override\n * @param {boolean} [options.enable_persistence=true] If true, will re-enable sdk persistence\n * @param {string} [options.persistence_type=localStorage] Persistence mechanism used - cookie or localStorage - falls back to cookie if localStorage is unavailable\n * @param {string} [options.cookie_prefix=__ph_opt_in_out] Custom prefix to be used in the cookie/localstorage name\n * @param {Number} [options.cookie_expiration] Number of days until the opt-in cookie expires (overrides value specified in this PostHog instance's config)\n * @param {boolean} [options.cross_subdomain_cookie] Whether the opt-in cookie is set as cross-subdomain or not (overrides value specified in this PostHog instance's config)\n * @param {boolean} [options.secure_cookie] Whether the opt-in cookie is set as secure or not (overrides value specified in this PostHog instance's config)\n */\nPostHogLib.prototype.clear_opt_in_out_captureing = function(options) {\n    options = _.extend({\n        'enable_persistence': true\n    }, options);\n\n    this._gdpr_call_func(clearOptInOut, options);\n    this._gdpr_update_persistence(options);\n};\n\n// EXPORTS (for closure compiler)\n\n// PostHogLib Exports\nPostHogLib.prototype['init']                               = PostHogLib.prototype.init;\nPostHogLib.prototype['reset']                              = PostHogLib.prototype.reset;\nPostHogLib.prototype['disable']                            = PostHogLib.prototype.disable;\nPostHogLib.prototype['time_event']                         = PostHogLib.prototype.time_event;\nPostHogLib.prototype['capture']                              = PostHogLib.prototype.capture;\nPostHogLib.prototype['capture_links']                        = PostHogLib.prototype.capture_links;\nPostHogLib.prototype['capture_forms']                        = PostHogLib.prototype.capture_forms;\nPostHogLib.prototype['capture_pageview']                     = PostHogLib.prototype.capture_pageview;\nPostHogLib.prototype['register']                           = PostHogLib.prototype.register;\nPostHogLib.prototype['register_once']                      = PostHogLib.prototype.register_once;\nPostHogLib.prototype['unregister']                         = PostHogLib.prototype.unregister;\nPostHogLib.prototype['identify']                           = PostHogLib.prototype.identify;\nPostHogLib.prototype['alias']                              = PostHogLib.prototype.alias;\nPostHogLib.prototype['name_tag']                           = PostHogLib.prototype.name_tag;\nPostHogLib.prototype['set_config']                         = PostHogLib.prototype.set_config;\nPostHogLib.prototype['get_config']                         = PostHogLib.prototype.get_config;\nPostHogLib.prototype['get_property']                       = PostHogLib.prototype.get_property;\nPostHogLib.prototype['get_distinct_id']                    = PostHogLib.prototype.get_distinct_id;\nPostHogLib.prototype['toString']                           = PostHogLib.prototype.toString;\nPostHogLib.prototype['_check_and_handle_notifications']    = PostHogLib.prototype._check_and_handle_notifications;\nPostHogLib.prototype['_handle_user_decide_check_complete'] = PostHogLib.prototype._handle_user_decide_check_complete;\n// PostHogLib.prototype['_show_notification']                 = PostHogLib.prototype._show_notification;\nPostHogLib.prototype['opt_out_captureing']                   = PostHogLib.prototype.opt_out_captureing;\nPostHogLib.prototype['opt_in_captureing']                    = PostHogLib.prototype.opt_in_captureing;\nPostHogLib.prototype['has_opted_out_captureing']             = PostHogLib.prototype.has_opted_out_captureing;\nPostHogLib.prototype['has_opted_in_captureing']              = PostHogLib.prototype.has_opted_in_captureing;\nPostHogLib.prototype['clear_opt_in_out_captureing']          = PostHogLib.prototype.clear_opt_in_out_captureing;\nPostHogLib.prototype['get_group']                          = PostHogLib.prototype.get_group;\nPostHogLib.prototype['set_group']                          = PostHogLib.prototype.set_group;\nPostHogLib.prototype['add_group']                          = PostHogLib.prototype.add_group;\nPostHogLib.prototype['remove_group']                       = PostHogLib.prototype.remove_group;\nPostHogLib.prototype['capture_with_groups']                  = PostHogLib.prototype.capture_with_groups;\n\n// PostHogPersistence Exports\nPostHogPersistence.prototype['properties']            = PostHogPersistence.prototype.properties;\nPostHogPersistence.prototype['update_search_keyword'] = PostHogPersistence.prototype.update_search_keyword;\nPostHogPersistence.prototype['update_referrer_info']  = PostHogPersistence.prototype.update_referrer_info;\nPostHogPersistence.prototype['get_cross_subdomain']   = PostHogPersistence.prototype.get_cross_subdomain;\nPostHogPersistence.prototype['clear']                 = PostHogPersistence.prototype.clear;\n\n_.safewrap_class(PostHogLib, ['identify', '_check_and_handle_notifications']);\n\n\nvar instances = {};\nvar extend_mp = function() {\n    // add all the sub posthog instances\n    _.each(instances, function(instance, name) {\n        if (name !== PRIMARY_INSTANCE_NAME) { posthog_master[name] = instance; }\n    });\n\n    // add private functions as _\n    posthog_master['_'] = _;\n};\n\nvar override_ph_init_func = function() {\n    // we override the snippets init function to handle the case where a\n    // user initializes the posthog library after the script loads & runs\n    posthog_master['init'] = function(token, config, name) {\n        if (name) {\n            // initialize a sub library\n            if (!posthog_master[name]) {\n                posthog_master[name] = instances[name] = create_mplib(token, config, name);\n                posthog_master[name]._loaded();\n            }\n            return posthog_master[name];\n        } else {\n            var instance = posthog_master;\n\n            if (instances[PRIMARY_INSTANCE_NAME]) {\n                // main posthog lib already initialized\n                instance = instances[PRIMARY_INSTANCE_NAME];\n            } else if (token) {\n                // intialize the main posthog lib\n                instance = create_mplib(token, config, PRIMARY_INSTANCE_NAME);\n                instance._loaded();\n                instances[PRIMARY_INSTANCE_NAME] = instance;\n            }\n\n            posthog_master = instance;\n            if (init_type === INIT_SNIPPET) {\n                window[PRIMARY_INSTANCE_NAME] = posthog_master;\n            }\n            extend_mp();\n        }\n    };\n};\n\nvar add_dom_loaded_handler = function() {\n    // Cross browser DOM Loaded support\n    function dom_loaded_handler() {\n        // function flag since we only want to execute this once\n        if (dom_loaded_handler.done) { return; }\n        dom_loaded_handler.done = true;\n\n        DOM_LOADED = true;\n        ENQUEUE_REQUESTS = false;\n\n        _.each(instances, function(inst) {\n            inst._dom_loaded();\n        });\n    }\n\n    function do_scroll_check() {\n        try {\n            document.documentElement.doScroll('left');\n        } catch(e) {\n            setTimeout(do_scroll_check, 1);\n            return;\n        }\n\n        dom_loaded_handler();\n    }\n\n    if (document.addEventListener) {\n        if (document.readyState === 'complete') {\n            // safari 4 can fire the DOMContentLoaded event before loading all\n            // external JS (including this file). you will see some copypasta\n            // on the internet that checks for 'complete' and 'loaded', but\n            // 'loaded' is an IE thing\n            dom_loaded_handler();\n        } else {\n            document.addEventListener('DOMContentLoaded', dom_loaded_handler, false);\n        }\n    } else if (document.attachEvent) {\n        // IE\n        document.attachEvent('onreadystatechange', dom_loaded_handler);\n\n        // check to make sure we arn't in a frame\n        var toplevel = false;\n        try {\n            toplevel = window.frameElement === null;\n        } catch(e) {\n            // noop\n        }\n\n        if (document.documentElement.doScroll && toplevel) {\n            do_scroll_check();\n        }\n    }\n\n    // fallback handler, always will work\n    _.register_event(window, 'load', dom_loaded_handler, true);\n};\n\nexport function init_from_snippet() {\n    init_type = INIT_SNIPPET;\n    if(_.isUndefined(window.posthog)) window.posthog = [];\n    posthog_master = window.posthog;\n\n    if (posthog_master['__loaded'] || (posthog_master['config'] && posthog_master['persistence'])) {\n        // lib has already been loaded at least once; we don't want to override the global object this time so bomb early\n        console.error('PostHog library has already been downloaded at least once.');\n        return;\n    }\n    // Load instances of the PostHog Library\n    _.each(posthog_master['_i'], function(item) {\n        if (item && _.isArray(item)) {\n            instances[item[item.length-1]] = create_mplib.apply(this, item);\n        }\n    });\n\n    override_ph_init_func();\n    posthog_master['init']();\n\n    // Fire loaded events after updating the window's posthog object\n    _.each(instances, function(instance) {\n        instance._loaded();\n    });\n\n    add_dom_loaded_handler();\n}\n\nexport function init_as_module() {\n    init_type = INIT_MODULE;\n    posthog_master = new PostHogLib();\n\n    override_ph_init_func();\n    posthog_master['init']();\n    add_dom_loaded_handler();\n\n    return posthog_master;\n}\n","/* eslint camelcase: \"off\" */\nimport { init_from_snippet } from './posthog-core';\n\ninit_from_snippet();\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}