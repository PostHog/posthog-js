name: Browser SDK Compliance Tests

on:
  push:
    branches: [ main, master ]
    paths:
      - 'packages/browser/**'
      - '.github/workflows/sdk-compliance-tests-browser.yml'
  pull_request:
    branches: [ main, master ]
    paths:
      - 'packages/browser/**'
      - '.github/workflows/sdk-compliance-tests-browser.yml'
  workflow_dispatch:

permissions:
  contents: read
  packages: read
  pull-requests: write

jobs:
  test-browser-sdk:
    uses: PostHog/posthog-sdk-test-harness/.github/workflows/test-sdk-action.yml@main
    with:
      adapter-dockerfile: packages/browser/sdk_compliance_adapter/Dockerfile
      adapter-context: .
      test-harness-version: latest
      report-name: browser-sdk-compliance-report
