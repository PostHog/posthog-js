name: Node SDK Compliance Tests

on:
  push:
    branches: [ main, master ]
    paths:
      - 'packages/node/**'
      - '.github/workflows/sdk-compliance-tests-node.yml'
  pull_request:
    branches: [ main, master ]
    paths:
      - 'packages/node/**'
      - '.github/workflows/sdk-compliance-tests-node.yml'
  workflow_dispatch:

permissions:
  contents: read
  packages: read
  pull-requests: write

jobs:
  test-node-sdk:
    uses: PostHog/posthog-sdk-test-harness/.github/workflows/test-sdk-action.yml@main
    with:
      adapter-dockerfile: packages/node/sdk_compliance_adapter/Dockerfile
      adapter-context: .
      test-harness-version: latest
      report-name: node-sdk-compliance-report
